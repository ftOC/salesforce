<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Re_send</fullName>
    <availability>online</availability>
    <description>Re-send the failed Prospect Creation Interface.</description>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Re-send</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/29.0/connection.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/29.0/apex.js&quot;)}
var profileId= &quot;{!$User.ProfileId}&quot;;
var type = &quot;{!Interface_Log__c.Interface_Type__c}&quot;;
var flag=&quot;{!Interface_Log__c.Resend__c}&quot;;
if (profileId==&apos;00e58000000Rh5P&apos; || profileId ==&apos;00e41000000wIbV&apos;){
if (type == &quot;Prospect Creation Interface&quot;) {
   if(flag != 1){
        var p = new sforce.SObject(&quot;Interface_Log__c&quot;); 
	p.id = &quot;{!Interface_Log__c.Id}&quot;;
	p.Resend__c = true;
	result = sforce.connection.update([p]); 
        if(result[0].success==&quot;true&quot;){
            alert(&quot;Prospect Creation resent&quot;);
            location.reload(true);
        }else{
            alert(&quot;Resent failed. Please try again.&quot;);
        }
  }else{
      alert(&quot;The resent can not be executed again.&quot;);  
  }
}else{
	alert(&quot;Currently, the re-send function is only available for Prospect Creation Interface.&quot;);
}
}else{alert(&quot;Only System Admin or Nokia Admin can use resend funtion&quot;);};</url>
</WebLink>
