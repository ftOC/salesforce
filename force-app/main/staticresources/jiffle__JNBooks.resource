require=function e(t,n,i){function o(s,r){if(!n[s]){if(!t[s]){var d="function"==typeof require&&require;if(!r&&d)return d(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return o(n||e)},u,u.exports,e,t,n,i)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,n){(function(t,n,i,o,a,s,r,d,c){var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=window.enLocale,f=l.book_meeting,m=l.attachments,h=l.notes,p=l.reviews,g=l.opt_in_messages,v=l.custom_labels,y=l.comments;initI18n(_.assign({},f,m,h,p,g,v,y));var b=e("common_api"),w=e("./init_book"),M=e("../Sfdc/SfdcLeads/handler");window.rails_to_html;$(document).ajaxStart(function(){window.timer&&clearTimeout(window.timer),window.timer=setTimeout(function(){$("#cover").fadeIn()},0)}),$(document).ajaxStop(function(){clearTimeout(window.timer),$("#cover").fadeOut()}),Handlebars.registerHelper("check_multiselects",function(e,t){return"multiselect_dropdown"==e?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("isTopicMappingPresent",function(e,t){return void 0!==e?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("ifObject",function(e,t){return"object"===(void 0===e?"undefined":u(e))?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("keyExist",function(e,t){return null===e||e===undefined?t.inverse(this):t.fn(this)}),Handlebars.registerHelper("isFalse",function(e,t){return e&&e.toBoolean()?t.inverse(this):t.fn(this)}),Handlebars.registerHelper("canChangeRoom",function(e,t){return!1!==e?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("compare_text",function(e,t,n){return e===t?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("isAttendeeRegistered",function(e,t,n){return e&&!t?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("isAttendeeUnregistered",function(e,t,n){return e&&t?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("check_arrays",function(e,t,n){return e&&e.length||t&&t.length?n.fn(this):n.inverse(this)}),$(document).ready(function(){if($(document).tooltip({trigger:"hover",selector:".js_tooltip"}),$(document).popover({trigger:"hover",selector:".js_popover",template:'<div class="item-popover popover font-11"><div class="arrow"></div><div class="popover-content"></div></div>'}),window.ReactMessage&&window.ReactMessage.mount(document.querySelector(".notification-mount")),"view"!==window.mode||window.envDetails.isConsecutiveMeeting){var t=scheduler._on_mouse_up;scheduler._on_mouse_up=function(e){if(8===_isIE){var n=this.getEvents();!this._drag_id&&n.length>0&&(this._drag_id=n[0].id)}return t.apply(this,arguments)},((n=window.navigator.userAgent.toLowerCase()).indexOf("msie")>0||n.indexOf("trident")>0)&&$(document).on("click mousedown",".dhx_menu_icon.icon_delete",function(){var e=$(this).closest("[event_id]").attr("event_id");scheduler.deleteEvent(e)})}var n;if("undefined"!=typeof jiffle){mode="new";var i=b.ENDPOINTS.fetch_meeting_info;"edit"===$.urlParam("mode")?(mode="edit",i=b.ENDPOINTS.fetch_edit_meeting_info):"view"===$.urlParam("mode")&&(mode="view",i=b.ENDPOINTS.fetch_view_meeting_info),b.sfdcHandler.bookMeetingInit({mode:mode,url:i},function(){window.isLeadsMeeting=M.isLeadsMeeting(),w(),setupUiI18n()})}else if(queryString&&"string"==typeof queryString.external_request_uuid){e("./ExternalRequest/handler").init(queryString.external_request_uuid,function(){w(),setupUiI18n()})}else w(),setupUiI18n()})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/app.js","/app/scripts/Book")},{"../Sfdc/SfdcLeads/handler":84,"./ExternalRequest/handler":40,"./init_book":64,_process:114,buffer:112,common_api:"common_api"}],2:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["initAttachmentsComponent","uploadAttachment","getAttachments","setAttachments","removeAttachment","setJiffleFileManager"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Attachments/actions.js","/app/scripts/Attachments")},{_process:114,buffer:112}],3:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){t.exports=function(){Handlebars.registerHelper("calculate_size",function(e){return"number"==typeof e?" ("+window.commons.displayFileSize(e)+")":""})}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Attachments/handlebarMethods.js","/app/scripts/Attachments")},{_process:114,buffer:112}],4:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("./store"),m=e("./handlebarMethods"),h=e("./jiffleFileManager"),p=function(){var e,t=$(".notification-modal"),n={uploadSuccessful:function(t){e.clearError(),e.hideProgress(),e.setFileUrl(t.attachmentUrl,t.attachmentUuid,t.attachedFile),e.resetInitCall()},initAttachmentCmp:function(t){var n=t.data.form,i=t.data.settings,o=t.data.resourceConfigs,a=t.data.preloadedAttachments;(e=new h($(n).removeClass("hide"),l)).setConfigs(i,o),e.setupUI(),e.setAttachments(a),l.setJiffleFileManager(e)},uploadFailed:function(t){i(i18n.t("something_went_wrong"),t.message,"red",function(){e.removeFileUrl(t.attachedFile),e.hideProgress(),e.resetInitCall()})},removeUploadSuccessful:function(t){e.clearError(),e.resetInitCall()},removeUploadFailed:function(t){i(i18n.t("something_went_wrong"),t.message,"red",function(){e.resetInitCall()})}};function i(e,n,i,a){t.notificationModal({type:"notification",title:e||"",body:n||"","class":i||"red",dismiss:o(a)})}function o(e){return _.isFunction(e)?e:_.noop}return{init:function(){m(),f.listen(function(e){o(n[e.type])(e)})}}}();t.exports=p}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Attachments/handler.js","/app/scripts/Attachments")},{"./actions":2,"./handlebarMethods":3,"./jiffleFileManager":6,"./store":7,_process:114,buffer:112}],5:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){t.exports=function(e,t){var n="briefing_doc_as_link",i="briefing_doc_as_attachment",o="max_no_of_briefing_docs",a="supported_format_of_briefing_docs",s="max_size_of_briefing_docs",r="resourceType",d="resourceUuid",c="activityUuid",u="canEdit",l=$(".notification-modal");function f(e){return this.configs[e]}function m(e,t,n,i){l.notificationModal({type:"notification",title:e||"",body:t||"","class":n||"red",dismiss:h(i)})}function h(e){return _.isFunction(e)?e:_.noop}this.configs={},_.assign(this,{initConfigs:function(){var r=[i,n,o,a,s],d={};_.forEach(r,function(t){var r=e[t];switch(t){case i:case n:d[t]=function(e){return!0===e||"true"===e||"yes"===e}(r);break;case o:case s:d[t]=Number(r);break;case a:"string"==typeof r&&(r=JSON.parse(r)),r instanceof Array?d[t]=r.slice():d[t]=[]}}),_.assign(this.configs,d,t)},getConfigs:function(){return{canShowLink:f.bind(this,n),canUploadFiles:f.bind(this,i),getMaxFileSize:f.bind(this,s),getMaxAttachmentCount:f.bind(this,o),getAllowedExtensions:f.bind(this,a),getResourceUuid:f.bind(this,d),getResourceType:f.bind(this,r),canEdit:f.bind(this,u),getActivity:f.bind(this,c)}},getValidators:function(){return{validateTotalSize:function(e,t,n,i){n=h(n),i=h(i);var o=_.sum(t,"size")+e.size,a=1024*this.configs[s]*1024;return o<=a?(n(),!0):(i(i18n.t("file_size_exceeds",{size:this.configs[s]})),!1)}.bind(this),validateFileExtension:function(e,t,n){t=h(t),n=h(n);var i=this.configs[a],o=e.name||"",s=o.substring(o.lastIndexOf("."));if(-1===i.indexOf(s.toLowerCase())){var r=HandlebarsTemplates["attachments/attachment_extension_list"](i);return m(i18n.t("unsupported_file_format"),r,"yellow listing-modal",function(){n(i18n.t("unsupported_file_format"))}),!1}return t(),!0}.bind(this),validateAttachmentCount:function(e,t,n,i){return n=h(n),i=h(i),t+e<=this.configs[o]?(n(),!0):(m(i18n.t("number_of_files_exceed_header",{no_of_files:this.configs[o]}),i18n.t("number_of_files_exceed_message"),"red"),!1)}.bind(this),validateDuplicateAttachment:function(e,t,n,i,o){if(i=h(i),o=h(o),_.some(t,e)){var a=n?"link":"file",s=i18n.t("exsiting_"+a),r=i18n.t("exsisting_"+a+"_message");return m(s,r,"yellow"),o(r),!1}return i(),!0}.bind(this)}}})}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Attachments/jiffleFileConfigs.js","/app/scripts/Attachments")},{_process:114,buffer:112}],6:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./jiffleFileConfigs");t.exports=function(e,t){var n,i,o,a,s,r,d,c,u,f,m,h,p,g="file",v="link",y=e,b=$(".notification-modal"),w=[],M=[],C=!0;function S(e){var t=0==f.val();a.prop("disabled",t)}function A(e){e.preventDefault(),e.stopPropagation(),s.removeClass("hide"),c.addClass("hide"),f.focus()}function x(e){e.preventDefault(),e.stopPropagation(),B()}function D(e){e.preventDefault(),e.stopPropagation();var i,o,a,s,r,d,c=$(this).data("link")?v:g;i=i18n.t("remove_attached_file_title"),o=i18n.t("remove_attached_file_message",{attachmentType:c}),a=function(){var e=$(this),i={uuid:e.data("uuid")};if(e.data("link"))F(i,M);else{j(i);var o={type:n.getResourceType(),uuid:i.uuid,activity_uuid:n.getActivity(),initial_call:C};t.removeAttachment(o)}}.bind(this),d=!1,b.notificationModal({type:"confirmation",title:i||"",body:o||"","class":"blue",done:function(){d=!0},dismiss:function(){d?V(a)():V(s)(),V(r)()}})}function k(e,t){h.val(Math.round(100*e/t)),p.text(i18n.t("upload_status",{loaded:window.commons.displayFileSize(e),total:window.commons.displayFileSize(t)}))}function T(){var e=this.files.item(0);o.val("");var a=new FileReader;a.onload=function(o){var a;!function(e){_.assign(e,{uuid:"_"+Math.random().toString(36).substr(2,9),originalName:O(e.name||""),timestamp:_.now()})}(e),a=_.pick(e,"originalName"),i.validateDuplicateAttachment(a,w,!1)&&N(1)&&function(e){return i.validateFileExtension(e,L,J)}(e)&&function(e){return i.validateTotalSize(e,w,L,J)}(e)&&function(e){w.push(e),U();var i=new FormData,o=H(M,v);i.append("links",JSON.stringify(o)),i.append("initial_call",C),i.append("resource_uuid",n.getResourceUuid()),i.append("activity_uuid",n.getActivity()),i.append("file",e),$("#cover").fadeIn(),h.removeClass("hide"),p.removeClass("hide"),t.uploadAttachment(i,e,n.getResourceType(),k)}(e)},a.readAsDataURL(e)}function E(e){e.preventDefault(),e.stopPropagation();var t,n=(f.val()||"").trim(),o=(m.val()||"").trim(),a={originalName:P(n),label:o};n&&(t=a,i.validateDuplicateAttachment(t,M,!0))&&N(1)&&(function(e,t){_.assign(e,{isLink:!0,uuid:t,name:t,timestamp:_.now()})}(a,n),M.push(a),I(n,n,a,M),B())}function I(e,t,n,i){var o=_.find(i,{uuid:n.uuid});o&&(o.dataUrl=e,o.uuid=t,U())}function R(e){e.preventDefault(),e.stopPropagation();var t=$(this).data("url");t&&commons.openPageInNewTab(function(e){return/^https?:\/\//.test(e)?e:"https://"+e}(t))}function O(e){var t=e.lastIndexOf(".");return e.substring(0,t)+e.substring(t).toLowerCase()}function P(e){var t=e.indexOf("?");return-1===t?e.toLowerCase():e.substring(0,t).toLowerCase()+e.substring(t)}function q(){C=!1}function N(e){return i.validateAttachmentCount(e,w.length+M.length)}function B(){f.val("").trigger("keyup"),m.val(""),s.addClass("hide"),c.removeClass("hide")}function U(){u.html(Handlebars.partials["attachments/_file_list_component"]({files:_.sortBy(w.concat(M),"timestamp"),canEdit:n.canEdit()}))}function F(e,t){_.remove(t,{uuid:e.uuid}),U()}function j(e){F(e,w)}function H(e,t){return _.map(e,function(e){return{uuid:e.uuid,type:t,desc:e.name,label:e.label}})}function Y(e,t,n,i){return _.map(e,function(e){return{uuid:e.uuid,type:t,size:1024*e.size*1024,name:e.desc,originalName:i(e.desc),dataUrl:e[n],isLink:t===v,label:e.label}})}function L(){r.addClass("hide"),d.text("")}function J(e){r.removeClass("hide"),d.text(e),setTimeout(L,3e3)}function V(e){return _.isFunction(e)?e:_.noop}_.assign(this,{setupUI:function(){var e,t,i;e=n.canEdit(),t=HandlebarsTemplates["attachments/attachments_field"]({showLinkCmp:e&&n.canShowLink(),showUploadFileCmp:e&&n.canUploadFiles(),files:w.concat(M),canEdit:e,max_size:n.getMaxFileSize()}),y.html(t),o=$('input[type="file"]',y),$(".js-insert-link-btn",y),$(".js-cancel-link-btn",y),a=$(".js-add-link-btn",y),s=$(".js-insert-link-section",y),r=$(".js-attachment-error-block",y),c=$(".js-attachment-btn-section",y),u=$(".js-file-list-container",y),f=$('input[name="attach_link"]',y),m=$('input[name="link_label"]',y),d=r.find(".js-error-msg-block"),h=$("progress",y),p=$(".js-upload-status",y),i=n.getAllowedExtensions(),o.prop({multiple:!1,accept:i.join(", ")}),y.on("change",'input[type="file"]',T).on("keyup",'input[name="attach_link"]',S).on("click",".js-add-link-btn",E).on("click",".js-insert-link-btn",A).on("click",".js-cancel-link-btn",x).on("click",".js-delete-attachment",D).on("click",".js-uploaded-attachment-item",R)},resetInitCall:q,removeFileUrl:j,clearError:L,showError:J,setFileUrl:function(e,t,n){q(),I(e,t,n,w)},getAttachments:function(){var e=H(w,g).concat(H(M,v));return{attachments:JSON.stringify(e)}},setAttachments:function(e){Array.isArray(e)&&e.length>0&&(e=_.groupBy(e,"type"),M=Y(e[v],v,"desc",P),w=Y(e[g],g,"url",O),U())},hideProgress:function(){h.val("0").addClass("hide"),p.text("").addClass("hide")},setConfigs:function(e,t){var o=new l(e,t);o.initConfigs(),n=o.getConfigs(),i=o.getValidators()}})}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Attachments/jiffleFileManager.js","/app/scripts/Attachments")},{"./jiffleFileConfigs":5,_process:114,buffer:112}],7:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=Reflux.createStore({init:function(){this.fileUploadManager=null,this.listenToMany(l)},onInitAttachmentsComponent:function(e,t,n,i){this.trigger({type:"initAttachmentCmp",data:{form:e,settings:t,resourceConfigs:n,preloadedAttachments:i}})},onUploadAttachment:function(e,t,n,i){var o=f.update({url:f.ENDPOINTS.file_upload_url.replace("{type}",n),data:e,contentType:!1,processData:!1,xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){e.lengthComputable&&i(e.loaded,e.total)},!1),e}});o.then(function(e){var n=e.data;this.trigger({type:"uploadSuccessful",attachmentUrl:n.url,attachmentUuid:n.uuid||n.url,attachedFile:t})}.bind(this)),o[o.fail?"fail":"catch"](function(e){var n=_.flatten(_.values(((e||{}).responseJSON||{}).errors||[]));413===e.status&&n.push(i18n.t("file_too_large_msg")),0===n.length&&n.push(i18n.t("please_retry")),this.trigger({type:"uploadFailed",message:n.join(", "),attachedFile:t})}.bind(this))},onRemoveAttachment:function(e){var t=f.update({url:f.ENDPOINTS.remove_uploaded_file_url.replace("{uuid}",e.uuid),type:"PUT",data:e});t.then(function(e){this.trigger({type:"removeUploadSuccessful"})}.bind(this)),t[t.fail?"fail":"catch"](function(t){var n=_.flatten(_.values(((t||{}).responseJSON||{}).errors||[]));this.trigger({type:"removeUploadFailed",message:n,removedFile:e})}.bind(this))}});t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Attachments/store.js","/app/scripts/Attachments")},{"./actions":2,_process:114,buffer:112,common_api:"common_api"}],8:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["fetchInternal","fetchExternal","updateAttendeePreEndorsement","selectExternalAttendee","unselectExternalAttendee","selectInternalAttendee","unselectInternalAttendee","searchInternal","searchExternal","eventCreated","tabChanged","roleFilterChosen","removeFilters","filterInternal","filterExternal","createAttendee","editAttendees","canSelectAttendees","updateAreYouAttending","showAttendeesList","unselectAttendee","domainValidate","resetInternalAttendeeList","resetExternalAttendeeList","setExperts","resetAllAttendees","setAttendeeOptionsSetting","initiateNewMeeting","getattendeeSettings","updateIcsStatus","refreshExternalAttendees","copyAttendees","canReinviteAttendee","updateAttendeeAsHost","updatePersistRequestorAsHost","resetAndFetchInternalAttendees"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/Attendee/actions.js","/app/scripts/Book/Attendee")},{_process:114,buffer:112}],9:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=e("./actions"),m=e("./store").AttendeeStore,h=e("../Calendar/handler"),p=e("./store").AddEditAttendeeStore,g=(e("../Calendar/store").CalendarEventStore,e("../Calendar/store").CalendarAvailabilityStore),v=e("../BriefingRequest/store"),y=e("../Expert/store"),b=e("../Expert/actions"),w=e("../MeetingType/store").MeetingStore,M=e("../../Sfdc/SfdcAccount/store"),C=e("../MeetingInMaking/store"),S=e("../CommonStore"),A=e("../../UserForms/handler"),x=window,D=x.envDetails,k=x.meetingInfo,T=x.mode,E=x.isEBCEvent;$.validator.addMethod("checkEmailValidity",function(e,t,n){return!(e=(e||"").trim())||/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},i18n.t("Please enter a valid email"));var I=function(){var e=$(".tabs-attendees"),t=$("#internal-attendees-tab").find(".attendees-list"),n=$("#external-attendees-tab").find(".attendees-list"),i=$(".user-search-box"),o=$(".section.attendees-section"),a=$("#attendee-filter-panel"),s=$("#attendee-filter",a),r=$(".js-add-attendee-form"),d="internal",c=$(".js-add_attendee"),u=$(".js-add-attendee-modal"),x=$("div.blue-container"),I=($("#logged-in-user-label"),window.ReactMessage||$(".notification-modal")),R=$(".notification-modal"),O=$("#topic_management-complement","form#details-form"),P=null,q=null,N=(D.isConsecutiveMeeting,!1),B=!1,U="declined",F=$("#internal-attendees-tab"),j=!1,H={enableSave:!0,message:""},Y={},L="internal",J={internal:"add",external:"add"},V={internal:"remove",external:"remove"},W={external:{}},z={internal:function(e){Me(t,e.data,"internal")},external:function(e){Me(n,e.data,"external")},internalAttendeeUnselected:ze,externalAttendeeUnselected:Ze,tabChanged:function(e){i.val(e.searchTerm);var t=e.roles;$(".filter-checkbox").prop("checked",!1),$(".filter-checkbox").each(function(e,n){var i=$(n).data("uuid"),o=t.indexOf(i)>-1;$(this).prop("checked",o)})},selectionNotPossible:function(e){I.notificationModal({body:i18n.t("room_overcrowded"),dismiss:e&&e.hasCurrUser?Ke:$.noop,title:i18n.t("select_attendee_notify_title")})},showAttendeesList:le,removeSelf:Z,emailFieldValidatorHandler:function(e){e="string"==typeof e?JSON.parse(e):e.apiResponse;var t,n=e;"external"===L?"internal"===n.data.domain_type?(t=_.isObject(n.data.user)?{email:i18n.t("already_internal_attendee")}:{email:i18n.t("alert_internal_domain")},he(),fe(!1,t.email)):!1===n.success||200!==n.status?(t=n.errors,he(),fe(!1,t.email)):(t={},$("#email-error").css("display","none"),_.isObject(n.data.user)?me(n.data.user,n.data.can_edit):he(),fe(!0,"")):!1===n.success||200!==n.status?(t=n.errors,he(),fe(!1,t.email)):"internal"===n.data.domain_type?(t={},$("#email-error").css("display","none"),n.data.user?me(n.data.user):he(),fe(!0,"")):"external"===n.data.domain_type?(t={email:i18n.t("alert_external_domain")},he(),fe(!1,t.email)):(t={email:n.errors.EmailError},he(),fe(!1,t.email));var i=$(r.selector,u.selector+'[type="'+L+'"]'),o=i.validate();return o.showErrors(_.assign({},t,o.errorMap)),o.previousValue($("[name='email']",i)[0]).originalMessage=t.email||"",H.enableSave},usersFetchError:function(e){var t=_.flatten(_.values(e.data.errors));I.notificationModal({"class":"red",timeout:!0,title:i18n.t("user_fetch_error_title"),body:t.join(", ")})},cannotSelectAttendee:Pe,showCannotIncludeAttendee:qe,overRideRoomcapacity:function(e){var t=!1;if(m.getOverRideRoomcapacityPopup())return void("createNewAttendee"===e.attendee_type?p.createNewAttendee(e.custom_fields,null,e.consent):e.callbackFunction?e.callbackFunction():m.userAddToListActions[e.attendee_type].call(m,e.uuid));if(e.callbackFunction){var n={type:"confirmation",title:i18n.t("override_room_capacity_while_reinviting_title"),body:i18n.t("override_room_capacity_while_reinviting_message"),"class":"yellow",done:function(){t=!0},dismiss:function(){t&&(m.persistOverRideRoomPopup(t),e.callbackFunction&&e.callbackFunction())}};R.notificationModal(n)}else R.notificationModal({type:"confirmation","class":"yellow",title:i18n.t("override_room_capacity_header"),body:i18n.t("override_room_capacity_body"),done:function(){t=!0},dismiss:function(){t?(m.persistOverRideRoomPopup(t),"createNewAttendee"===e.attendee_type?p.createNewAttendee(e.custom_fields,null,e.consent):m.userAddToListActions[e.attendee_type].call(m,e.uuid)):Ne(e)}})},resetInternalAttendeeList:function(e){Me(t,{items:[]},"internal"),f.fetchInternal(1,{byPassMasCalEntry:!0,topicChange:e.topicChange})},editAttendees:function(e){e.users.internal},experts:function(e){f.setExperts(e),"function"==typeof e.callback&&e.callback()},onActivitySettings:function(e){f.setAttendeeOptionsSetting.trigger(e.data.settings);var t=e.data.settings;f.getattendeeSettings(),window.mappingEnabled="yes"===t.default_mapping,window.mappingEnabled?b.fetchExperts({callback:function(){f.fetchInternal(1),("undefined"==typeof jiffle||window.isLeadsMeeting||M.selectedAccount.id)&&f.fetchExternal(1)}}):(f.fetchInternal(1),("undefined"==typeof jiffle||window.isLeadsMeeting||M.selectedAccount.id)&&f.fetchExternal(1)),h.selectAttendee(t)},initiateAttendee:function(e){if(j=!1,!0,m.persistOverRideRoomPopup(e.data.isMeetingOverride),H={enableSave:!0,message:""},Y={},e.data){var t=e.data.attendingMeetingStatus||null;(t=function(e,t){if("edit"===T&&D.isConsecutiveMeeting){var n=_.find(t.data.internal,{uuid:D.currentUser.uuid,invite_status:"declined"});return _.isUndefined(n)?e:"no"}return e}(t,e))||$("#attendingStatus").find(".jif-dropright-filled").addClass("hide").next().removeClass("hide")}x.show(),le({attendeeType:d}),p.updateAttendeeType(d)},handleAttendeeSection:function(e){var t=e.payload,n=t.internal,i=t.external;N="yes"===t.ics_optout,B="yes"===t.enable_meeting_host,window.envDetails.isConsecutiveMeeting&&(a=t.show_add_internal_attendee.toBoolean(),$("#attendee-addbtn")[a?"show":"hide"](),D.allowRequestorToAddInternalAttendee=a),(N||B)&&f.refreshExternalAttendees();var a;n&&i?(o.addClass("hide"),xe(),De()):n?($(".tabs-attendees").find("li[data-search-name='internal']").addClass("hide"),$(".tabs-attendees a[href='#external-attendees-tab']").tab("show"),$("#internal-attendees-tab").addClass("hide"),$("#external-attendees-tab").removeClass("hide"),"yes"===t.default_mapping||!0===t.default_mapping?(window.mappingEnabled=!0,"new"===T?($(".selected-internal-attendee div").addClass("hide"),$(".selected-internal-attendee").append('<div class="selected-title">'+i18n.t("auto_add_internal_attendees")+"</div>")):($(".section-meeting-making .selected-internal-attendee div").addClass("hide"),$(".section-meeting-making .selected-internal-attendee").append('<div class="selected-title">'+i18n.t("auto_add_internal_attendees")+"</div>"),$(".selected-internal-attendee div.section-action").addClass("hide"))):(window.mappingEnabled=!1,De())):i?($(".tabs-attendees").find("li[data-search-name='external']").addClass("hide"),$(".tabs-attendees a[href='#internal-attendees-tab']").tab("show"),$("#external-attendees-tab").addClass("hide"),$("#internal-attendees-tab").removeClass("hide"),xe()):($(".tabs-attendees").find("li[data-search-name='internal']").removeClass("hide"),$(".tabs-attendees").find("li[data-search-name='external']").removeClass("hide"),$("#external-attendees-tab").removeClass("hide"),$("#internal-attendees-tab").removeClass("hide"),k.request.users&&0===k.request.users.internal.length&&k.request.users.external.length&&$(".tabs-attendees a[href='#external-attendees-tab']").tab("show"))},reinviteAttendees:function(e){var t=w.getMstConfigs();R.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:t.enabled?i18n.t("reinvite_confirm_email_message"):i18n.t("reinvite_confirm_message"),done:function(){e.callbackFunction()}})}};function Z(){var e=m.attendeeOptions;e.isResetAttendee=!0,h.selectAttendee(e),x.slideDown()}function G(){$.validator.setDefaults({debug:!0,onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},messages:{first_name:{required:i18n.t("is_required",{attr:i18n.t("first_name")})},last_name:{required:i18n.t("is_required",{attr:i18n.t("last_name")})},email:{required:i18n.t("is_required",{attr:i18n.t("email")}),email:i18n.t("invalid_email")},contact_no:{required:i18n.t("is_required",{attr:i18n.t("phone")})},company_name:{required:i18n.t("is_required",{attr:i18n.t("company__placeholder")})},title:{required:i18n.t("is_required",{attr:i18n.t("title")})}},showErrors:function(e,t){for(var n=0,i=this.validElements();i[n];n++)this.settings.unhighlight.call(this,i[n],this.settings.errorClass,this.settings.validClass),$("[id="+i[n].name+"-error]").hide();for(var o,a=0;t[a];a++)o=t[a],this.settings.highlight(o.element),$("[id="+o.element.name+"-error]").show(),this.showLabel(o.element,o.message)}}),$.validator.addMethod("validateUserEmail",function(e,t){return function(e){var t={user_type:function(){return L},email:$(e).val()};f.domainValidate(t)}(t),!0},""),$(r.selector).each(function(e,t){(t=$(t)).on("click",".select2.select2-container",function(e){t.find("> .select2-container.select2-container--default").css({position:"fixed"})}),t.validate({onsubmit:!1,onkeyup:!1,rules:{email:{checkEmailValidity:"[name='email']",validateUserEmail:"[name='email']",required:{depends:function(e){return $(e).val(e.value.trim()),!0}}}}})})}function Q(){if($(t).infiniteScroll({offset:200,callback:_e}),$(n).infiniteScroll({offset:100,callback:pe}),k.request&&k.request.users&&k.request.users.internal){var o=!1,d=D.currentUser.uuid;_.find(k.request.users.internal,function(e){return e.uuid===d})!==undefined&&(o=!0);var l=_.isPresent(k.request.room),h=k.request.defaultStateOfAreYouAttending;window.envDetails.defaultStateOfAreYouAttending=2===h?"yes":1===h?"no":"",("new"!==window.mode||Be(d,!0))&&m.onEditAttendees(k.request.users,o,l)}$(t).append($("<div/>")),i.on("keyup",_.debounce(be,369)),n.on("click",".select-attendee",Ie),n.on("click",".unselect-attendee",Re),t.on("click",".select-attendee",Fe).on("click",".unselect-attendee",Le).on("click",".add-keynote-speaker",te).on("click",".remove-keynote-speaker",oe),F.on("click",".js-pre-endorse-action",Ve),s.on("change",".filter-checkbox",ke),n.on("click",".js_send_ics_switch",se),a.on("click",".cancel",Te),a.on("click",".apply",Ee),u.on("show.bs.modal",function(e){D.isConsecutiveMeeting||m.isJuniorMMorAbove()||m.canSelect||m.capacityCheckForNonMM()||(e.preventDefault(),e.stopPropagation(),Pe({}))}),$("#attendee-addbtn").on("click",function(e){window.scrollTo(0,0),e.preventDefault(),e.stopPropagation(),p.isAttendeeCustomFieldFetched()?X():A.init({callback:function(e){K(e),X()},templateName:"add_attendee_form",isNewUser:!0})}),r.on("change","#internalPrimaryFields input, #externalPrimaryFields input, #external_sync_sfdc_contact",function(){$(r.selector,u.selector+'[type="'+L+'"]').validate().element($(this))&&p.updateAttendeeData(this.name,this.value||this.checked)}),u.on("show.bs.modal",de).on("hide.bs.modal",ce),c.on("click",_.throttle(ve,631)),$('.tabs-attendees a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=$(e.target)[0],n=$(t).attr("id");!function(e){if(Y.user_filter_options){var t=HandlebarsTemplates["book/filter_attendee_item"]({roles:Y.user_filter_options[e]});s.html(t)}f.tabChanged(e)}(n),ue(n)}),e.on("shown.bs.tab",'a[data-toggle="tab"]',re)}function K(e){P=e.formRenderers.internal,q=e.formRenderers.external,W.external=e.sfdcDefaults,p.setAttendeeCustomFieldFetched(!0)}function X(){D.isConsecutiveMeeting||m.canSelect||m.capacityCheckForNonMM()?$(u.selector+'[type="'+L+'"]').modal({show:!0,backdrop:"static",keyboard:!0}):m.isJuniorMMorAbove()?function(){if(m.getOverRideRoomcapacityPopup())$(u.selector+'[type="'+L+'"]').modal({show:!0,backdrop:"static",keyboard:!0});else{var e=!1;R.notificationModal({type:"confirmation","class":"yellow",title:i18n.t("override_room_capacity_header"),body:i18n.t("override_room_capacity_body"),done:function(){e=!0},dismiss:function(){e&&(m.persistOverRideRoomPopup(e),$(u.selector+'[type="'+L+'"]').modal({show:!0,backdrop:"static",keyboard:!0}))}})}}():Pe({})}function ee(e){I.notificationModal({title:i18n.t("can_not_edit_host_header"),body:e||i18n.t("can_not_edit_host_message"),"class":"yellow"})}function te(e){var t=$(this),n=t.data("uuid"),i=!1,o=m.canAttendeeBeAssignedHost(n);e&&!0===o.error?ee(o.message):e&&function(e){return m.getUserStatus(e)===U}(n)?R.notificationModal({body:i18n.t("assgin_declined_host_message"),title:i18n.t("assgin_declined_host_title"),"class":"blue",type:"confirmation",dismiss:function(){i&&ne(t,n)},done:function(){i=!0}}):ne(t,n)}function ne(e,t){e.addClass("hide"),ie(e,t),f.updateAttendeeAsHost(t,!0)}function ie(e,t){e.closest(".attendee-item").addClass("meeting-host"),e.closest(".js-meeting-host-dropdowns").find(".remove-keynote-speaker").removeClass("hide"),e.closest(".attendee-item").find(".status-label.host").text(window.envDetails.meeting_host_label)}function oe(){var e=$(this),t=e.data("uuid");!1!==m.canMeetingHostBeEdited()?(e.addClass("hide"),e.closest(".js-meeting-host-dropdowns").find(".add-keynote-speaker").removeClass("hide"),e.closest(".attendee-item").removeClass("meeting-host"),f.updateAttendeeAsHost(t,!1),t===ae()&&(m.persistRequestorAsHost=!1,f.updatePersistRequestorAsHost())):ee()}function ae(){return $("#requestor-select-complement").val()}function se(){var e=$(this).closest(".attendee-item").data("uuid"),t=$("#send_ics_"+e),n=t.prop("checked");t.prop("checked",!n);var i=!n,o=!1;i?f.updateIcsStatus(e,i):R.notificationModal({body:i18n.t("ext_ics_opt_out_message"),title:i18n.t("are_you_sure"),type:"confirmation",done:function(){o=!0},hideCloseBtn:!0,dismiss:function(){o?f.updateIcsStatus(e,i):t.prop("checked",!0)}})}function re(e){"internal"===$(".tabs-attendees li.active").data("search-name")?D.allowRequestorToAddInternalAttendee?$("#attendee-addbtn").show():$("#attendee-addbtn").hide():$("#attendee-addbtn")[D.allowUserToAddNewExternalAttendee?"show":"hide"]()}function de(e){var t,n;p.setAttendeeCreatedFlag(!1),t=$(r.selector,u.selector+'[type="'+L+'"]'),(n=t.validate()).reset(),n.resetForm(),$(".form-group",t).removeClass("has-error"),ye();var i=D.companyName;!function(e){if(!e.closest("#sf-jiffle-now").length)return;var t=$(r.selector,u.selector+'[type="'+L+'"]'),n="external"===L&&($("#select_account").val()||k.request.custom_fields.meeting_account_id)&&D.syncContactsToSfdc;window.isLeadsMeeting&&(n=D.syncLeadsToSfdc,t.find("#js-external-sync-contact-sfdc").find("label.js-sync-sfdc").text(i18n.t("sync_lead_to_sfdc")));t.find("#js-external-sync-contact-sfdc")[n?"removeClass":"addClass"]("hide")}($(this)),fe(!0,""),"external"===L&&(i=""),$(u.selector+'[type="'+L+'"]').find("[name='company_name']").val(i),p.updateAttendeeData("company_name",i)}function ce(){return p.getAttendeeCreatedFlag()||$(this).hasClass("programmaticHide")?($(this).removeClass("programmaticHide"),!0):(R.notificationModal({"class":"blue",type:"confirmation",title:i18n.t("add_user_notify_title"),body:i18n.t("user_changes_lost"),done:function(){u.off("hide.bs.modal");var e=$(r.selector,u.selector+'[type="'+L+'"]');"internal"===L?P.setValues({custom_fields:{}}):q.setValues({custom_fields:W.external}),$.data(e.find('[name="email"]')[0],"previousValue",{old:"",valid:!0,message:i18n.t("invalid_domain")}),u.modal("hide"),u.on("hide.bs.modal",ce)}}),!1)}function ue(e){$(".filter-dropdown","#attendee-filter-panel").removeClass("hide"),L=e,p.updateAttendeeType(e)}function le(e){var t=e.attendeeType;ue(t),$('a[href="#'+t+'-attendees-tab"]').tab("show")}function fe(e,t){H.enableSave=e,H.message=t}function me(e,t){var n=$(r.selector,u.selector+'[type="'+L+'"]');$("#"+L+"PrimaryFields").find("input[name!=email], textarea, select").each(function(n,i){var o=(i=$(i)).attr("name"),a=e[o];$("#"+o+"-error").hide(),i.prop("readonly",!t&&(a||!i.prop("required"))).val(a),"sync_contact"===o&&(a=i.is(":checked")),p.updateAttendeeData(o,a)}),"object"===l(e.custom_fields)&&("internal"===L?(P.setValues(e),!t&&P.setFormToReadOnly()):(q.setValues(e),!t&&q.setFormToReadOnly())),$(".form-group",n).removeClass("has-error"),j=!0}function he(){if(!1!==j){var e=$(r.selector,u.selector+'[type="'+L+'"]');$("#"+L+"PrimaryFields").find("input[name!=email], textarea, select").each(function(e,t){$(t).prop("readonly",!1).val("").trigger("change").removeAttr("checked"),p.updateAttendeeData(t.name,"")}),"internal"===L?($("input[name='company_name']",e).val(D.companyName),p.updateAttendeeData("company_name",D.companyName),P.setValues({custom_fields:{}}),P.resetFormToReadOnly()):(q.setValues({custom_fields:W.external}),q.resetFormToReadOnly()),j=!1}}function _e(){var e=$(t).data("page")||1;e!==($(t).data("total_pages")||0)&&f.fetchInternal(e+1)}function pe(){var e=$(n).data("page")||1;f.fetchExternal(e+1)}function ge(e){return $('.selected-attendee-item[data-uuid="'+D.currentUser.uuid+'"]').hasClass("declined")&&"yes"===e}function ve(e){e.preventDefault(),e.stopPropagation();var t=v.BriefingRequestStore.briefingInternalAttendees,n=$(r.selector,u.selector+'[type="'+L+'"]'),i=n.find("input[name=email]").val(),o=n.find("input[name=consent]");if(H.enableSave){if("internal"===L?P.isFormValid(n):q.isFormValid(n)){if(!1===window.commons.didUserGiveConsent(o))return void window.commons.showAddUserConsentMissingMessage();if(t.length&&function(e){var t=$(r.selector,u.selector+'[type="'+L+'"]').find("input[name=email]").val();return _.findIndex(e,function(e){return e.email.toLowerCase()===t.toLowerCase()})>=0}(t)){var a=-1!==_.findIndex(D.doubleBookingUsers,function(e){return e.toLowerCase()===i.toLowerCase()});if(!E||!a)return void I.notificationModal({body:i18n.t("briefing_attendee_existing"),title:i18n.t("briefing_attendee_title"),"class":"yellow",dismiss:function(){$(u.selector+'[type="'+L+'"]').modal("hide")}});I.notificationModal({body:i18n.t("briefing_double_added_body"),title:i18n.t("briefing_attendee_title"),"class":"yellow"})}var s="internal"===L?P.getValues():q.getValues();f.createAttendee(s,"-"!==O.val()?O.val():null,window.commons.getConsentValue(o),function(e){if(e){var t=m.selection.internal,n=t[Object.keys(t)[0]].uuid,i=window.envDetails.currentUser.uuid===n?"current_user_not_available":"user_not_available";Ue(i18n.t(i),n)}})}}else"function"==typeof H.message&&(H.message(),$(u.selector+'[type="'+L+'"]').modal("hide"))}function ye(){$(r.selector,u.selector+'[type="'+L+'"]').find("input").map(function(){$(this).prop({readonly:!1,checked:!1}).val("")}),"internal"===L?(P.setValues({custom_fields:{}}),P.resetFormToReadOnly()):(q.setValues({custom_fields:W.external}),q.resetFormToReadOnly())}function be(e){var t=$(this).val();window.mappingEnabled?b.fetchExperts({callback:function(){we(t)},searchTerm:t}):we(t)}function we(e){E?f.searchInternal(e):"internal"===$(".tabs-attendees li.active").data("search-name")?f.searchInternal(e):f.searchExternal(e)}function Me(e,n,i){if(e.empty(),e.append($("<div/>").addClass("selected-attendee")),e.append(function(e,n,i,o){var a=_.find(e,function(e){return e.uuid===window.envDetails.currentUser.uuid}),s=S.getUserEntities(C.model).userPreferences;_.forEach(e,function(e){e.selected&&(e.selectedClassName="added"),"new"===T&&e.confirm_endorse_button&&s[e.uuid]&&"undefined"==typeof s[e.uuid].pre_endorse&&(e.selectedClassName="endorsed")});var r=a?e.filter(function(e){return e.uuid!==a.uuid}):e;if(n===t&&i){var d=[],c=[],u=_.groupBy(r,"mapped_topic");return _.forEach(u,function(e,t){"true"===t?d=d.concat(e):c=c.concat(e)}),d=_.sortByOrder(d,["available","first_name"],[!1,!0]),c=_.sortByOrder(c,["available","first_name"],[!1,!0]),HandlebarsTemplates["book/attendee_item"]({mapped_users:d,show_loggedIn_user:a,unmapped_users:c,show_mapped_header:d.length,show_unmapped_header:c.length,add_label:i18n.t(J[o]),remove_label:i18n.t(V[o]),meeting_host_label:D.meeting_host_label,meeting_host_config:D.enable_meeting_host&&D.enable_meeting_host.toBoolean()})}return e=_.sortByOrder(r,["available","first_name"],[!1,!0]),_.each(e,function(e){e.send_ics===undefined&&(e.send_ics=!0)}),HandlebarsTemplates["book/attendee_item"]({mapped_users:e,show_loggedIn_user:a,unmapped_users:[],show_mapped_header:!1,show_unmapped_header:!1,add_label:i18n.t(J[o]),remove_label:i18n.t(V[o]),show_send_ics_btn:Se(n),meeting_host_label:D.meeting_host_label,meeting_host_config:Ce(n)})}(n.items,e,n.groupData,i)),function(e){var t=$(".attendee-item.added, .attendee-item.endorsed",e);t.clone().appendTo($(".selected-attendee",e)),t.removeClass("added").addClass("hide")}(e),Ae(n.items,e),$(e).data("page",n.current_page),$(e).data("totalPages",n.total_pages),"internal"===i){var o=ae();"new"===T&&je(o),He(o)}}function Ce(e){return e===t&&D.enable_meeting_host&&D.enable_meeting_host.toBoolean()}function Se(e){return e===n&&!D.isConsecutiveMeeting&&N}function Ae(e,t){var n={};e.forEach(function(e){n[e.uuid]=e});var i=HandlebarsTemplates["book/user_tooltip"];$(".attendee-details",t).map(function(){var e=$(this).data("uuid"),t=n[e];$(this).popover({html:"true",template:"<div class='popover room-tooltip' role='tooltip'><div class='popover-content'></div></div>",content:i(t),trigger:"hover",placement:"right"})})}function xe(){$(".section-meeting-proceed .selected-external-attendee .section-action").html(""),$(".attendee-empty-state.external").addClass("hide").html("")}function De(){$(".section-meeting-proceed .selected-internal-attendee .section-action").html(""),$(".attendee-empty-state.internal").addClass("hide").html("")}function ke(e){var t=$(this).prop("checked"),n=$(this).data("uuid"),i=$(".tabs-attendees li.active").data("search-name");f.roleFilterChosen(n,t,i)}function Te(e){e.preventDefault();var t=$(".tabs-attendees li.active").data("search-name");f.removeFilters(t),$(".filter-checkbox").prop("checked",!1),$(".filter-dropdown-toggle").dropdown("toggle")}function Ee(e){e.preventDefault(),"internal"===$(".tabs-attendees li.active").data("search-name")?f.filterInternal():f.filterExternal(),$(".filter-dropdown-toggle").dropdown("toggle")}function Ie(e){e.preventDefault();var t=$(this),i=t.data("uuid");Je(t,i,n),f.selectExternalAttendee(i)}function Re(e){e.preventDefault();var t=$(this),n=t.data("uuid"),i=!1,o=m.getExternalSelectedUser(n).user_name;window.envDetails.isConsecutiveMeeting?R.notificationModal({type:"confirmation","class":"yellow",title:i18n.t("are_you_sure"),body:i18n.t("extenal_attendee_consecutive_meeting_removal_confirmation",{user:o}),done:function(){i=!0},dismiss:function(){i&&(Oe(t),window.envDetails.isConsecutiveMeeting&&$e(o))}}):(Oe(t),window.envDetails.isConsecutiveMeeting&&$e(o))}var $e=function(e){I.notificationModal({body:i18n.t("external_attendee_consecutive_meeting_remove_message",{user:e}),"class":"green"})},Oe=function(e){var t=e.data("uuid");We(e,t,n),f.unselectExternalAttendee(t)};function Pe(e){var t;e.uuid?t=function(){e.uuid&&Ne(e)}:($(u.selector+'[type="'+L+'"]').addClass("programmaticHide").modal("hide"),t=$.noop),qe(e,t)}function qe(e,t){var n=e.message||i18n.t("room_capacity_exceeded"),i=e.title||i18n.t("room_capacity_exceeded_title");m.overRideRoomNonMMcapacityPopup&&(n=e.message||i18n.t("non_mm_room_capacity_exceeded"),i=e.title||i18n.t("non_mm_room_capacity_exceeded_title")),I.notificationModal({body:n,title:i,"class":"red",dismiss:t||$.noop})}function Ne(e){"internal"===e.attendee_type?e.isSelf?Z():ze({user:{uuid:e.uuid}}):"external"===e.attendee_type?Ze({user:{uuid:e.uuid}}):(p.resetAttendeeData(),ye(),$(u.selector+'[type="'+L+'"]').modal("hide"))}function Be(e,t){var n=t?"yes":"no",i=e===D.currentUser.uuid;if(i&&!D.canUserChangeSelfAttendance&&D.defaultStateOfAreYouAttending&&D.defaultStateOfAreYouAttending!==n){var o=t?"cannot_attend_meeting":"must_attend_meeting";return I.notificationModal({body:i18n.t(o),title:i18n.t("sorry"),"class":"red"}),!1}return!i||!ge(t?"yes":"no")||(I.notificationModal({body:i18n.t("reinvite_before_attending_meeting"),title:i18n.t("reinvite_before_attending_meeting_title"),"class":"red"}),!1)}function Ue(e,t){I.notificationModal({title:i18n.t("calendar_notify_title_overlapping_block"),body:e,"class":"yellow",dismiss:function(){f.unselectInternalAttendee(t)}})}function Fe(e){e.preventDefault();var n=$(this),i=n.data("uuid");if(Be(i,!0)){Je(n,i,t);f.selectInternalAttendee(i,function(e){e&&Ue(i18n.t("user_not_available"),i)}),je(i),He(i)}}function je(e){D.enable_meeting_host&&D.enable_meeting_host.toBoolean()&&m.persistRequestorAsHost&&e===ae()&&D.assign_requestors_as_meeting_host_by_default&&Ye(e)}function He(e){(function(e){return D.enable_meeting_host&&D.enable_meeting_host.toBoolean()&&D.assign_mapped_user_as_meeting_host_by_default&&e.mapped_topic})(m.getAttendeeDetails(e)||{})&&Ye(e)}function Ye(e){te.call($('.add-keynote-speaker[data-uuid="'+e+'"]',".selected-attendee"))}function Le(e){e.preventDefault();var n=$(this),i=n.data("uuid");Be(i,!1)&&(f.updateAttendeeAsHost(i,!1),We(n,i,t),f.unselectInternalAttendee(i))}function Je(e,n,i){var o,a=e.closest(".attendee-item"),s=Qe(o=i===t?m.getAttendeeDetails(n,"internal"):m.getAttendeeDetails(n,"external"),i);if(a.clone().addClass(s).appendTo($(".selected-attendee",i)),$("#send_ics_"+n).prop("checked",!0),a.addClass("hide"),n===D.currentUser.uuid&&(f.updateAreYouAttending("yes"),0===a.length&&n===D.currentUser.uuid)){var r=_.cloneDeep(D.currentUser);r.available=!0,r.selected&&(r.selectedClassName="added");var d=HandlebarsTemplates["book/attendee_item"]({unmapped_users:[r],add_label:i18n.t(J.internal),remove_label:i18n.t(V.internal),show_send_ics_btn:Se(i),meeting_host_config:Ce(i),meeting_host_label:D.meeting_host_label});$(d).addClass(s).appendTo($(".selected-attendee",i)),setTimeout(function(){Ae([r],i)},50)}setTimeout(function(){Ae([o],i)},50)}function Ve(e){var t=$(this).parent().data("attuuid"),n=$(this).data("endorsed");f.updateAttendeePreEndorsement(t,n),$(e.currentTarget).closest(".attendee-item").removeClass("endorsed").addClass("added")}function We(e,n,i){var o=$('.attendee-item.hide[data-uuid="'+n+'"]',i);o.find(".attendee-pic > i").removeClass("jif-iris-host").addClass("jif-user"),o.find(".status-label.host").text(""),o.removeClass("meeting-host"),o.find(".add-keynote-speaker").removeClass("hide"),o.find(".remove-keynote-speaker").addClass("hide");var a=_.find(C.model.internal,{uuid:n});if(a&&!a.available&&o.addClass("unavailable"),o.length>0)e.closest(".attendee-item").remove(),o.removeClass("hide added");else if(n!==D.currentUser.uuid)if(m.selection.internal[n]&&m.selection.internal[n].mapped_topic){var s=$(".mapped-users-header");if(s.length)s.after(e.closest(".attendee-item").removeClass("added"));else{var r=$('<div class="mapped-users-header grouper"></div>');r.text(i18n.t("mapped_users_header")),$(".selected-attendee",t).after(r),r.after(e.closest(".attendee-item").removeClass("added"))}}else e.closest(".attendee-item").removeClass("added").appendTo(i)}function ze(e){var n=e.user&&e.user.uuid,i=$('.attendee-item[data-uuid="'+n+'"]',$(".selected-attendee",t));i&&We(i,n,t)}function Ze(e){var t=e.user&&e.user.uuid;We($('.attendee-item[data-uuid="'+t+'"]',$(".selected-attendee",n)),t,n)}function Ge(e,t,n){var i=e.user;_.isUndefined(i.send_ics)&&(i.send_ics=!0),i.uuid===D.currentUser.uuid&&f.updateAreYouAttending("yes");var o=$('.attendee-item[data-uuid="'+i.uuid+'"]',t);if(i.selected&&(i.selectedClassName="added"),0===o.length){var a=HandlebarsTemplates["book/attendee_item"]({unmapped_users:[i],add_label:i18n.t(J[n]),remove_label:i18n.t(V[n]),show_send_ics_btn:Se(t),meeting_host_config:Ce(t),meeting_host_label:D.meeting_host_label});o=$(a)}else o.addClass("hide"),o=o.clone().removeClass("hide");var s=Qe(i,t);o.addClass(s),o.appendTo($(".selected-attendee",t)),Ae([i],t),"internal"===n&&(je(i.uuid),He(i.uuid))}function Qe(e,t){return e.confirm_endorse_button?"endorsed":Se(t)?"added external-ics":"added"}function Ke(e){f.updateAreYouAttending(null),x.slideDown(),$("#attendingStatus").find(".jif-dropright-filled").addClass("hide").next().removeClass("hide")}return{init:function(e){"undefined"!=typeof jiffle&&K(e),D.currentUser.first_name+" "+D.currentUser.last_name+", ",G(),m.listen(function(e){var t=z[e.type];t&&t(e)}),y.listen(function(e){var t=z[e.type];t&&t(e)}),w.listen(function(e){var t=z[e.type];t&&t(e)}),p.listen(function(e){if(e.success){if(p.resetAttendeeData(),ye(),$(u.selector+'[type="'+L+'"]').modal("hide"),"closePopup"===e.type)return;e.user&&("internal"===e.attendee_type?Ge(e,t,"internal"):Ge(e,n,"external"))}else I.notificationModal({body:i18n.t("Please contact event support for assistance"),title:i18n.t("Access denied"),"class":"red"})}),g.listen(function(e){"undefined"!=typeof jiffle&&e.data.resources!==undefined&&e.data.resources.external_users.length&&(_.forEach(e.data.resources.external_users,function(e){if(!e.uuid.includes("dummy_")){var t=n.find('.attendee-item[data-email="'+e.email.replace(/[!"#',\/:;<=>?[\\\]^`{|}~]/g,"\\$&")+'"]');t.length&&(t.data("uuid",e.uuid),t.attr("data-uuid",e.uuid),t.find("[data-uuid]").data("uuid",e.uuid),t.find("[data-uuid]").attr("data-uuid",e.uuid))}}),m.updateExternalSfdcUserUUID(e.data.resources.external_users))}),Q(),D.isConsecutiveMeeting?(x.hide(),J.external="add_to_all",V.external="remove_from_all"):D.allowRequestorToAddInternalAttendee||$("#attendee-addbtn").hide(),p.updateAttendeeType(d),k.request&&!0===k.request.isExternalRequest&&$("a[href='#external-attendees-tab']").tab("show")},addAttendeeAsKeynoteSpeaker:te,meetingHostUIAction:ie}}();t.exports=I}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/Attendee/handler.js","/app/scripts/Book/Attendee")},{"../../Sfdc/SfdcAccount/store":83,"../../UserForms/handler":89,"../BriefingRequest/store":12,"../Calendar/handler":14,"../Calendar/store":15,"../CommonStore":19,"../Expert/actions":36,"../Expert/store":38,"../MeetingInMaking/store":47,"../MeetingType/store":50,"./actions":8,"./store":10,_process:114,buffer:112}],10:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var m=e("./actions"),h=e("common_api"),p=e("../MeetingInMaking/actions"),g=e("../Expert/actions"),v=window.selectedActivityUuid,y=e("../ConsecutiveMeetings/stores/mainStore"),b=e("../MeetingType/store").MeetingStore,w=e("../BriefingRequest/store"),M=e("../../Sfdc/SfdcAccount/store"),C=e("../../Sfdc/commons"),S=e("../../Sfdc/commonStore"),A=window,x=A.envDetails,D=A.meetingInfo,k=A.mode,T=A.isOngoingSales,E=A.mappingEnabled,I=e("../../commons/utils"),R=e("../OngoingSales/store"),O=Reflux.createStore({init:function(){this.listenTo(M,this.refreshExtAttList),this.listenToMany(m),this.internalAttendees={},this.externalAttendees={},this.internalPage={},this.externalPage={},this.fetchingInternal=!1,this.fetchingExternal=!1,this.extAttendeeProperties={},this.experts={},this.roles=[],this.selection={internal:{},external:{}},this.roleFilter={internal:[],external:[]},this.canSelect=!0,this.overRideRoomNonMMcapacityPopup=!1,this.overRideRoomcapacityPopup=!1,this.totalEntries={internal:{},external:{}},this.editAttendeeStatusHash={internal:{},external:{}},this.attendeeOptions={},this.pageName="book_meeting",this.declinedInviteStatus="declined",this.declinedIcsStatus="Declined",this.persistRequestorAsHost=!0,this.isSFDC="undefined"!=typeof jiffle},considerConsecutiveMeetings:function(e){x.isConsecutiveMeeting&&(e=_.merge(e,y.getRemainingMeetingsData()))},updateInviteeHash:function(e,t){var n=this.editAttendeeStatusHash.internal[e]||this.editAttendeeStatusHash.external[e];n&&(n.invite_status=t)},onShowAttendeesList:function(e){this.trigger({type:"showAttendeesList",attendeeType:e})},onFetchInternal:function(e,t){var n=this.internalPage.current_page||0,i=t||{},o=i.per_page||15,a=i.topicChange;if(!this.isInternalAttendeesHidden()&&!1===this.fetchingInternal&&n!==e){if(this.fetchingInternal=!0,setTimeout(function(){this.fetchingInternal=!1}.bind(this),2e3),n>=(this.internalPage.total_pages||1e3))return;var s={per_page:o,page:e,ignore_activity:!0,search:this.searchTerm,roles:this.roleFilter.internal,activity_uuid:v,basic_info:!0};this.setMeetingTimes(s),"edit"===D.request.mode&&(s.meeting_request=D.request.uuid);var r=!1;if(x.topicManagementEnabled&&x.topicUserMappingEnabled){if("undefined"!=typeof window.topic_uuid)s.topic_uuid=window.topic_uuid;else if("new"===k){var d=$("#topic_management").val();void 0===d&&(d=D.request.topic_uuid),"-"===d&&(d=""),s.topic_uuid=d}else s.topic_uuid=D.request.topic_uuid;r=!!s.topic_uuid}T&&(s.time_zone=R.getTimeZoneId()),"undefined"!=typeof window.briefing_uuid&&(s.briefing_uuid=window.briefing_uuid),window.envDetails.setBlockToken(s);var c=h.fetch({url:h.ENDPOINTS.internal_attendees,data:s});c.then(function(e){this.fetchingInternal=!1,e.data.items=this.addExperts(e.data.items,this.experts.internal),this.internalAttendees=this.internalAttendees||{},this.selection.internal=this.selection.internal||{};var t=Object.assign({},x.currentUser,{available:!0});e.data.items.splice(0,0,t),this.addAttendeesBatch(this.internalAttendees,this.selection.internal,e.data.items,a),this.updateSelection(this.internalAttendees,this.selection.internal),this.internalPage=e.data;var n={items:this.getAttendeesArray(_.assign({},this.selection.internal,this.internalAttendees)),current_page:e.data.current_page,total_pages:e.data.total_pages,groupData:r};this.totalEntries.internal=Number(e.data.total_entries),this.trigger({type:"internal",data:n,page:e.data.current_page})}.bind(this)),c[c.fail?"fail":"catch"](function(e){this.fetchingInternal=!1,this.trigger({type:"usersFetchError",data:e.responseJSON})}.bind(this))}},getAttendeeDetails:function(e){return this.internalAttendees[e]||this.selection.internal[e]||this.externalAttendees[e]||this.selection.external[e]||{}},updateExternalSfdcUserUUID:function(e){e.length&&_.forEach(e,function(e){if(!e.uuid.includes("dummy_")){var t=_.findKey(this.externalAttendees,{email:e.email}),n=_.findKey(this.selection.external,{email:e.email});t!==undefined&&t.includes("dummy_")&&(this.externalAttendees[t].uuid=e.uuid,this.externalAttendees[e.uuid]=this.externalAttendees[t],delete this.externalAttendees[t]),n!==undefined&&n.includes("dummy_")&&(this.selection.external[n].uuid=e.uuid,this.selection.external[e.uuid]=this.selection.external[n],delete this.selection.external[n])}}.bind(this))},getAttendeesArray:function(e){var t=[];if(e instanceof Object)for(var n in e)t.push(e[n]);return t},getAttendeeHash:function(e){var t={};return e instanceof Array&&_.forEach(e,function(e){t[e.uuid]=e}),t},onUnselectAttendee:function(e,t){t=t||{},"internal"===P.attendee_type?this.onUnselectInternalAttendee(e):this.onUnselectExternalAttendee(e),t.silent&&e===x.currentUser.uuid&&(this.onUnselectInternalAttendee(e),this.trigger({type:"removeSelf"})),t.silent||this.trigger(_.merge({type:"cannotSelectAttendee",uuid:e,attendee_type:"internal",isSelf:e===x.currentUser.uuid},t))},canAssignMappedUserAsMeetingHostByDefault:function(e){return x.enable_meeting_host&&x.enable_meeting_host.toBoolean()&&x.assign_mapped_user_as_meeting_host_by_default&&e.mapped_topic},isAssignOnlyTopicMappedAttendeeHostEnabled:function(){return x.assign_only_topic_mapped_user_as_meeting_host&&x.assign_only_topic_mapped_user_as_meeting_host.toBoolean()},isTopicSelected:function(){var e=$("#topic_management-complement");return!("-"===e.val()||!e.val())},canRequestorEditMeetingHostRole:function(){return x.allow_requestors_to_unassign_meeting_host&&x.allow_requestors_to_unassign_meeting_host.toBoolean()},shouldConsiderAssignOnlyTopicMappedAttendeeHostConfig:function(){return!0===this.isTopicSelected()&&!0===this.isAssignOnlyTopicMappedAttendeeHostEnabled()},isAttendeeMappedToTopic:function(e){return(this.getAttendeeDetails(e)||{}).mapped_topic},canMeetingHostBeEdited:function(){return this.isJuniorMMorAbove()||this.canRequestorEditMeetingHostRole()},canAttendeeBeAssignedHost:function(e){return!1===this.isJuniorMMorAbove()?!0===this.canRequestorEditMeetingHostRole()?!0===this.shouldConsiderAssignOnlyTopicMappedAttendeeHostConfig()?{error:!this.isAttendeeMappedToTopic(e),message:i18n.t("can_not_select_unmapped_attendee")}:{error:!1}:{error:!0,message:i18n.t("can_not_edit_host_message")}:{error:!1}},getMeetingHostInfoForAttendee:function(e,t){return this.canAssignMappedUserAsMeetingHostByDefault(e)?t=!0:t&&!this.isJuniorMMorAbove()&&this.isAssignOnlyTopicMappedAttendeeHostEnabled()&&(t=e.mapped_topic),t},addAttendeesBatch:function(e,t,n){var i=this,o=arguments.length>3&&arguments[3]!==undefined&&arguments[3];_.forEach(n,function(n){if(t[n.uuid])var a=t[n.uuid].meeting_host;if("undefined"==typeof t[n.uuid])e[n.uuid]=n;else{var s=o&&i.isTopicSelected()?i.getMeetingHostInfoForAttendee(n,a):a;_.assign(t[n.uuid],n,{selected:!0,meeting_host:s})}n.uuid===x.currentUser.uuid&&t[n.uuid]&&"declined"===t[n.uuid].invite_status&&_.assign(t[n.uuid],{selected:!1,meeting_host:a})})},addExternalAttendeesBatchSFDC:function(e,t,n){_.forEach(n,function(n){var i=_.findKey(t,{email:n.email});i!==undefined?(n.uuid=i,_.assign(t[i],n,{selected:!0})):e[n.uuid]=n})},onUpdateAreYouAttending:function(e){p.updateAreYouAttending(e)},setMeetingTimes:function(e){if(this.currentEvent){var t=(this.currentEvent.end_date-this.currentEvent.start_date)/1e3/60,n=60*this.currentEvent.start_date.getHours()+this.currentEvent.start_date.getMinutes(),i=n+t;e.event_date=moment(this.currentEvent.start_date).format("DD-MM-YYYY"),e.start_time=n,e.end_time=i}},onFetchLeadDetails:function(e,t){if(!window.isEBCEvent&&!1===this.isExternalAttendeesHidden()){var n=this.externalPage.current_page||0;if(!this.fetchingExternal&&n!==e){if(this.fetchingExternal=!0,n>=(this.externalPage.total_pages||1e3))return;var i={leadIds:[],per_page:15,page:e,search:this.externalSearchTerm,roles:this.roleFilter.external};this.addSelectedAttendeesEmail(i);var o=h.fetch({url:h.ENDPOINTS.lead_details,data:i});o.then(function(e){this.fetchingExternal=!1,this.extAttendeeProperties.total_pages=e.data.total_pages,this.extAttendeeProperties.current_page=e.data.current_page,this.addExternalAttendeesBatchSFDC(this.externalAttendees,this.selection.external,e.data.items),this.updateSelection(this.externalAttendees,this.selection.external),this.externalPage=e.data;var t={items:this.getAttendeesArray(_.assign({},this.selection.external,this.externalAttendees)),current_page:e.data.current_page,total_pages:e.data.total_pages};this.trigger({type:"external",data:t,page:e.data.current_page})}.bind(this)),o[o.fail?"fail":"catch"](function(e){this.fetchingExternal=!1,this.trigger({type:"usersFetchError",data:e.responseJSON})}.bind(this))}}},onFetchExternal:function(e,t){if("undefined"==typeof jiffle||!window.isLeadsMeeting||x.showJifflenowExternalAttendees){if(!window.isEBCEvent&&!1===this.isExternalAttendeesHidden()){var n=this.externalPage.current_page||0;if(!this.fetchingExternal&&n!==e){if(this.fetchingExternal=!0,n>=(this.externalPage.total_pages||1e3))return;var i={per_page:15,page:e,search:this.externalSearchTerm,roles:this.roleFilter.external,basic_info:!0};this.setMeetingTimes(i);var o=h.ENDPOINTS.external_attendees;"undefined"==typeof jiffle||x.showJifflenowExternalAttendees||("edit"===D.request.mode?i.account_id=D.request.custom_fields.meeting_account_id:i.account_id=M.selectedAccount.id,o=h.ENDPOINTS.fetch_contacts),"undefined"!=typeof jiffle&&x.showJifflenowExternalAttendees&&(i.registered_only=!0),"edit"===D.request.mode&&(i.meeting_request=D.request.uuid),i.activity_uuid=v,T&&(i.time_zone=R.getTimeZoneId()),this.considerConsecutiveMeetings(i),window.envDetails.setBlockToken(i),this.isSFDC&&this.addSelectedAttendeesEmail(i);var a=h.fetch({url:o,data:i});a.then(function(e){this.fetchingExternal=!1,e.data.items=this.addExperts(e.data.items,this.experts.external),this.extAttendeeProperties.total_pages=e.data.total_pages,this.extAttendeeProperties.current_page=e.data.current_page,"undefined"==typeof jiffle||x.showJifflenowExternalAttendees?this.addAttendeesBatch(this.externalAttendees,this.selection.external,e.data.items):this.addExternalAttendeesBatchSFDC(this.externalAttendees,this.selection.external,e.data.items),this.updateSelection(this.externalAttendees,this.selection.external),this.externalPage=e.data;var t={items:this.getAttendeesArray(_.assign({},this.selection.external,this.externalAttendees)),current_page:e.data.current_page,total_pages:e.data.total_pages};this.trigger({type:"external",data:t,page:e.data.current_page})}.bind(this)),a[a.fail?"fail":"catch"](function(e){this.fetchingExternal=!1,this.trigger({type:"usersFetchError",data:e.responseJSON})}.bind(this))}}}else this.onFetchLeadDetails(e,t)},addSelectedAttendeesEmail:function(){var e=this;(arguments.length>0&&arguments[0]!==undefined?arguments[0]:{}).selectedAttendees=Object.keys(this.selection.external).map(function(t){return e.selection.external[t].email})},onRefreshExternalAttendees:function(){if(0!==this.externalAttendees.length){var e={items:this.getAttendeesArray(_.assign({},this.selection.external,this.externalAttendees)),current_page:this.extAttendeeProperties.current_page,total_pages:this.extAttendeeProperties.total_pages};this.trigger({type:"external",data:e,page:this.extAttendeeProperties.current_page})}},onRoleFilterChosen:function(e,t,n){var i=this.roleFilter[n]||[];t?i.push(e):_.remove(i,function(t){return e===t})},onRemoveFilters:function(e){this.roleFilter[e]=[],"internal"===e?(this.resetInternalList(),this.onFilterInternal(1)):this.onFilterExternal(1)},onInitiateNewMeeting:function(e,t){v=e,this.fetchingInternal=!1,this.fetchingExternal=!1,this.experts={},this.canSelect=!0,this.totalEntries={internal:{},external:{}},this.attendeeOptions={},this.currentEvent=t.event||null,this.updateAttedeeInviteStatuses(t),this.resetInternalList(),this.resetExternalList(),this.selection.internal=this.getAttendeeHash(t.internal),this.selection.external=this.getAttendeeHash(t.external),this.persistRequestorAsHost=!x.isConsecutiveMeeting||t.persistRequestorAsHost,this.trigger({type:"initiateAttendee",data:t})},updateAttedeeInviteStatuses:function(e){var t={};_.each(e.internal,function(e){t[e.uuid]=e,e.selected=!0,e.available=!0}),this.editAttendeeStatusHash.internal=t;var n={};_.each(e.external,function(e){n[e.uuid]=e,e.selected=!0,e.available=!0}),this.editAttendeeStatusHash.external=n},canSelectAttendee:function(e,t,n){if(this.canSelect||this.capacityCheckForNonMM()||this.isCurrentUserAddedForCm())this.userAddToListActions[t].call(this,e,n);else{var i={uuid:e,attendee_type:t};"internal"===t&&_.merge(i,{isSelf:e===x.currentUser.uuid}),this.isJuniorMMorAbove()?this.trigger(_.merge({type:"overRideRoomcapacity"},i)):this.trigger(_.merge({type:"cannotSelectAttendee"},i))}},onCanReinviteAttendee:function(e,t,n){if(this.canSelect||this.capacityCheckForNonMM()||x.isConsecutiveMeeting)if(x.isConsecutiveMeeting){var i={uuid:e};this.trigger({type:"canReinviteAttendeesInConsecMeeitngs",user:i,attendeeType:t,callbackFunction:n})}else this.trigger({type:"reinviteAttendees",callbackFunction:n});else this.isJuniorMMorAbove()?this.trigger({type:"overRideRoomcapacity",uuid:e,attendee_type:"external",callbackFunction:n}):this.trigger({type:"showCannotIncludeAttendee",message:i18n.t("cannot_reinvite_as_capacity_reached_in_edit")})},onSelectExternalAttendee:function(e){C.syncExtAttendeeToSFDC(this.externalAttendees[e],!1)?S.onSyncAttendeeToSfdc(this.externalAttendees[e],function(t){t.user&&(this.externalAttendees[e].Id=t.user.sfdc_contact_id||t.user.sfdc_lead_id),this.canSelectAttendee(e,"external")}.bind(this)):this.canSelectAttendee(e,"external")},onSelectInternalAttendee:function(e,t){this.canSelectAttendee(e,"internal",t)},isCurrentUserAddedForCm:function(e){return x.isConsecutiveMeeting},userAddToListActions:{internal:function(e,t){var n=this.internalAttendees[e];if(n?n.selected=!0:n=e===x.currentUser.uuid?x.currentUser:{uuid:e},this.getOriginalInviteeStatuses(n,"internal"),!this.selection.internal[e]){var i=_.cloneDeep(n);x.currentUser.uuid===n.uuid&&(i.meeting_host=!1),this.selection.internal[e]=i,delete this.internalAttendees[e],this.trigger({type:"internalAttendeeSelected",user:i,userCallback:t})}},external:function(e){var t=this.externalAttendees[e];t?t.selected=!0:t={uuid:e},this.getOriginalInviteeStatuses(t,"external"),this.selection.external[e]||(this.selection.external[e]=t,delete this.externalAttendees[e],this.trigger({type:"externalAttendeeSelected",user:t}))}},capacityCheckForNonMM:function(){return"edit"===k&&this.getExistingUserCountInMeeting()>b.selectedRoom.capacity&&(this.overRideRoomNonMMcapacityPopup=!0),"edit"===k&&b.attendeeCount<this.getExistingUserCountInMeeting()},isJuniorMMorAbove:function(){return x.isCSM()||x.isMeetingManager()||x.isJuniorMM()},getOriginalInviteeStatuses:function(e,t){var n=e.meeting_host;if(this.editAttendeeStatusHash[t][e.uuid]){var i=this.editAttendeeStatusHash[t][e.uuid],o=i.selected,a=i.available,s=i.invite_status;e=l({},e,o,a,{invite_status:s})}e.meeting_host=n},updateAutoAddedExpertsCountIfAny:function(){var e=0;this.isInternalAttendeesHidden()&&(e=this.experts.internal.length),this.isExternalAttendeesHidden()&&(e+=this.experts.external.length),this.trigger({type:"setHiddenExpertsCount",data:e})},getExistingUserCountInMeeting:function(){var e=b.getCurrentAgendaUUID(),t=[];return x.isConsecutiveMeeting||(t=_.uniq([].concat(f(this.filterNonDeclinedAttendees(D.request.users.internal)),f(this.filterNonDeclinedAttendees(D.request.users.external)),f(w.BriefingRequestStore.getAttendeesForAgenda(e))),"uuid")),t.length},filterNonIcsDeclinedAttendees:function(e){return _.filter(e,function(e){return e.ics_status!==this.declinedIcsStatus}.bind(this))},filterNonDeclinedAttendees:function(e){return _.filter(e,function(e){return e.invite_status!==this.declinedInviteStatus}.bind(this))},onUnselectInternalAttendee:function(e){var t=_.cloneDeep(this.selection.internal[e]);t?(t.selected=!1,this.internalAttendees[e]=t):t={uuid:e},delete this.selection.internal[e],this.trigger({type:"internalAttendeeUnselected",user:t})},getInternalSelectedUsers:function(e){return this.selection.internal[e]},getExternalSelectedUser:function(e){return this.selection.external[e]||{}},onUpdateIcsStatus:function(e,t){this.selection.external[e].send_ics=t},onUpdateAttendeeAsHost:function(e,t){var n=this.selection.internal[e];n&&(n.meeting_host=t,this.trigger({type:"setMeetingHost",user:this.selection.internal[e]}))},onUpdateAttendeePreEndorsement:function(e,t){var n=this.selection.internal[e];n&&(n.pre_endorse=t,this.trigger({type:"setUserPreEndorsement",user:n}))},getUserStatus:function(e){return this.selection.internal[e].invite_status},onUnselectExternalAttendee:function(e){var t=_.cloneDeep(this.selection.external[e]);t?(t.selected=!1,this.externalAttendees[e]=t):t={uuid:e},delete this.selection.external[e],this.trigger({type:"externalAttendeeUnselected",user:t})},onAllExternalAttendeeUnselected:function(){if(Object.keys(this.selection.external).length){var e=_.cloneDeep(this.selection.external);this.selection.external={},this.trigger({type:"allExternalAttendeeUnselected",user:e})}},onTabChanged:function(e){var t=this.searchTerm||"";"external"===e&&(t=this.externalSearchTerm||""),this.trigger({type:"tabChanged",searchTerm:t,roles:this.roleFilter[e]})},onEditAttendees:function(e,t,n){if(e){var i=e.internal.length+e.external.length;this.updateAttedeeInviteStatuses(e),this.selection.internal=this.getAttendeeHash(e.internal),this.selection.external=this.getAttendeeHash(e.external),this.updateSelection(this.internalAttendees,this.selection.internal),this.updateSelection(this.externalAttendees,this.selection.external),i>0&&this.trigger({type:"editAttendees",users:e,hasCurrUser:t,dontUpdateCalendar:n})}},checkMappedMeetingHostConfig:function(e){return x.enable_meeting_host&&x.enable_meeting_host.toBoolean()&&x.assign_mapped_user_as_meeting_host_by_default&&e.mapped_topic},canBeMeetingHost:function(e){_.map(e,function(e){this.checkMappedMeetingHostConfig(e)&&(e.meeting_host=!0)}.bind(this))},onCopyAttendees:function(e){if(e){e.internal=this.filterInternalUsers(e.internal),e.external=this.filterExternalUsers(e.external);var t=this.isCurrentUserPresentInInternalAttendees(e.internal),n=this.getAttendeeCount(this.selection.internal),i=this.getAttendeeCount(this.selection.external),o=n+i;_.merge(this.selection.internal,this.getAttendeeHash(e.internal)),_.merge(this.selection.external,this.getAttendeeHash(e.external)),this.updateSelection(this.internalAttendees,this.selection.internal),this.updateSelection(this.externalAttendees,this.selection.external);var a={};a.internal=_.map(this.selection.internal,function(e){return e}),a.external=_.map(this.selection.external,function(e){return e}),this.updateAttedeeInviteStatuses(a);var s=this.getAttendeeCount(a.internal),r=this.getAttendeeCount(a.external),d=s+r;this.canBeMeetingHost(a.internal),d-o>0&&(this.trigger({type:"editAttendees",users:a,hasCurrUser:t}),this.onEventCreated(this.currentEvent),this.isRoomCapacityOver()&&$(".remove-selected-room").click()),this.trigger({type:"onCopyAttendees",internalCount:s-n,externalCount:r-i,hasCurrUser:t})}},filterInternalUsers:function(e){return this.isInternalAttendeesHidden()?e=this.isCurrentUserPresentInInternalAttendees(e)&&this.canUserChangeSelfAttendance()?this.filterInternalUsersForCurrentUser(e):[]:(this.isCurrentUserPresentInInternalAttendees(e)&&(this.canUserChangeSelfAttendance()||(e=this.removeCurrentUserFromInternalUser(e))),window.isEBCEvent&&(e=this.filterInternalUsersForBriefing(e))),_.forEach(e,function(e){this.getOriginalInviteeStatuses(e,"internal")}.bind(this)),e},filterExternalUsers:function(e){return x.isConsecutiveMeeting&&(e=_.filter(e,function(e){return!0===e.available||"true"===e.available})),(window.isEBCEvent||this.isExternalAttendeesHidden())&&(e=[]),_.forEach(e,function(e){this.getOriginalInviteeStatuses(e,"external")}.bind(this)),e},canUserChangeSelfAttendance:function(){return x.canUserChangeSelfAttendance},isCurrentUserPresentInInternalAttendees:function(e){return this.getCurrentUser(e)!==undefined},getCurrentUser:function(e){var t=x.currentUser.uuid;return _.find(e,function(e){return e.uuid===t})},filterInternalUsersForCurrentUser:function(e){var t=this.getCurrentUser(e);return e=_.filter(e,function(e){return e.uuid===t.uuid})},removeCurrentUserFromInternalUser:function(e){var t=this.getCurrentUser(e);return _.remove(e,function(e){return e.uuid===t.uuid}),e},filterInternalUsersForBriefing:function(e){var t=w.BriefingRequestStore.briefingInternalAttendees;return t&&(e=_.filter(e,function(e){return _.findIndex(t,function(t){return t.uuid===e.uuid})<0})),e},getAttendeeCount:function(e){return Object.keys(e).length},isRoomCapacityOver:function(){return b.selectedRoom&&b.attendeeCount>b.selectedRoom.capacity},resetInternalList:function(){this.internalPage={},this.fetchingInternal=!1,this.internalAttendees={}},onResetAndFetchInternalAttendees:function(){this.resetInternalList(),this.onFetchInternal(1,{topicChange:!0})},onResetInternalAttendeeList:function(e){var t=this,n=arguments.length>1&&arguments[1]!==undefined&&arguments[1];e&&e.forEach(function(e){return delete t.selection.internal[e]});var i=x.currentUser.uuid,o=_.cloneDeep(this.selection.internal[i]);this.resetInternalList(),this.canSelect=!0,e||(this.selection.internal={},o&&(!1===I.isJmmOrAbove()&&x.assign_only_topic_mapped_user_as_meeting_host&&(o.meeting_host=!1),this.selection.internal[i]=o)),this.trigger({type:"resetInternalAttendeeList",user:o,topicChange:n})},onResetExternalAttendeeList:function(){this.resetExternalList(),this.onFetchExternal(1)},resetExternalList:function(){this.externalPage={},this.fetchingExternal=!1,this.externalAttendees={}},onSearchInternal:function(e){this.resetInternalList(),this.searchTerm=e,this.onFetchInternal(1)},onSearchExternal:function(e){this.resetExternalList(),this.externalSearchTerm=e,this.onFetchExternal(1)},onFilterInternal:function(){this.resetInternalList(),this.onFetchInternal(1)},onSetExperts:function(e){var t=e.data.data;this.experts=t.items,!_.isEmpty(b.selectedRoom)&&this.updateAutoAddedExpertsCountIfAny(),this.resetExperts(this.experts.internal,this.selection.internal),this.resetExperts(this.experts.external,this.selection.external)},resetExperts:function(e,t){_.forEach(t,function(e){e.expert=!1}),_.forEach(e,function(e){var n=t[e.uuid];n&&(n.expert=!0)})},addExperts:function(e,t){var n=_.union(t,e);return n=_.uniq(n,function(e,t,n){return e.uuid})},onFilterExternal:function(){this.resetExternalList(),this.onFetchExternal(1)},updateSelection:function(e,t){_.forEach(e,function(n,i){t[i]&&delete e[i]})},onResetAllAttendees:function(){this.resetInternalList(),this.resetExternalList(),this.onFetchInternal(1),this.onFetchExternal(1)},onEventCreated:function(e){this.currentEvent=e,E?(g.setCurrentEvent(e),g.fetchExperts({callback:function(){this.onResetAllAttendees()}.bind(this)})):this.onResetAllAttendees()},onDomainValidate:function(e){e.activity_uuid=v,e.event_uuid=x.event.uuid,e.requested_page=this.pageName;var t=h.fetch({url:D.domainValidateUrl,prefix:"",data:e});return t.then(function(e){this.trigger({type:"emailFieldValidatorHandler",apiResponse:e})}.bind(this)),t[t.fail?"fail":"catch"](function(e){console.log(e)}),t},onCanSelectAttendees:function(e){this.canSelect=e},persistOverRideRoomPopup:function(e){this.overRideRoomcapacityPopup=e},getOverRideRoomcapacityPopup:function(){return this.overRideRoomcapacityPopup},overRideRoomNonMMcapacityPopup:function(){return this.overRideRoomNonMMcapacityPopup},resetOverRideRoomNonMMcapacityPopup:function(e){this.overRideRoomNonMMcapacityPopup=e},onSetAttendeeOptionsSetting:function(e){this.attendeeOptions=e},isInternalAttendeesHidden:function(){return!x.isConsecutiveMeeting&&"yes"===this.attendeeOptions.hide_internal_attendees_in_book_meeting},isExternalAttendeesHidden:function(){return!x.isConsecutiveMeeting&&"yes"===this.attendeeOptions.hide_external_attendees_in_book_meeting},onGetattendeeSettings:function(){this.data={internal:this.isInternalAttendeesHidden(),external:this.isExternalAttendeesHidden(),default_mapping:this.attendeeOptions.default_mapping,ics_optout:this.attendeeOptions.external_ics_opt_out,enable_meeting_host:this.attendeeOptions.enable_meeting_host,show_add_internal_attendee:this.showAddAttendeeSection()},this.trigger({type:"handleAttendeeSection",payload:this.data})},showAddAttendeeSection:function(){return I.isJmmOrAbove()||this.attendeeOptions.allow_requestor_to_add_internal_attendee.toBoolean()},isMappingEnabled:function(){return"yes"===this.attendeeOptions.default_mapping},refreshExtAttList:function(e){"refreshContactList"===e.type&&(this.onAllExternalAttendeeUnselected(),this.resetExternalList(),this.onFetchExternal(1))}}),P=Reflux.createStore({init:function(){this.listenToMany(m),this.attendee_data={},this.attendee_type="internal",this.createdAttendeeHash={internal:{},external:{}},this.pageName="book_meeting",this.isAttendeeCreated=!1,this.attendeeCustomFieldFetched=!1},setAttendeeCreatedFlag:function(e){this.isAttendeeCreated=e},getAttendeeCreatedFlag:function(){return this.isAttendeeCreated},updateAttendeeData:function(e,t){this.attendee_data[e]=t},updateAttendeeType:function(e){this.attendee_type=e},onCreateAttendee:function(e,t,n,i){x.isConsecutiveMeeting||O.canSelect||O.capacityCheckForNonMM()?this.createNewAttendee(e,t,n,i):O.isJuniorMMorAbove()?O.trigger({type:"overRideRoomcapacity",attendee_type:"createNewAttendee",custom_fields:e,consent:n}):O.trigger({type:"cannotSelectAttendee",attendee_type:this.attendee_type})},createNewAttendee:function(e,t,n,i){this.attendee_data.custom_fields=e||{};var o=h.update({url:h.ENDPOINTS.user_create,prefix:x.urlPrefix,data:{user:this.attendee_data,user_type:this.attendee_type,activity_uuid:v,requested_page:this.pageName,topic_uuid:t,consent:n?"true":"false"}});o.then(function(e){200===e.status&&(this.setAttendeeCreatedFlag(!0),this.addAttendeeData(e.data,!0,i))}.bind(this)),o[o.fail?"fail":"catch"](function(e){console.log(e),this.trigger({error:e.responseJSON,success:!1})}.bind(this))},addAttendeeData:function(e,t,n){var i,o,a,s,r,d;"internal"===this.attendee_type?(i="internalAttendeeSelected",a="internalAttendees"):(i="externalAttendeeSelected",a="externalAttendees"),e&&(o=e.user,d=x.currentUser.uuid,o.available=!0,o.selected=!0,o.sync_contact=this.attendee_data.sync_contact||!1,r=!0,_.assign(o,(O.editAttendeeStatusHash[this.attendee_type]||{})[o.uuid]),d!==o.uuid?(s=O.selection[this.attendee_type])[o.uuid]?(r=!1,o.sync_contact&&(s[o.uuid].sync_contact=o.sync_contact)):(s[o.uuid]=o,O.updateSelection(O[a],s)):(s=O.selection[this.attendee_type])[o.uuid]?r=!1:(s[o.uuid]=o,O.updateSelection(O[a],s)));var c=function(){r?this.trigger({type:i,user:o,attendee_type:this.attendee_type,success:!0,isNewAttendee:t,userCallback:n}):this.trigger({type:"closePopup",success:!0})};"external"===this.attendee_type&&C.syncExtAttendeeToSFDC(o,!0)?S.onSyncAttendeeToSfdc(o,function(e){e.user&&(o.Id=e.user.sfdc_contact_id||e.user.sfdc_lead_id),c.apply(this)}.bind(this)):c.apply(this)},resetAttendeeData:function(){this.attendee_data={}},getAttendeeData:function(){this.attendee_data},setAttendeeCustomFieldFetched:function(e){this.attendeeCustomFieldFetched=e},isAttendeeCustomFieldFetched:function(){return this.attendeeCustomFieldFetched}});t.exports={AttendeeStore:O,AddEditAttendeeStore:P}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/Attendee/store.js","/app/scripts/Book/Attendee")},{"../../Sfdc/SfdcAccount/store":83,"../../Sfdc/commonStore":85,"../../Sfdc/commons":86,"../../commons/utils":106,"../BriefingRequest/store":12,"../ConsecutiveMeetings/stores/mainStore":31,"../Expert/actions":36,"../MeetingInMaking/actions":42,"../MeetingType/store":50,"../OngoingSales/store":54,"./actions":8,_process:114,buffer:112,common_api:"common_api"}],11:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["briefingDetails","getBriefingCenterLongDay"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/BriefingRequest/actions.js","/app/scripts/Book/BriefingRequest")},{_process:114,buffer:112}],12:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){function l(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var f,m=e("./actions"),h=e("common_api"),p=e("../MeetingType/store").MeetingStore,g=Reflux.createStore({init:function(){this.briefingAttendeesCount=0,this.briefingRequestor=null,this.briefingCustomFields={},this.briefingActivities={},this.briefingInternalAttendees=[],this.briefingExternalAttendees=[],this.isDraftEnabled=!1,this.listenTo(m.briefingDetails,this.onBriefingDetails)},onBriefingDetails:function(t){var n=h.fetch({data:{meeting_request_uuid:meetingInfo.request.uuid},url:h.ENDPOINTS.briefing_details.replace("{briefing_uuid}",t||briefing_uuid)});n.then(function(t){f=e("../Attendee/store").AttendeeStore,this.briefingRequestor=t.data.requestor,this.isDraftEnabled=t.data.is_draft_enabled,this.briefingCustomFields=t.data.custom_fields,this.briefingActivities=t.data.activityList.activities,this.briefingInternalAttendees=t.data.internal_attendees,this.briefingExternalAttendees=t.data.external_attendees;var n=this.getAttendeesForAgenda(p.getCurrentAgendaUUID())||[],i=[],o=[];meetingInfo&&meetingInfo.request&&(t.meetingRequest=meetingInfo.request,i=f.filterNonDeclinedAttendees(meetingInfo.request.users.internal),o=f.filterNonDeclinedAttendees(meetingInfo.request.users.external));var a=_.uniq([].concat(l(i),l(o),l(n)),"uuid").length,s=f.filterNonIcsDeclinedAttendees(this.briefingInternalAttendees.concat(this.briefingExternalAttendees));this.briefingAttendeesCount=s.length,this.briefingInternalAttendees.length&&_.findIndex(this.briefingInternalAttendees,function(e){return e.uuid==envDetails.currentUser.uuid})>=0&&(t.isCurrUserAlreadyAdded=!0),p.onAttendeeCountChanged(a),this.trigger({success:!0,data:t})}.bind(this)),n[n.fail?"fail":"catch"](function(e){this.trigger({success:!1,data:e.responseJSON})}.bind(this))},getAttendeesForAgenda:function(e){if(!this.briefingActivities||!Array.isArray(this.briefingActivities))return[];var t=this.briefingActivities.filter(function(t){return t.id===parseInt(e)});return 0===t.length?[]:t[0].agenda_participants||[]}}),v=Reflux.createStore({init:function(){this.listenTo(m.getBriefingCenterLongDay,this.onGetBriefingCenterLongDay)},onGetBriefingCenterLongDay:function(){var e=h.fetch({url:h.ENDPOINTS.briefing_centre_long_day,data:{activity_uuid:selectedActivityUuid}});e.then(function(e){this.trigger({success:!0,data:e})}.bind(this)),e[e.fail?"fail":"catch"](function(e){this.trigger({success:!1,data:e.responseJSON})}.bind(this))}});t.exports={BriefingRequestStore:g,BriefingCenterLongDayStore:v}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/BriefingRequest/store.js","/app/scripts/Book/BriefingRequest")},{"../Attendee/store":10,"../MeetingType/store":50,"./actions":11,_process:114,buffer:112,common_api:"common_api"}],13:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["eventInfo","fetchAvailability","updateCalendar","updateEvent","eventCreated","initialAvailability","initiateNewMeeting"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/Calendar/actions.js","/app/scripts/Book/Calendar")},{_process:114,buffer:112}],14:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l,f=e("./store"),m=e("./actions"),h=e("../Attendee/actions"),p=e("../MeetingType/actions"),g=e("../../commons/calendar_helpers"),v=e("../MeetingInMaking/actions"),y=e("../MeetingInMaking/store"),b=e("../MeetingType/store"),w=e("../BriefingRequest/actions"),M=e("../BriefingRequest/store"),C=e("../Attendee/store").AttendeeStore,S=e("../OngoingSales/handler"),A=e("../OngoingSales/store"),x=e("../../commons/granular_edit"),D=new Date,k=e("../../commons/book/Calendar/handler"),T=!1,E=function(){var e=null,t=!1,n=null,i=null,o=null,a=null,s=($("#attendingStatus"),window.ReactMessage||$(".notification-modal")),r=$(".notification-modal"),d=null,c=$("#topicSubmit"),u=$("#cal_info"),E=[],I=!1,R=!1,O={},P=($("#scheduler_here"),{}),q=!1;function N(e,n,i,o){var a,r,d,c=e.start_date,u=e.end_date,l=i18n.t("room_type"),f=!1,h=(new Date(u)-new Date(c))/60/1e3;if((scheduler.config.offsite_enabled||scheduler.config.booth_tour_enabled)&&(l=oe(c,u,h)),"neither_nor"===l)r=i18n.t("try_select_location"),d=scheduler.config.offsite_enabled&&scheduler.config.booth_tour_enabled?i18n.t("neither_nor_booth_tour_offsite"):scheduler.config.booth_tour_enabled?i18n.t("neither_nor_booth"):i18n.t("neither_nor_offsites"),!1===n?s.notificationModal({title:d,body:r,dismiss:function(){scheduler.deleteEvent(e.id)},"class":"red"}):(f=!0,i(!1,r,e));else if(!t&&(h<scheduler.config.minimum_duration||h>scheduler.config.maximum_duration)){var p=scheduler.date.add(e.start_date,scheduler.config.minimum_duration,"minute"),g={start_date:e.start_date,end_date:p},v=g.start_date,y=g.end_date;if(!1===(M=moment(v).isSame(y,"day"))&&y.getMinutes()>0)a=!0,d=i18n.t("calendar_notify_title"),r=i18n.t("slot_unavailable");else if(scheduler.checkInMarkedTimespan(g,"dhx_time_block")){var w=U(e.start_date,scheduler.config.minimum_duration);g.start_date=scheduler.date.add(g.start_date,-w,"minute"),g.end_date=scheduler.date.add(g.end_date,-w,"minute");var M=moment(g.start_date).isSame(g.end_date,"day");!scheduler.checkInMarkedTimespan(g,"dhx_time_block")&&M||(a=!0,d=i18n.t("calendar_notify_title"),r=i18n.t("slot_unavailable"))}else d=i18n.t("meeting_time"),r=scheduler.config.minimum_duration<scheduler.config.maximum_duration?i18n.t("slot_size_invalid",{min_duration:x.convertMinutesToReadable(scheduler.config.minimum_duration),max_duration:x.convertMinutesToReadable(scheduler.config.maximum_duration),silentMsg:l}):i18n.t("slot_size_exact",{duration:x.convertMinutesToReadable(scheduler.config.minimum_duration),silentMsg:l});if(e.start_date=g.start_date,e.end_date=g.end_date,!1===n){if(d&&r){var C=X(),S=ee(C).map(function(e){return{text:e}});r=_.isEmpty(C)?r:r+i18n.t("participation_reset_message"),d=_.isEmpty(C)?d:d+i18n.t("participation_reset_title_message"),s.notificationModal({title:d,body:r,uiDetails:S,"class":"red",timeout:!a,dismiss:function(){scheduler.updateView()}})}a?scheduler.deleteEvent(e.id):(t=!1,m.eventCreated(e),x.setTimeFields(e))}else f=!0,i(!1,r,e)}return q=!1,!1===f&&n&&i(!0,"",e),(o||"new"===window.mode&&$.urlParam("start_time"))&&function(e){var t="no"===(window.meetingInfo.request.meeting_break_settings||b.MeetingStore.getActivitySettings()).show_meeting_break_notification||!!window.commons.isSessionStorageSupported()&&Boolean(window.sessionStorage.getItem("hideBreak"));if(B(e)&&!T&&!t){var n=b.MeetingStore.getActivitySettings(),i=(a=Number(n.meeting_break_meeting_duration),r=moment.duration(a,"minutes"),d=r.hours(),c=r.minutes(),(d=d?d+" hour":"")+" "+(c=c?c+" min":"")),o=n.meeting_break_duration;T=!0,s.notificationModal({body:i18n.t("break.title",{breakDuration:o,meetingDuration:i}),"class":"comment",detailsAction:{callback:function(){T=!1,window.commons.isSessionStorageSupported()&&window.sessionStorage.setItem("hideBreak",!0)},text:i18n.t("break.buttonText")},dismiss:function(){T=!1},uiDetails:[{text:i18n.t("break.body",{breakDuration:o})}]})}var a,r,d,c}(e),!1}function B(e,t){var n=t||(window.meetingInfo.request.meeting_break_settings||b.MeetingStore.getActivitySettings());if("no"===n.meeting_break_enabled)return!1;var i=e.start_date instanceof Date?e.start_date:moment(e.start_date,"DD-MM-YYYY hh:mm"),o=e.end_date instanceof Date?e.end_date:moment(e.end_date,"DD-MM-YYYY hh:mm");return(new Date(o)-new Date(i))/60/1e3>=Number(n.meeting_break_meeting_duration)}function U(e,t){var n=scheduler.date.time_part(e)/60,i=moment(e).format("YYYY-MM-DD");return t-(_.find(O[i],function(e){return e>n})-n)}function F(e,t){var n=e.toUpperCase(),i=t.toUpperCase();return n<i?-1:n>i?1:0}function j(e){return e.first_name||e.last_name?e.first_name+" "+e.last_name:e}function H(e){return e&&e.length?e.map(j).sort(F).join(", "):""}function Y(){f.CalendarEventStore.listen(function(o){var a;"initiateNewMeeting"===o.type?(a=o.data,n=null,i=null,scheduler.deleteMarkedTimespan(),function(){for(;E.length;)scheduler.detachEvent(E.shift())}(),scheduler.clearAll(),R=a.isNew,m.initialAvailability(a.room.offsite),m.updateCalendar(a,function(){if(a.event){var e=new Date(a.event.start_date),t=moment(window.envDetails.event.start_date).toDate(),n=moment(window.envDetails.event.end_date).toDate();scheduler.config.scroll_hour=e.getHours(),scheduler._date=g.getWeekStartForEdit(t,n,moment(e).startOf("day").toDate()),g.enableNavigationArrows(),g.disableCalendarLeftNavIcon(t),g.disableCalendarRightNavIcon(n),scheduler.update_view(),scheduler.addEvent(_.assign({id:"alreadyAddedEvent"},a.event))}W()})):o.success&&function(n){var i=n.event;if(e=i,isOngoingSales){var o=new Date(moment(n.event.start_date,"YYYY-MM-DD")),a=S.isPastDay(o)?D:o;meetingInfo.request&&meetingInfo.request.start_time&&(a=meetingInfo.request.start_time instanceof Date?meetingInfo.request.start_time:new Date(moment(meetingInfo.request.start_time,"DD-MM-YYYY"))),i.start_date=scheduler.date.add(a,-a.getDay(),"day"),i.end_date=scheduler.date.add(a,7-a.getDay()-1,"day")}var s=scheduler.date.date_part(moment(i.start_date).utc()._d),r=scheduler.date.date_part(moment(i.end_date).utc()._d);scheduler.config.now_date=new Date(1970,1,1),scheduler.config.check_limits=!0,scheduler.config.collision_limit=2,scheduler.config.start_on_monday=!1,scheduler.config.day_date="%D, %M %j",scheduler.config.limit_start=scheduler.date.add(s,-1,"day"),scheduler.config.limit_end=scheduler.date.add(r,1,"day"),scheduler.config.limit_view=!0,scheduler.config.separate_short_events=!0,scheduler.config.multi_day=!1,scheduler.config.mark_now=!1,scheduler.config.edit_on_create=!1;var d=$(".js-calendar-dropleft,.js-calendar-dropright"),c=void 0;window.isOngoingSales?(g.setWeekStartForJFX(s,r),c=7):(g.setWeekStart(),g.hideNonEventDays(s,r),c=4);g.diffenceOfDatesLessThanMaxDays(s,r,c)&&d.addClass("hide");scheduler.config.details_on_create=!1,scheduler.xy.min_event_height=20,scheduler.xy.scale_height=30,scheduler.config.hour_size_px=44,scheduler.config.icons_select=["icon_delete"],scheduler.config.icons_edit=["icon_delete"],V(),scheduler.xy.nav_height=0,scheduler.config.xml_date="%Y-%m-%d %H:%i",scheduler.config.touch=!0,scheduler.config.touch_drag=10,scheduler.config.touch_tip=!1,scheduler.init("scheduler_here",s),!1!==window.isOngoingSales||window.meetingInfo.request.start_time||g.setupCalendarSlideListeners(s,r);scheduler.config.dblclick_create=!1,J(),W(),ie(i),setTimeout(function(){if(meetingInfo.request&&meetingInfo.request.start_time){var e=meetingInfo.request;t="edit"===mode,scheduler.addEvent({start_date:meetingInfo.request.start_time,end_date:meetingInfo.request.end_time,text:"Hello",uuid:meetingInfo.request.uuid,id:"alreadyAddedEvent",didEventAddedOnDemand:!0});var n=e.start_time,i=moment(n,"DD-MM-YYYY");i&&i.isValid()&&(n=i.toDate()),l="alreadyAddedEvent",!1===window.isOngoingSales&&(scheduler.setCurrentView(g.getWeekStartForEdit(s,r,n)),g.setupCalendarSlideListeners(s,r))}},50),isOngoingSales&&S.setCalendarConfig()}(o.data)}),f.CalendarAvailabilityStore.listen(re),f.CalendarInitialAvailabilityStore.listen(ce),M.BriefingCenterLongDayStore.listen(function(e){e.success&&(d=e.data.data.room_initial_availabilities,se())}),M.BriefingRequestStore.listen(function(t){if(t.success){var i,o,a=t.data.data,r="",d="";i=H(a.internal_attendees),o=H(a.external_attendee),$("a","li#meetingWithHead").html(a.briefing_info.briefing_with),$("#meetingWithField").val(a.briefing_info.briefing_with),window.briefing_with=a.briefing_info.briefing_with;var u={internal:[],external:[]};"undefined"!=typeof window.topic_uuid||"undefined"!=typeof window.bam_uuid?_.forEach(a.activityList.activities,function(e,t,n){"undefined"!=typeof window.bam_uuid&&e.id==window.bam_uuid&&(window.meetingInfo.request.topic_management=e.topic_activities_mapped&&e.topic,L(),u=e.agenda_participants&&e.agenda_participants.reduce(function(e,t){return e[a.internal_attendees.filter(function(e){return e.uuid===t.uuid}).length>0?"internal":"external"].push(t.user_name),e},u))}):L(),$("a","li#meetingWithHead").on("click",function(e){e.preventDefault(),e.stopPropagation(),$(".topic-meeting-overlay").slideDown(),$(".attend-meeting-details").slideDown()}),u&&(r=H(u.internal),d=H(u.external));var l={externalAttendees:o,internalAttendees:i,agendaInternalAttendee:r,agendaExternalAttendee:d};$("#briefing-info").popover({trigger:"hover",content:(f=l,$(HandlebarsTemplates["book/briefing_attendee_info"](f))),placement:"bottom",html:!0,template:'<div class="item-popover popover briefing-info-popover"><div class="arrow"></div><div class="popover-content"></div></div>'}),function(t){var i=t.event;e=i;var o=scheduler.date.date_part(moment(i.start_time.split("T")[0]).utc()._d),a=scheduler.date.date_part(moment(i.end_time.split("T")[0]).utc()._d);M.BriefingRequestStore.isDraftEnabled&&(scheduler.config.readonly=!0);scheduler.config.now_date=new Date(1970,1,1),scheduler.config.xml_date="%Y-%m-%d %H:%i",scheduler.config.day_date="%D, %M %j",scheduler.config.use_select_menu_space=!1,scheduler.config.details_on_create=!1;var r=function(){var e=30;window.isEBCEvent&&(e=n.meetingTypeMinSlot||30);return e}();scheduler.config.hour_size_px=22*Math.ceil(60/r),scheduler.config.icons_select=["icon_delete"],scheduler.config.icons_edit=["icon_delete"],scheduler.config.edit_on_create=!1,scheduler.config.mark_now=!1,scheduler.xy.nav_height=0,scheduler.xy.min_event_height=20,scheduler.xy.scale_height=30,g.diffenceOfDatesLessThanMaxDays(o,a)&&$(".js-calendar-dropleft,.js-calendar-dropright").addClass("hide");V(),o.getTime()==a.getTime()?scheduler.init("scheduler_here",o,"day"):(g.setWeekStart(),g.hideNonEventDays(o,a),scheduler.init("scheduler_here",o,"week"));g.setupCalendarSlideListeners(o,a),J(),W(),scheduler.attachEvent("onEventCollision",function(){return!1}),ie(i);var d=window.isEBCEvent?{css:"status-green",html:'<div class="statusTextCls">'+i18n.t("available")+"</div>"}:{};setTimeout(function(){if(meetingInfo.request&&meetingInfo.request.start_time){var e=meetingInfo,t=e.request,n=Object.assign({},{start_date:t.start_time,end_date:t.end_time,uuid:t.uuid,text:"Hello",id:"alreadyAddedEvent"},d);scheduler.addEvent(n),scheduler.checkInMarkedTimespan(n,"dhx_time_block")&&s.notificationModal({title:i18n.t("calendar_notify_title"),body:i18n.t("slot_unavailable"),dismiss:function(){scheduler.deleteEvent(n.id)},"class":"red"})}},5e3),c=i.briefing_meetings_unavailabilites,_.filter(c,function(e){return e.length}).length&&(scheduler.getEvents=function(e,t){var n=[];for(var i in this._events){var o=this._events[i];arguments.length?o&&(!e&&!t||o.start_date<t&&o.end_date>e)&&n.push(o):"existing-briefing-meeting"!==o.type&&n.push(o)}return n},scheduler.attachEvent("onClick",function(e){return!e.includes("existing-briefing-meeting")}),scheduler.attachEvent("onBeforeDrag",function(e,t){return"create"==t||!e.includes("existing-briefing-meeting")}),Object.keys(c).forEach(function(e){_.forEach(c[e],function(t,n){var i=t.slot[0]/60,o=t.slot[1]/60,a=moment(e).add(i,"h").format("DD-MM-YYYY HH:mm"),s=moment(e).add(o,"h").format("DD-MM-YYYY HH:mm");scheduler.addEvent({start_date:a,end_date:s,title:t.title,"class":"ebc-scheduled-meeting",type:"existing-briefing-meeting",id:"existing-briefing-meeting-"+e+"-"+n})})}));var c}({event:a}),$(".detail-container").slideDown(800),c.on("click",function(){$(".attend-meeting-details").slideUp()}),t.data.isCurrUserAlreadyAdded&&setTimeout(function(){$("[name=attend-meeting]").prop("disabled",!0)},1e3)}var f})}function L(){!0===envDetails.topicManagementEnabled&&v.fetchTopicsForEBCMeeting()}function J(){scheduler._render_marked_timespan=function(e,t,n){var i=[],o=scheduler.config,a=this._min_date,s=this._max_date,r=!1;if(!o.display_marked_timespans)return i;if(!n&&0!==n){if(e.days<7)n=e.days;else{var d=new Date(e.days);if(r=+d,!(+s>+d&&+a<=+d))return i;n=d.getDay()}var c=a.getDay();c>n?n=7-(c-n):n-=c}var u=e.zones,l=scheduler._get_css_classes_by_config(e);if(scheduler._table_view&&"month"==scheduler._mode){var f=[],m=[];if(t)f.push(t),m.push(n);else{m=r?[r]:scheduler._get_dates_by_index(n);for(var h=0;h<m.length;h++)f.push(this._scales[m[h]])}for(h=0;h<f.length;h++){t=f[h],n=m[h];var _=Math.floor((this._correct_shift(n,1)-a.valueOf())/(864e5*this._cols.length)),p=this.locate_holder_day(n,!1)%this._cols.length;if(!this._ignores[p]){var g=scheduler._get_block_by_config(e),v=Math.max(t.offsetHeight-1,0),y=Math.max(t.offsetWidth-1,0),b=this._colsS[p],w=this._colsS.heights[_]+(this._colsS.height?this.xy.month_scale_height+2:2)-1;g.className=l,g.style.top=w+"px",g.style.lineHeight=g.style.height=v+"px";for(var M=0;M<u.length;M+=2){var C=u[h];if((D=u[h+1])<=C)return[];(k=g.cloneNode(!0)).style.left=b+Math.round(C/1440*y)+"px",k.style.width=Math.round((D-C)/1440*y)+"px",t.appendChild(k),i.push(k)}}}}else{var S=n;if(this._ignores[this.locate_holder_day(n,!1)])return i;if(this._props&&this._props[this._mode]&&e.sections&&e.sections[this._mode]){var A=this._props[this._mode];S=A.order[e.sections[this._mode]];var x=A.order[e.sections[this._mode]];if(A.days>1)S=S*(A.size||A.options.length)+x;else S=x,A.size&&S>A.position+A.size&&(S=0)}t=t||scheduler.locate_holder(S);for(h=0;h<u.length;h+=2){var D,k;C=Math.max(u[h],60*o.first_hour);if((D=Math.min(u[h+1],60*o.last_hour))<=C){if(h+2<u.length)continue;return[]}(k=scheduler._get_block_by_config(e)).className=l;var T=24*this.config.hour_size_px+1;k.style.top=Math.round((60*C*1e3-36e5*this.config.first_hour)*this.config.hour_size_px/36e5)%T+"px";var E=Math.max(Math.round(60*(D-C)*1e3*this.config.hour_size_px/36e5)%T,1);k.style.lineHeight=Math.min(E,40)+"px",k.style.height=E+"px",t.appendChild(k),i.push(k)}}return i}.bind(scheduler)}function V(){var e=scheduler.date.date_to_str("%g%a");scheduler.templates.hour_scale=function(t){var n="";if(t.getHours()+t.getMinutes()/60<scheduler.config.last_hour-.5)for(var i=0;i<1;i++)n+="<div style='height:21px;line-height:21px;'>"+e(t)+"</div>",t=scheduler.date.add(t,60,"minute");return n},scheduler.templates.day_scale_date=scheduler.date.date_to_str(scheduler.config.day_date),scheduler.templates.event_class=function(e,t,n){return n["class"]||""},scheduler.templates.tooltip_text=function(e,t,n){return""},scheduler.templates.event_text=function(e,t,n){return""},scheduler.templates.event_header=function(e,t,n){return(e=moment(e).format("h:mm"))+" - "+(t=moment(t).format("h:mm"))+(n.title?", "+n.title:"")}}function W(){var e=0;if(!E.length){E[e++]=scheduler.attachEvent("onEmptyClick",function(e,t){var n=$(t.target);n.closest(".resource-block-highlight").length||n.closest(".resource-block").length||n.closest(".initial-block").length||(!l&&scheduler.addEventNow({start_date:e},null,t),l=null)});var n=g.setupCalendarslotInfo({dataStore:y,calendarStore:f.CalendarAvailabilityStore,meetingTypeStore:b.MeetingStore,onGoingSalesStore:A});E[e++]=n.event,P=n.PubSubManager,scheduler.attachEvent("onMouseDown",function(e){return!0}),E[e++]=scheduler.attachEvent("onBeforeViewChange",function(e,t,n,i){return setTimeout(function(){de()}),!0}),E[e++]=scheduler.attachEvent("onBeforeEventCreated",function(e,t){return scheduler.getEvents().forEach(function(e){scheduler.deleteEvent(e.id)}),!0}),E[e++]=scheduler.attachEvent("onEventAdded",function(e,n){if(scheduler.config.scroll_hour=n.start_date.getHours(),l=e,scheduler.getEvents().forEach(function(e){"existing-briefing-meeting"!==e.type&&e.id!==n.id&&scheduler.deleteEvent(e.id,!0)}),(n=n&&z(n))&&"existing-briefing-meeting"!==n.type){var i=X();if(t||_.isEmpty(i))Q(n),setTimeout(function(){scheduler.updateView()},50);else{Z(ee(i),function(){n.start_date=y.model.event.start_date,n.end_date=y.model.event.end_date,scheduler.updateView()},function(){Q(n),K()})}}}),E[e++]=scheduler.attachEvent("onBeforeEventChanged",function(e,n,i,s){var r=moment(e.start_date).isSame(e.end_date,"day"),d=60*e.end_date.getHours()+e.end_date.getMinutes();if(!r&&0!==d)return!1;if(t=!1,scheduler.config.scroll_hour=e.start_date.getHours(),(scheduler.config.offsite_enabled||scheduler.config.booth_tour_enabled)&&q){var c=(new Date(e.end_date)-new Date(e.start_date))/60/1e3;"neither_nor"===oe(e.start_date,e.end_date,c)&&(e.end_date=scheduler.date.add(e.start_date,scheduler.config.mm_override?c:scheduler.config.maximum_duration,"minute"))}var u=scheduler.checkInMarkedTimespan(e,"dhx_time_block");if(o=s.start_date,a=s.end_date,u){var l=U(e.start_date,scheduler.config.minimum_duration);e.start_date=scheduler.date.add(e.start_date,-l,"minute"),e.end_date=scheduler.date.add(e.end_date,-l,"minute"),r=moment(e.start_date).isSame(e.end_date,"day"),u=scheduler.checkInMarkedTimespan(e,"dhx_time_block")||!r}return!u}),E[e++]=scheduler.attachEvent("onLimitViolation",function(){return!0}),E[e++]=scheduler.attachEvent("onEventChanged",function(e,t){var n=X();if(t=t&&z(t),_.isEmpty(n))G(t);else{Z(ee(n),function(){t.start_date=o,t.end_date=a,scheduler.updateView(),o=null,a=null},function(){G(t),K()})}}),E[e++]=scheduler.attachEvent("onBeforeEventDelete",function(e,t){var n=X();if(_.isEmpty(n))return ne(),!0;Z(ee(n),$.noop,function(){ne(),K(),setTimeout(function(){scheduler.deleteEvent(t.id)},500)})}),E[e++]=scheduler.attachEvent("onClearAll",function(){ne()}),E[e++]=scheduler.attachEvent("onBeforeDrag",function(e,t,n){return I=!0,!M.BriefingRequestStore.isDraftEnabled&&(q="create"===t,!0)}),E[e++]=scheduler.attachEvent("onDblClick",function(e,t){return!1}),document.body.onmouseup=function(e){I&&(I=!1,scheduler._ignore_next_click||scheduler._on_mouse_up(e||event))},E[e++]=scheduler.attachEvent("onDragEnd",function(e,t){var n,i=scheduler.getEvents()[0];if(mappingEnabled&&i){!function(e){var t=60*e.start_date.getHours()+e.start_date.getMinutes(),n=y.getValidStartTimesForMeeting()[moment(e.start_date).format("YYYY-MM-DD")],i=moment.duration(moment(e.end_date).diff(moment(e.start_date))),o=binarySearch.closest(n,t),a=n[o],s=moment(e.start_date).subtract(t,"minutes").add(a,"minutes"),r=moment(e.start_date).subtract(t,"minutes").add(a,"minutes").add(i);e.start_date=s._d,e.end_date=r._d,scheduler.updateEvent(e.id)}(i);var o=60*i.start_date.getHours()+i.start_date.getMinutes(),a=60*i.end_date.getHours()+i.end_date.getMinutes(),r=b.MeetingStore.getActivitySettings(),d=function(e,t,n,i,o){var a=t-e,s=Math.floor(a/n)*n;if(s==a)return e+s;if(s>o)return e+o;if(s<i)return e+i;var r=s+n;r>o&&(r=s);return r+e}(o,a,Number(r.minimum_timeslot),scheduler.config.meetingMinimumDuration,scheduler.config.meetingMaximumDuration);i.end_date=moment(i.end_date).add(d-a,"minutes")._d,scheduler.updateEvent(i.id),x.setTimeFields(i),n=i,scheduler.checkInMarkedTimespan(n,"dhx_time_block")&&(scheduler.deleteEvent(n.id),s.notificationModal({title:i18n.t("calendar_notify_title"),body:i18n.t("slot_unavailable"),"class":"red"}))}!function(e){var t=e.isSilent,n=e.callBackFn,i=e.mode;n=$.isFunction(n)?n:$.noop,scheduler.getEvents().forEach(function(e,o){N(e,t,n,i)})}({isSilent:!1,mode:t})}),scheduler._click.buttons["delete"]=te}}function z(e){var t=window.meetingInfo.request.meeting_break_settings||b.MeetingStore.getActivitySettings(),n=t&&t.meeting_break_duration;return e.break_duration=B(e)?n:"",e}function Z(e,t,n){var i=!1,o=i18n.t("reset_partial_particitpation_confirmation",{user_name:e.join(", ")});r.notificationModal({title:i18n.t("are_you_sure"),"class":"blue",type:"confirmation",body:o,done:function(){i=!0},dismiss:function(){i?n():t()}})}function G(e){t=!1,m.eventCreated(e),h.eventCreated(e),p.eventBarCreated(e)}function Q(e){m.eventCreated(e,t),h.eventCreated(e),p.eventBarCreated(e)}function K(){m.updateCalendar(y.model,$.noop,{slot_selection_changed:!0})}function X(){return _.filter(y.model.internal,function(e){return _.isPresent(e.partial_start_time)})}function ee(e){return _.pluck(e,"user_name")}function te(e){scheduler.deleteEvent(e)}function ne(){t=!1,m.eventCreated(null),h.eventCreated(null),p.eventBarCreated(null)}function ie(t){e=t}function oe(e,t,i){var o=i18n.t("room_type");if(n){var a=n.offsites,s=n.rooms,r=n.boothTours,d=moment(e).format("YYYY-MM-DD"),c=60*e.getHours()+e.getMinutes(),u=c+(t-e)/1e3/60,l=_.last(s[d])||1440,f=_.first(s[d])||0,m=(scheduler.config.maximum_duration,b.MeetingStore.isOffsiteSelected),h=b.MeetingStore.isBoothTourSelected;if(!m&&!h&&f<=c&&l>=u)scheduler.config.maximum_duration=scheduler.config.meetingMaximumDuration,scheduler.config.minimum_duration=scheduler.config.meetingMinimumDuration,l<c+(i||scheduler.config.maximum_duration)?o="neither_nor":(o=i18n.t("room_type"),scheduler.config.mm_override=scheduler.config.room_mm_override);else{var p=_.last(r[d])||1440,g=_.first(r[d])||0;if(h&&g<=c&&p>=u)scheduler.config.maximum_duration=scheduler.config.boothTourMaximumDuration,scheduler.config.minimum_duration=scheduler.config.boothTourMinimumDuration,p<c+(i||scheduler.config.maximum_duration)?o="neither_nor":(o=i18n.t("booth_tour_type"),scheduler.config.mm_override=scheduler.config.booth_tour_mm_override);else{var v=_.last(a[d])||1440,y=_.first(a[d])||0;m&&y<=c&&v>=u?(scheduler.config.maximum_duration=scheduler.config.offsiteMaximumDuration,scheduler.config.minimum_duration=scheduler.config.offsiteMinimumDuration,v<c+(i||scheduler.config.maximum_duration)?o="neither_nor":(o=i18n.t("offsite_type"),scheduler.config.mm_override=scheduler.config.offsite_mm_override)):h?f==p?u>p&&c<f&&(o="neither_nor"):l==g&&u>l&&c<g&&(o="neither_nor"):m&&(f==v?u>v&&c<f&&(o="neither_nor"):l==y&&u>l&&c<y&&(o="neither_nor"))}}}return scheduler.config.event_duration=scheduler.config.minimum_duration,o}function ae(t){t=t||{},t=_.assign(t,{includeFullDay:!0}),scheduler.deleteMarkedTimespan();var i=e||envDetails.event;if(i)for(var o=scheduler.date.date_part(moment(i.start_date).utc()._d),a=scheduler.date.date_part(moment(i.end_date).utc()._d),s=scheduler.getState(),r=s.min_date,c=s.max_date;r<c;)(r<o||r>a)&&g.paintInitialBlocks(r,"fullday"),r=scheduler.date.add(r,1,"day");if(!f.CalendarAvailabilityStore.isUpdateCalendarDone()&&n){var u=f.CalendarInitialAvailabilityStore.getInitialAvailability(),l=0,m=1e6;_.forOwn(u,function(e,t){var n=_.flatten(e);m=_.min(n)<m?_.min(n):m,l=_.max(n)>l?_.max(n):l,O[t]=scheduler.invertZones(e);t=moment(t).utc()._d;g.paintInitialBlocks(t,scheduler.invertZones(e))}),"undefined"==typeof briefing_uuid?(scheduler.config.first_hour=m<60?Math.floor(m/60):Math.floor(m/60)-1,scheduler.config.last_hour=l>1380?Math.ceil(l/60):Math.ceil(l/60)+1,scheduler.updateView()):null!=d?se():w.getBriefingCenterLongDay()}}function se(){d&&d[0]||(d=[0]),scheduler.config.first_hour=d[0]?Math.floor(d[0]/60):0;var e=Math.ceil(d[1]/60)+.5;e<=24&&(scheduler.config.last_hour=e),scheduler.updateView()}function re(e,t){mappingEnabled&&v.fetchVaildStartTimesForMeeting(f.CalendarAvailabilityStore.getCalendarStartDate()),i=e,de(t)}function de(e){if(P.notifyReact&&P.notifyReact(),isOngoingSales||ae({includeFullDay:!1}),i&&(i.success||200===i.status)){scheduler.deleteMarkedTimespan();i.data.availability;var t=i.data.bookable_meeting_slots,n=i.data.double_booking_slots;_.forOwn(t,function(e,t){0==_.isEmpty(e)&&g.paintDoubleBookingslots(moment(t)._d,e)});var o=0,a=1e6;_.forOwn(n,function(e,t){var n=i.data.initial_availability[t],s=_.flatten(n);a=_.min(s)<a?_.min(s):a,o=_.max(s)>o?_.max(s):o;var r=moment(t)._d;O[t]=scheduler.invertZones(e),g.paintInitialBlocks(r,scheduler.invertZones(n)),g.paintResourceBlocks(r,f.CalendarAvailabilityStore.getResourceBlocks(t))}),"undefined"==typeof briefing_uuid?(scheduler.config.first_hour=a<60?Math.floor(a/60):Math.floor(a/60)-1,scheduler.config.last_hour=o>1380?Math.ceil(o/60):Math.ceil(o/60)+1,scheduler.updateView()):null!=d?se():w.getBriefingCenterLongDay();var r=scheduler.getEvents();if(r.length>0){var c=_.last(r),u=scheduler.checkInMarkedTimespan(c,"dhx_time_block"),l=!(isOngoingSales&&"edit"==window.mode&&S.isPastDay(c.start_date));if(u&&l){if(window.isEBCEvent&&!1===window.envDetails.can_edit_time&&"function"==typeof e)return void e(!0);!function(e){var t;moment(e.start_date).format("ddd, MMM D, YYYY"),moment(e.start_date).format("hh:mm A"),moment(e.end_date).format("hh:mm A");scheduler.deleteEvent(e.id),isOngoingSales&&"new"==window.mode&&S.isPastDay(e.start_date)?(t=i18n.t("jfx_meeting_for_past_day_message"),scheduler.setCurrentView(D),S.fetchAvailablity(D)):(t=i18n.t("time_slot_unavailable_message"),t+=meetingInfo.request.conflicted_users?"Attendee(s) unavailable due to external block(s): "+meetingInfo.request.conflicted_users:"");s.notificationModal({timeout:!0,body:t,title:i18n.t("calendar_notify_title_overlapping_block"),"class":"yellow"})}(c)}}}else if(i&&i.errors){var m=i.errors;s.notificationModal({timeout:!0,"class":"red",body:m.RuntimeError.join(", "),title:m.headerMessage})}"function"==typeof e&&e()}function ce(e,t){if(window.mappingEnabled&&v.fetchVaildStartTimesForMeeting(f.CalendarAvailabilityStore.getCalendarStartDate()),"undefined"!=typeof briefing_uuid&&w.briefingDetails(),200===e.status||e.success){var i=e.data.room_initial_availabilities||{},o=e.data.offsite_initial_availabilities||{},a=e.data.booth_tour_initial_availabilities||{};n={rooms:i,offsites:o,boothTours:a,meetingTypeMinSlot:e.data.meeting_types_minimum_slot},!f.CalendarAvailabilityStore.isUpdateCalendarDone()&&ae()}else if(e.errors){var r=_.flatten(_.values(e.errors));s.notificationModal({timeout:!0,"class":"red",body:r.join(", "),title:i18n.t("default_availability_error_title")})}"function"==typeof t&&t()}function ue(e){envDetails.defaultStateOfAreYouAttending="no",h.updateAreYouAttending("no"),le(e)}function le(e){$('.attendee-item.added[data-uuid="'+e+'"]',".selected-attendee").remove(),$('.attendee-item.added[data-uuid="'+e+'"]').removeClass("hide")}return{init:function(){if(R="new"===mode,x.init({isSSEvent:!1,validationCallback:N}),Y(),window.isEBCEvent&&(!1===window.envDetails.can_edit_time&&g.makeCalendarReadOnly(),t="edit"===mode),meetingInfo.request&&meetingInfo.request.start_time){var e=new Date(moment(meetingInfo.request.start_time,"DD-MM-YYYY HH:mm"));scheduler.config.scroll_hour=e.getHours()-2}var n;"undefined"==typeof briefing_uuid&&(("new"===mode||window.envDetails.isConsecutiveMeeting&&!y.getIsMascalOrigin())&&m.eventInfo(),window.setTimeout(function(){v.getCustomForm()},800)),("new"===mode&&!window.envDetails.isConsecutiveMeeting||window.isEBCEvent)&&m.initialAvailability(),u.on("show.bs.modal",function(){u.addClass("cal-info-help-gif"),n=setTimeout(function(){u.modal("hide")},18e3)}).on("hide.bs.modal",function(e){u.removeClass("cal-info-help-gif"),n&&clearTimeout(n)}),k.init()},selectAttendee:function(e){var t=envDetails.isCSM()||envDetails.isMeetingManager()||envDetails.isJuniorMM(),n=envDetails.currentUser.uuid;if(meetingInfo.request&&!y.isTopicDirty()){var i=!1;if(("new"===mode||R)&&meetingInfo.request.users&&_.find(meetingInfo.request.users.internal,function(e){return e.uuid===n})!==undefined&&(i=!0),"new"===mode||R){if($("input[name='attend-meeting']:checked").length&&!0!==e.isResetAttendee)return;!i&&t?(h.updateAreYouAttending("no"),le(n)):void 0!==e&&(2==e.default_state_of_are_you_attending?!0!==e.isResetAttendee?(envDetails.defaultStateOfAreYouAttending="yes",h.updateAreYouAttending("yes"),h.selectInternalAttendee(envDetails.currentUser.uuid)):(ue(n),e.isResetAttendee=!1):1!=e.default_state_of_are_you_attending&&0!=e.default_state_of_are_you_attending||ue(n))}"edit"===mode&&e&&e.isResetAttendee&&(ue(n),e.isResetAttendee=!1),"undefined"!=typeof jiffle&&C.onEditAttendees(meetingInfo.request.users,i)}},setSetByDefualt:function(e){t=e},getSetByDefualt:function(){return t},showBreakInfo:B}}();t.exports=E}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/Calendar/handler.js","/app/scripts/Book/Calendar")},{"../../commons/book/Calendar/handler":93,"../../commons/calendar_helpers":95,"../../commons/granular_edit":97,"../Attendee/actions":8,"../Attendee/store":10,"../BriefingRequest/actions":11,"../BriefingRequest/store":12,"../MeetingInMaking/actions":42,"../MeetingInMaking/store":47,"../MeetingType/actions":48,"../MeetingType/store":50,"../OngoingSales/handler":53,"../OngoingSales/store":54,"./actions":13,"./store":15,_process:114,buffer:112}],15:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=e("../MeetingType/store"),h=e("../ConsecutiveMeetings/stores/mainStore"),p=window.selectedActivityUuid,g=e("../CommonStore"),v=e("../../Sfdc/commons"),y=e("../OngoingSales/store"),b=Reflux.createStore({init:function(){this.listenToMany(l)},onEventInfo:function(){var e=f.fetch({url:f.ENDPOINTS.events_info,data:{api_type:"basic_info"}});e.then(function(e){meetingInfo&&meetingInfo.request&&(e.meetingRequest=meetingInfo.request),this.trigger({type:"eventInfo",success:!0,data:e})}.bind(this)),e[e.fail?"fail":"catch"](function(e){this.trigger({success:!1,data:e.responseJSON})}.bind(this))},onInitiateNewMeeting:function(e,t){p=e,this.trigger({type:"initiateNewMeeting",data:t})}}),w=Reflux.createStore({init:function(){this.listenTo(l.updateCalendar,this.onUpdateCalendar),this.availabilities={},this.resourceBlocks={},this.dateToFetch=null,this.updateCalendarDone=!1},mixins:[g],prepareResourceBlocks:function(e){var t=e.initial_availability;_.forEach(e.double_booking_slots,function(e,n){this.resourceBlocks[n]=_.xor(scheduler.invertZones(e),scheduler.invertZones(t[n])).sort(function(e,t){return e-t})}.bind(this))},getResourceBlocks:function(e){return this.resourceBlocks[moment(e).format("YYYY-MM-DD")]},onUpdateCalendar:function(t,n){var i,o=[];var a=_.pluck(t.internal,"uuid");if("undefined"!=typeof jiffle?o=v.getAttListToSyncInJN(t):a=a.concat(_.pluck(t.external,"uuid")),a.length>=0){var s={resources:{users:a,external_users:o,rooms:[_.result(t.room,"uuid","")]}};if(meetingInfo.request&&(s.meeting_uuid=meetingInfo.request.uuid),"undefined"!=typeof briefing_uuid&&(s.briefing_uuid=briefing_uuid),s.book_meeting=!0,m.MeetingStore.isOffsiteSelected&&(s.offsite_selected="yes"),m.MeetingStore.isBoothTourSelected&&t.booth_tour_uuid&&(s.booth_tour_selected="yes",s.resources.booth_tours=[t.booth_tour_uuid],delete s.resources.rooms),s.activity_uuid=p,envDetails.topicManagementEnabled&&envDetails.topicUserMappingEnabled)if("undefined"!=typeof topic_uuid)s.topic_uuid=topic_uuid;else if("new"===mode){var r=$("#topic_management").val();"-"===r&&(r=""),s.topic_uuid=r}else s.topic_uuid=meetingInfo.request.topic_uuid;isOngoingSales&&((i=t.dateToFetch)&&(s.event_date=moment(i).format("DD-MM-YYYY")),s.time_zone=y.getTimeZoneId()),this.considerConsecutiveMeetings(s),s.location_preference=t.location_preference,s.user_participation=this.getUserEntities(t,meetingInfo.request.start_time).partialParticipation,window.envDetails.setBlockToken(s),s.new_created_users=t.newCreatedUsers;var d=f.update({url:f.ENDPOINTS.calendar_availability,data:s});d.then(function(i){this.updateCalendarDone=!0,this.availabilities=i,this.prepareResourceBlocks(i.data),l.eventCreated.trigger(t.event,e("./handler").getSetByDefualt()),this.trigger(i,n)}.bind(this)),d[d.fail?"fail":"catch"](function(e){console.log("Error",e),this.trigger(e.responseJSON)}.bind(this))}else l.initialAvailability(null,n)},considerConsecutiveMeetings:function(e){envDetails.isConsecutiveMeeting&&(e=_.merge(e,h.getRemainingMeetingsData()))},updateCalendarStartDate:function(e){this.dateToFetch=e},getCalendarStartDate:function(){return this.dateToFetch},isUpdateCalendarDone:function(){return this.updateCalendarDone}}),M=Reflux.createStore({init:function(){this.initialAvailabilities={},this.listenTo(l.initialAvailability,this.onInitialAvailability)},onInitialAvailability:function(e,t){var n=w.getCalendarStartDate(),i={activity_uuid:p};"undefined"!=typeof briefing_uuid&&(i.briefing_uuid=briefing_uuid),i.book_meeting=!0;var o=$("#topic_management").val();"-"===o&&(o=""),o&&(i.topic_uuid=o);var a=f.ENDPOINTS.availability_fetch;isOngoingSales&&(i.event_date=$("#meeting-date-picker").val()||n,i.event_date&&(i.event_date=moment(i.event_date).format("DD-MM-YYYY")),i.time_zone=y.getTimeZoneId());var s=f.fetch({url:a,data:i});s.then(function(e){this.initialAvailabilities=e,this.trigger(e,t)}.bind(this)),s[s.fail?"fail":"catch"](function(e){this.trigger(e.responseJSON,t)}.bind(this))},getInitialAvailability:function(){var e=this.initialAvailabilities.data;return e.combined_availabilities?e.combined_availabilities:this.initialAvailabilities.data.room_initial_availabilities}});t.exports={CalendarEventStore:b,CalendarAvailabilityStore:w,CalendarInitialAvailabilityStore:M}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/Calendar/store.js","/app/scripts/Book/Calendar")},{"../../Sfdc/commons":86,"../CommonStore":19,"../ConsecutiveMeetings/stores/mainStore":31,"../MeetingType/store":50,"../OngoingSales/store":54,"./actions":13,"./handler":14,_process:114,buffer:112,common_api:"common_api"}],16:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["fetchChangableMeetingTypes"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ChangeMeetingType/actions.js","/app/scripts/Book/ChangeMeetingType")},{_process:114,buffer:112}],17:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("./store"),m=function(){var e=$(".js-change-meeting-type"),t=$("#meeting-type-list"),n=$(".modal-select-activity"),i=window.ReactMessage||$(".notification-modal"),o=$(".notification-modal"),a=n.find(".select-activity-help-icon"),s={fetchChangableMeetingTypesSuccess:function(e){var o=e&&e.activities;if(o&&0===o.length)return void i.notificationModal({"class":"red",uiDetails:[{text:i18n.t("this_could_be_because")},{text:""+i18n.t("config_not_allow")},{text:i18n.t("or")},{text:i18n.t("topic_not_mapped",{topicOfInterestLabel:d()})}],body:i18n.t("no_changable_meeting_type_available_header")});var a=HandlebarsTemplates["meeting/meeting-type-list"];t.html(a({meetingTypes:o})),t.addClass("js-enabled-meeting-types"),n.modal({backdrop:!1})},fetchChangableMeetingTypesFailure:function(e){i.notificationModal({"class":"red",body:e,title:i18n.t("failure")})}};function r(){return null!==f.getDestinationActivityUuid()}function d(){var e=i18n.t("topic_label");return window.meetingInfo.request.meeting_details&&window.meetingInfo.request.meeting_details.topic_management&&(e=window.meetingInfo.request.meeting_details.topic_management.label),e}function c(e){e.stopPropagation(),l.fetchChangableMeetingTypes("fetchChangableMeetingTypesSuccess","fetchChangableMeetingTypesFailure")}function u(e){e.preventDefault(),e.stopPropagation();var t=$(e.target).closest(".activity").attr("id");void 0!==t&&(n.modal("hide"),o.notificationModal({type:"confirmation","class":"blue",title:i18n.t("change_meeting_type_header"),body:function(){var e=i18n.t("change_meeting_type_confirmation_message"),t=function(){var e="",t=(n=function(){var e=[];return e=(e=(e=e.concat(m(window.meetingInfo.request.users.internal))).concat(m(window.meetingInfo.request.users.external))).concat(h(window.meetingInfo.request.requestor_fill_survey_links))}(),_.filter(n,function(e){if("pending"===e.status||"approved"===e.status)return e}));var n;if(t.length){var i=_.groupBy(t,"status");i.approved?e=i18n.t("change_meeting_type_survey_submitted_message"):i.pending&&(e=i18n.t("change_meeting_type_survey_link_sent_message"))}return e}();""!==t&&(e+=t);return e}(),doneBtnText:i18n.t("cancel_in_notification"),cancelBtnText:i18n.t("proceed_in_notification"),show:function(){o.find(".modal-done").removeClass("btn btn-blue").addClass("btn-link cancel text-nounderline")},dismiss:function(){o.find(".modal-done").addClass("btn btn-blue").removeClass("btn-link cancel text-nounderline")},cancel:function(){var e=window.location.href.split("#")[0],n=-1===e.indexOf("?")?"?":"&";window.commons.redirectPage(e+n+"destination_activity_uuid="+t)}}))}function m(e){var t=[];return _.forEach(e,function(e){t=t.concat(h(e))}),t}function h(e){var t=[];return _.forEach(e.survey_links,function(e){t.push(e)}),t}return{init:function(){!0!==window.meetingInfo.request.can_change_meeting_type||r()||(e.removeClass("hide"),a.removeClass("hide"),f.listen(function(e){var t=s[e.type];"function"==typeof t&&t(e.data)}),e.on("click",c),n.on("click",".js-enabled-meeting-types",u),n.on("hidden.bs.modal",function(){t.removeClass("js-enabled-meeting-types"),a.popover("destroy")}),n.on("show.bs.modal",function(){var e;e=HandlebarsTemplates["book/change_meeting_type_list_tooltip_message"],a.popover({trigger:"click",content:e({topicLabel:d()}),placement:"right",html:!0,template:'<div class="item-popover popover font-11 "><div class="arrow"></div><div class="popover-content"></div></div>'})}))},isMeetingInDraftMode:r}}();t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ChangeMeetingType/handler.js","/app/scripts/Book/ChangeMeetingType")},{"./actions":16,"./store":18,_process:114,buffer:112}],18:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=Reflux.createStore({init:function(){this.listenToMany(l),this.destinationActivityUuid=$.urlParam("destination_activity_uuid")||null},onFetchChangableMeetingTypes:function(e,t){var n=f.fetch({url:f.ENDPOINTS.fetch_changable_meeting_types.replace("{meeting_uuid}",window.meetingInfo.request.uuid)});n.done(function(t){this.trigger({type:e,data:t.data})}.bind(this)),n[n.fail?"fail":"catch"](function(e){this.trigger({type:t,data:e.message})}.bind(this))},getDestinationActivityUuid:function(){return this.destinationActivityUuid}});t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ChangeMeetingType/store.js","/app/scripts/Book/ChangeMeetingType")},{"./actions":16,_process:114,buffer:112,common_api:"common_api"}],19:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../commons/date_format"),f={getUserEntities:function(e,t){var n=this,i={userPreferences:{},partialParticipation:{}};if(_.isEmpty(e.event))var o=l.convertServerDateTimeToDate(t);else o=l.jsDateToDateFormat(e.event.start_date);return _.each(e.internal,function(e){i.userPreferences[e.uuid]={meeting_host:e.meeting_host,pre_endorse:e.pre_endorse},e.partial_start_time&&e.partial_end_time&&(i.partialParticipation[e.uuid]={partial_start_time:o+" "+e.partial_start_time,partial_end_time:o+" "+e.partial_end_time})}),_.each(e.external,function(e){i.userPreferences[e.uuid]={send_ics:e.send_ics,meta_info:n.getUserMetaInfo(e)}}),i},getUserMetaInfo:function(e){return"undefined"!=typeof jiffle&&e.Id?(t={},n=window.isLeadsMeeting?"sfdc_lead_id":"sfdc_contact_id",i=e.Id,n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t):{};var t,n,i}};t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/CommonStore.js","/app/scripts/Book")},{"../commons/date_format":96,_process:114,buffer:112}],20:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["activitySelected","updateSelectedAttendees","updateSelectedRoom","updateSelectedTime","updateConsecutiveMeetings","submitConsecutiveMeetings","showMeetingTypes","validateCurrentMeetingProgress","editCurrentMeeting","discardCurrentMeeting","checkDoubleBookedStatus","setMeetingTypeSettings","setTopicSettings","getConsecutiveMeetingDetails","cancelCurrentMeeting","approveConsecutiveMeetings","cancelConsecutiveMeetings","updateCurrentMeetingStatus"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/actions.js","/app/scripts/Book/ConsecutiveMeetings")},{_process:114,buffer:112}],21:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../actions"),f=e("../stores/mainStore"),m=(e("../../MeetingInMaking/actions"),e("../../MeetingInMaking/store")),h=e("../../../commons/granular_edit"),p=e("./mainHandler"),g=e("../../commonHandlerUtility"),v=function(){var e={updateMeetingsDropdown:function(e){var t=e.data.meeting;a.find('option[value="'+t.uuid+'"]').replaceWith(M(t)),a.val(t.uuid).trigger("change.select2")},fillMeetingOptions:function(e){a.html(e.data.meetings.map(M)).val(e.data.currentSelection).trigger("change.select2")},warnDifferentDatesBeforeChange:function(e){C(i18n.t("warning_invalid_date_title"),i18n.t("warning_invalid_date_selection"),"yellow"),"function"==typeof e.callback&&e.callback()}},t=window.ReactMessage||$(".notification-modal"),n=$(".notification-modal"),i=$("#meeting-request-container"),o=$("#proceed_page"),a=$("#js-select-consecutive-meeting",o),s=$(".js-meeting-entities"),r=$("#meeting-empty-state"),d=$(".js-delete-current-meeting"),c=$("#topic_management-complement");function u(t){"function"==typeof e[t.type]&&(p.mapBoothTourToPayload(this,t),e[t.type](t))}function v(e){var t=$(this).val();p.highlightMeetingTab(t),m.setTopicDirty(!1),l.editCurrentMeeting(t)}function y(e){e.preventDefault();var t=$(this).data("uuid"),n=f.getMeeting(t);!1===_.isEmpty(n)&&n.getDisplayAttributes().is_editable?l.validateCurrentMeetingProgress({successCallBack:function(){(!c.prop("required")||null!==c.val()&&"-"!==c.val())&&h.isFormValid()&&(b(),m.setTopicDirty(!1),l.editCurrentMeeting.trigger(t),p.changeDeleteIconLabel(n),p.displayTabs(),p.highlightMeetingTab(t))},failureCallBack:C,ignoreDiffDates:!0}):"cancelled"===n.status&&C("",i18n.t("consec_meeting_edit_on_cancel_meeting"))}var b=function(){s.removeClass("hide"),r.addClass("hide")};function w(e){e.preventDefault();var t,i,o,a,s,r=!1,d=f.currMeetingInProgress.getDisplayAttributes(),c=d.mode,u=d.uuid;if("edit"!==c)return t=i18n.t("confirmation_title"),i=i18n.t(c+"_consecutive_curr_meeting_discard_msg"),o=function(){r=!0},a=$.noop,s=function(){r&&l.discardCurrentMeeting(u)},void n.notificationModal({type:"confirmation",title:t||"",body:i||"","class":"blue",done:o,cancel:a,dismiss:s});g.cancelMeeting({callback:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";l.cancelCurrentMeeting(u,e)}})}function M(e){var t=new Option(HandlebarsTemplates["book/meeting-dropdown-tmpl"](e),e.uuid);return t.setAttribute("title",e.activityName+"\n"+e.timeRange),t}function C(e,n,i,o){t.notificationModal({title:e||"",body:n||"","class":i||"red",dismiss:o||$.noop})}return{init:function(){f.listen(u),i.on("click",".js-edit-current-meeting",y).on("click",d.selector,w),o.on("change","#js-select-consecutive-meeting",v),a.select2({width:"100%",allowClear:!1,data:[],escapeMarkup:function(e){return e}})}}}();t.exports=v}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/handlers/currentMeetingHandler.js","/app/scripts/Book/ConsecutiveMeetings/handlers")},{"../../../commons/granular_edit":97,"../../MeetingInMaking/actions":42,"../../MeetingInMaking/store":47,"../../commonHandlerUtility":63,"../actions":20,"../stores/mainStore":31,"./mainHandler":23,_process:114,buffer:112}],22:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../actions"),f=e("../../../Notes/handler"),m=e("../../RequestorMailers/handler"),h=e("../stores/mainStore"),_=(e("../../MeetingInMaking/actions"),e("./mainHandler")),p=function(){var e={consecutiveMeetingDetails:function(e){t.removeClass("hide");var o=e.data.consecMeeting||{};s=o.requestor,r=m.setOptions,d=m.showRequestorEmailButton,meetingInfo.request.requestor=s,r({meetingRequestor:s}),d(),n.each(function(e,t){$(t).html(new Option(s.first_name+" "+s.last_name,s.uuid,!0)).trigger("change.select2")}),function(e){e.formRenderer.setValues(e.consecMeeting)}(e.data),a=o.activity,a=a||{},window.selectedActivityName=a.name||"",$(".js-activity-name").html(window.selectedActivityName),i.removeAttr("data-i18n").text(i18n.t("consecutive_meeting_id",{id:o.id})),_.displayTabs(),_.highlightMeetingTab(h.currMeetingInProgress.uuid),_.changeDeleteIconLabel(h.currMeetingInProgress),_.fetchMeetingTypes();var a;var s,r,d},initFetchMeetingDetails:function(){l.getConsecutiveMeetingDetails(envDetails.consecutive_meeting_uuid,$.urlParam("activeMeeting",window.location.search))}},t=(window.ReactMessage||$(".notification-modal"),$("#meeting-request-container"),$("#proceed_page"),$(".js-meeting-entities")),n=$('[id^="requestor-select"]'),i=$(".book-meeting .meeting-id");function o(t){"function"==typeof e[t.type]&&e[t.type](t)}return{init:function(){h.listen(o),meetingNotes.access_note.can_access_note&&f.init({entityUuid:meetingNotes.access_note.uuid,createUrl:meetingNotes.note_urls.create_meetintg_note_url,fetchUrl:meetingNotes.note_urls.fetch_meeting_note_url,mountPoint:"#meeting-notes"}),_.showMeetingProgress()}}}();t.exports=p}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/handlers/editHandler.js","/app/scripts/Book/ConsecutiveMeetings/handlers")},{"../../../Notes/handler":73,"../../MeetingInMaking/actions":42,"../../RequestorMailers/handler":58,"../actions":20,"../stores/mainStore":31,"./mainHandler":23,_process:114,buffer:112}],23:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../actions"),f=e("../stores/mainStore"),m=e("../../Attendee/actions"),h=e("../../Attendee/store").AttendeeStore,_=e("../../../commons/granular_edit"),p=e("../../MeetingInMaking/store"),g=e("../../../commons/book/MeetingInMaking/handler"),v=function(){var e={updateMeetingsInMaking:function(e){t=e.data,n=t.length,s.prop("disabled","edit"===mode||n>1);var t,n},onShowMeetingTypes:function(e){var t=(e.data||[]).map(function(e){return{id:e.uuid,text:e.name}}),n=f.currMeetingInProgress,i=n.isNew,o=n.meetingType,a=o.name,s=o.uuid,d=window.envDetails.currentUser.can_manage_meetings_of_associated_topics;window.envDetails.isJuniorMM()&&d&&!i&&!t.length&&a&&(t.push({text:a,id:s}),$(r.selector).hide());c.html("").select2({data:[{id:"-",text:i18n.t("please_select")}].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t)),placeholder:i18n.t("please_select_meeting_type")}),c.off("change.custom").on("change.custom",j),c.val(s).trigger("change.select2")},resetConsecutiveMeetings:function(){o.addClass("hide"),k(),E(),U()},canJmmOrAboveOverideRoomCapacity:function(e){var t=!1,i=function(e){var t={};e.data.callbackFunction?(t.title=i18n.t("override_room_capacity_while_reinviting_title"),t.body=i18n.t("override_room_capacity_while_reinviting_message")):("internal"===e.data.opts.type?t.body=i18n.t("override_room_capacity_body"):t.body=i18n.t("override_room_capacity_other_meeting_body"),t.title=i18n.t("override_room_capacity_header"));return t}(e),o=e.data.opts;n.notificationModal({type:"confirmation","class":"yellow",title:i.title,body:i.body,done:function(){t=!0},dismiss:function(){e.data.callbackFunction?t&&(f.currMeetingInProgress.isMeetingOverride=t,e.data.callbackFunction(),"internal"===o.type?h.persistOverRideRoomPopup(t):(f.externalOverRidedPopupValue=!0,f.setOverRidedFlagForMeetings(t),h.persistOverRideRoomPopup(f.currMeetingInProgress.isMeetingOverride))):t?(f.currMeetingInProgress.isMeetingOverride=t,"internal"===o.type?h.persistOverRideRoomPopup(t):(f.externalOverRidedPopupValue=!0,f.setOverRidedFlagForMeetings(t),h.persistOverRideRoomPopup(f.currMeetingInProgress.isMeetingOverride),H(o)),f.updateAttendeesForMeetings(e.data.meetings,t)):m.unselectAttendee(o.uuid,{silent:!0})}})},capacityOverflowForMeeting:function(e){var n=!e.data.callbackFunction,i=n?i18n.t("room_capacity_exceeded"):i18n.t("cannot_reinvite_as_capacity_reached_in_edit"),o=i18n.t("room_capacity_exceeded_title");if(e.data.alreadyMMOverided)var i=i18n.t("non_mm_room_capacity_exceeded"),o=i18n.t("non_mm_room_capacity_exceeded_title");t.notificationModal({body:i,title:o,"class":"red",dismiss:function(){n&&m.unselectAttendee(e.data.opts.uuid,{silent:!0})}})},reinviteAttendees:function(e){if(!e.data)return;var t=!1;n.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:i18n.t("reinvite_confirm_message"),done:function(){t=!0},dismiss:function(){t&&e.data()}})},onDiscardMeeting:function(){E(),N(f.currMeetingInProgress.uuid),B(f.currMeetingInProgress),q()},externalAttendeeAdded:H},t=window.ReactMessage||$(".notification-modal"),n=$(".notification-modal"),i=$("#meeting-request-container"),o=$(".js-meeting-entities"),a=$("#meeting-empty-state"),s=$('[id^="requestor-select"]'),r=$("#consecutive_add_meeting_btn"),d=$(".js-activity-name"),c=$("#select_meeting_type"),u=$("#req-page-topic-management"),v=$("#meetingList"),y=$("#js-instructions-display"),b=$("#meetingList"),w=$("#js_delete_label"),M=$(".js-delete-current-meeting").find("i"),C=$("#topic_management-complement");var S=function(){k(),U()};var A=function(){i.on("click",r.selector,function(){var e=!C.prop("required")||null!==C.val()&&"-"!==C.val(),t=$("#details-form");t.validate({}),t.valid()?_.isFormValid()&&e&&k():g.showMandatoryFieldsMsg()})};function x(e){var t=this.consecutiveMeetings;for(var n in t)if(t[n].activitySettings&&e.data)for(var i in e.data)e.data[i]&&t[n].uuid===e.data[i].uuid&&(t[n].activitySettings.booth_tour_label||t[n].room)&&(e.data[i].booth_tour_label=t[n].activitySettings.booth_tour_label||t[n].room.booth_tour_display_name||i18n.t("booth_tour"))}function D(t){"function"==typeof e[t.type]&&(x.call(this,t),e[t.type](t))}function k(){l.validateCurrentMeetingProgress({successCallBack:function(){f.setCurrentMeetingInProgress(),p.setTopicDirty(!1),f.onActivitySelected("-",""),T(),B(f.currMeetingInProgress)},failureCallBack:Y,ignoreDiffDates:!1})}var T=function(){c.val("-").trigger("change"),O(),E()},E=function(){var e,t=HandlebarsTemplates["consecutive_meeting/meeting-tab-list"]({list:(e=f.getConsecutiveMeetings(),e.map(function(e){return e.getDisplayAttributes()}))});v.html(t),I()};var I=function(){$(".js-edit-current-meeting").each(function(){var e=$(this),t=e.data("uuid"),n=R(t);t!==f.currMeetingInProgress.uuid&&e.popover({trigger:"hover",content:HandlebarsTemplates["consecutive_meeting/meeting-info"](n),placement:"bottom",html:!0,template:'<div class="item-popover popover consecutive-meeting-popover"><div class="arrow"></div><div class="popover-content"></div></div>'})})},R=function(e){var t=f.getMeeting(e).getDisplayAttributes(),n=t.room_name,i=t.meeting_type,o=t.internal_attendees,a=t.external_attendees,s=function(e){return e.map(function(e){return e.user_name}).join(", ")};return{roomName:n,meetingType:i,internalAttendees:s(o),externalAttendees:s(a)}};var O=function(){P(),u.addClass("hide"),y.html(""),y.find("input[type=checkbox]").prop("checked",!1)},P=function(){o.addClass("hide"),a.removeClass("hide")},q=function(){o.removeClass("hide"),a.addClass("hide")},N=function(e){b.find("li").map(function(t,n){(n=$(n))[n.data("uuid")===e?"addClass":"removeClass"]("active")})},B=function(e){var t=e.getDisplayAttributes(),n=t.mode,i=t.remove_label;w.text(i18n.t(i)),M.removeClass("jif-iris-trash").removeClass("jif-iris-not-allowed");var o="new"===n?"jif-iris-trash":"jif-iris-not-allowed";M.addClass(o)},U=function(){M.addClass("hide"),w.addClass("hide")},F=function(){M.removeClass("hide"),w.removeClass("hide")};function j(){var e=$(this),t=e.select2("data")[0].text,n=e.select2("data")[0].id;p.setTopicDirty(!1),_.clearTimeErrorField(),_.resetTimeFields(),_.hideTimeForm(),"-"===n?(O(),l.activitySelected("-","")):(F(),u.removeClass("hide"),q(),l.activitySelected(n,t),window.envDetails.meeting_host_label=undefined,window.envDetails.enable_meeting_host=undefined,window.envDetails.assign_requestors_as_meeting_host_by_default=undefined,window.envDetails.assign_mapped_user_as_meeting_host_by_default=undefined)}function H(e){var n=e.user;t.notificationModal({"class":"green",body:i18n.t("external_attendee_consecutive_meeting_add_message",{user:n.user_name})})}function Y(e,n){t.notificationModal({title:e,body:n,"class":"red"})}return{init:function(){var e;f.listen(D),e=window.selectedActivityName,d.html(e),A(),"new"===window.mode&&S()},mapBoothTourToPayload:x,fetchMeetingTypes:function(){l.showMeetingTypes(s.first().val())},displayTabs:E,highlightMeetingTab:N,showMeetingProgress:q,changeDeleteIconLabel:B}}();t.exports=v}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/handlers/mainHandler.js","/app/scripts/Book/ConsecutiveMeetings/handlers")},{"../../../commons/book/MeetingInMaking/handler":94,"../../../commons/granular_edit":97,"../../Attendee/actions":8,"../../Attendee/store":10,"../../MeetingInMaking/store":47,"../actions":20,"../stores/mainStore":31,_process:114,buffer:112}],24:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../actions"),f=e("../stores/mainStore"),m=e("../../MeetingInMaking/actions"),h=e("../../commonHandlerUtility"),p=function(){var e={consecutiveMeetingDetails:function(e){g((e.data.consecMeeting||{}).status)},consecutiveMeetingActions:function(e){o.addClass("hide"),_.forOwn(e.data,function(e,n){o.filter(".js-"+t[n]+"-meeting").removeClass("hide")})},approveSuccess:function(){g("approved"),e=i18n.t("meeting_approve_success_header"),t=i18n.t("meeting_approve_success_message"),i="green",o=v,n.notificationModal({title:e||"",body:t||"","class":i||"red",dismiss:o||$.noop});var e,t,i,o},cancelSuccess:function(){v()},reloadPage:function(){window.location.href=window.location.href+(-1!==window.location.search.indexOf("?")?"&":"?")+$.param({activeMeeting:meetingInfo.request.uuid})}},t={approve_all_url:"approve-all",cancel_all_url:"cancel-all"},n=window.ReactMessage||$(".notification-modal"),i=($(".notification-modal"),$("#proceed_page")),o=$(".js-consecutive-meeting-actions"),a=$(".js-consecutive-meeting.meeting-status"),s=$(".js-consecutive-approved-text");function r(t){"function"==typeof e[t.type]?e[t.type](t):"function"==typeof e[t.action]&&e[t.action](t)}function d(e,t){l.updateCurrentMeetingStatus(t)}function c(){l.approveConsecutiveMeetings()}function u(e,t){g(t)}function p(){h.cancelMeeting({callback:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";l.cancelConsecutiveMeetings(e)},cancelAll:!0})}function g(e){e&&(a.removeClass("pending cancelled approved").addClass(e),s.text(e),"approved"===e&&o.filter(".js-approve-all-meeting").addClass("hide"))}function v(){m.redirectPage()}return{init:function(){f.listen(r),i.on("meetingStatusChanged",d).on("consecutiveMeeitngStatusChange",u).on("click",".js-approve-all-meeting",c).on("click",".js-cancel-all-meeting",p)}}}();t.exports=p}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/handlers/meetingActionsHandler.js","/app/scripts/Book/ConsecutiveMeetings/handlers")},{"../../MeetingInMaking/actions":42,"../../commonHandlerUtility":63,"../actions":20,"../stores/mainStore":31,_process:114,buffer:112}],25:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../actions"),f=e("../stores/mainStore"),m=e("../../MeetingInMaking/actions"),h=e("./mainHandler"),p=function(){var e={onEventSaved:function(e){var n=envDetails.currentUser.first_name;t.notificationModal({title:i18n.t("meeting_notify_success_title",{user_first_name:n}),body:i18n.t("meeting_creation_success"),"class":"green",dismiss:function(){commons.setItem("eventId",e.data.meeting_id),m.redirectPage()}})},onEventSaveFailed:function(e){e=e.data;var n=_.flatten(_.values(e.errors));t.notificationModal({timeout:!0,"class":"red",body:n.join(", "),title:e.title||i18n.t("meeting_notify_failure_title")})},invalidDates:function(){e=i18n.t("invalid_date_title"),n=i18n.t("invalid_date_selection"),t.notificationModal({title:e,body:n,"class":"red",dismiss:i});var e,n,i}},t=window.ReactMessage||$(".notification-modal"),n=$("#meeting-request-container"),i=$("#proceed_page"),o=$("#requestor-select-complement",n);function a(t){"function"==typeof e[t.type]&&(h.mapBoothTourToPayload.call(this,t),e[t.type](t))}function s(e,t){var n=o.val();f.setMeetingRequestor(n),l.submitConsecutiveMeetings(t.isQuickBook,t.sendIcs)}return{init:function(){f.listen(a),n.on("meetingQuickSave",s),i.on("meetingSave",s)}}}();t.exports=p}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/handlers/meetingSubmitHandler.js","/app/scripts/Book/ConsecutiveMeetings/handlers")},{"../../MeetingInMaking/actions":42,"../actions":20,"../stores/mainStore":31,"./mainHandler":23,_process:114,buffer:112}],26:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../actions"),f=e("../stores/mainStore"),m=e("../../MeetingInMaking/actions"),h=e("../../MeetingInMaking/form_store"),p=e("../../MeetingInMaking/store"),g=e("../../MeetingType/handler"),v=e("./mainHandler"),y=e("common_api"),b=e("../../OngoingSales/store"),w=e("../../../CommentsModal"),M=e("../../../utils"),C=e("../../commonHandlerUtility"),S=function(){var e,t,n={consecutiveMeetingDetails:function(e){var t=e.data.consecMeeting||{};d.removeClass("hide"),r.removeClass("hide"),i=t.requestor,meetingInfo.request.requestor=i,c.each(function(e,t){$(t).html(new Option(i.first_name+" "+i.last_name,i.uuid,!0)).prop("disabled",!0).trigger("change.select2")}),P.setValues(t),P.afterLoad(),n=t.activity,n=n||{},window.selectedActivityName=n.name||"",$(".js-activity-name").html(window.selectedActivityName),R.removeAttr("data-i18n").text(i18n.t("meeting_id")+t.id);var n;var i},fillMeetingOptions:function(e){S.html(e.data.meetings.map(ce)).val(e.data.currentSelection).trigger("change.select2")},initiateNewMeeting:function(n){(function(e){var n={};n=e.room.uuid?"BoothTour"===e.room.type||e.room.isBoothTour?{offsite:!0,name:e.room.name,address:e.room.location||e.room.offsite_address,hideChangeRoom:!0}:{offsite:!1,display_name:e.activityName,room_name:e.room.name,capacity:e.room.capacity,hideChangeRoom:!0}:{offsite:!0,name:e.room.offsite_location_name||e.room.name,address:e.room.offsite_location_address||e.room.location||e.room.offsite_address,capacity:"",hideChangeRoom:!0};var i=HandlebarsTemplates["book/proceed_room"];$(A).html(i(n)),W=n.capacity,t=n.offsite||!1})(n.model),function(e){var t=HandlebarsTemplates["book/proceed_time"],n=moment(new Date(e.start_date)).format("hh:mm A"),i=moment(new Date(e.end_date)).format("hh:mm A"),o=new Date(e.start_date).toMediumDate(),a=(envDetails.event.time_zone_display_name||"").trim()||envDetails.event.time_zone;isOngoingSales&&(a=b.getTimeZoneToBeShownOnProceedPage());html=t({break_duration:e.break_duration,start_time:n,end_time:i,event_date:o,meeting_time_zone:a,showGotoMainOptionFromDetails:!1}),x.html(html)}(n.model.event),e=n.model,ge(n.model.status)},onBehalfActions:function(t){O=t;var n=[];if(t[envDetails.currentUser.uuid]){var i=U;meetingInfo.request.action_urls=t[envDetails.currentUser.uuid],_.forEach(t[envDetails.currentUser.uuid],function(e,t){i[t]&&n.push(i[t])})}ve(n),function(e){var t=e.internal,n=e.external;t.map(function(e,t){O[e.uuid]?ue(e,O[e.uuid]):_.forOwn(U,function(t,n){e[t]="hide"})}),n.map(function(e,t){O[e.uuid]?ue(e,O[e.uuid]):_.forOwn(U,function(t,n){e[t]="hide"})}),J=t.concat(n).length,V=_.filter(t.concat(n),{invite_status:"declined"}).length,le(t,n);var i=e.internal.length,o=e.external.length;$(".selectedInternalAttendeeCount").text(i),$(".selectedInternalAttendeeCount + span").html(i18n.t(1==i?"internal_participant":"internal_participants")),$(".selectedExternalAttendeeCount").text(o),$(".selectedExternalAttendeeCount + span").html(i18n.t(1==o?"external_participant":"external_participants"))}(e)},onBehalfOfSuccess:function(e){var t=e.onBehalfOf;ge(e.data.status),he(e.data.consecutive_meeting_status),meetingInfo.request.status=e.data.status,meetingInfo.request.action_urls=e.data.actions_urls,ve(e.data.actions),O=e.data.actions_on_behalf,_e(t,e.data.invite_status),fe()},onMeetingApproved:function(e){a.notificationModal({timeout:!0,"class":"green",body:e.message,title:i18n.t("meeting_approve_success_header"),dismiss:me}),ve(e.data.actions),he(e.data.consecutive_meeting_status),ge(e.data.status)},onMeetingAccepted:function(e){a.notificationModal({timeout:!0,"class":"green",body:e.message,title:i18n.t("meeting_accept_success_header")}),ve(e.data.actions),he(e.data.consecutive_meeting_status),ge(e.data.status);var t=envDetails.currentUser.uuid;O=e.data.actions_on_behalf,_e(t,e.data.invite_status)},onMeetingDeclined:function(e){a.notificationModal({timeout:!0,"class":"green",body:e.message,title:i18n.t("meeting_decline_success_header")}),ve(e.data.actions),he(e.data.consecutive_meeting_status),ge(e.data.status);var t=envDetails.currentUser.uuid;O=e.data.actions_on_behalf,_e(t,e.data.invite_status),fe()},onMeetingCancelled:function(e){re()},updateMeetingsDropdown:function(e){var t=e.data.meeting;S.find('option[value="'+t.uuid+'"]').replaceWith(ce(t)),S.val(t.uuid).trigger("change.select2")},redirectPage:re,onAttendeeSelected:function(e){le(e.internalAttendee,e.externalAttendee)},renderDeclineComments:function(e){M.updateDeclineComments(e.inviteOptions)}},i=$(".selected-attendee-list"),o=$("#proceed_page"),a=window.ReactMessage||$(".notification-modal"),s=$(".notification-modal"),r=$(".js-meeting-action-section"),d=$(".js-meeting-entities"),c=$('[id^="requestor-select"]'),u=$("#dynamic_form",o),S=$("#js-select-consecutive-meeting",o),A=$(".selected-room",o),x=$(".selected-time",o),D=$(".selected-internal-attendee .selected-attendee-list",o),k=$(".selected-external-attendee .selected-attendee-list",o),T=$(".bulk-action"),E=$(".go-to-main-internal"),I=$(".go-to-main-external"),R=$(".book-meeting .meeting-id"),O={},P=null,q=$(".meeting-status:not(.js-consecutive-meeting)"),N=$(".approved-text"),B="declined",U={accept_meeting_url:"Accept",decline_meeting_url:"Decline",reinvite_url:"ReInvite",endorse_url:"Endorse",cancel_meeting_url:"Cancel",approve_meeting_url:"Approve"},F=$(".js-status-text"),j=$(".cancel-meeting"),H=$(".approve-meeting"),Y=$(".accept-meeting"),L=$(".decline-meeting"),J=0,V=0,W=0,z={remove:"remove_from_all",accept:"accept_all",decline:"decline_all"},Z={remove:"remove",accept:"accept",decline:"decline"},G=y.ENDPOINTS.consecutive_list_page;function Q(e){"function"==typeof n[e.type]&&n[e.type](e)}function K(e){e.preventDefault(),e.stopPropagation();var t=$(this);s.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:i18n.t("accept_confirm_message"),done:function(){var e=t.closest(".selected-attendee-item");m.behalfOfMeetingAction(t.data("url"),e.data("uuid"),"post","onBehalfOfSuccess","onBehalfOfFailure")}})}function X(e){e.preventDefault(),e.stopPropagation();var t=$(this),n=t.closest(".selected-attendee-item"),i=t.data("url"),o=n.data("uuid"),a=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";m.behalfOfMeetingAction(i,o,"post","onBehalfOfSuccess","onBehalfOfFailure",e)},r=f.isDeclineCommentEnabled(o),d=r.enabled,c=r.showOnlyOthers?[]:M.getDeclineComments();d?w.show({comments:c,callback:a}):s.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:i18n.t("decline_confirm_message"),done:function(){return a()}})}function ee(e){e.preventDefault(),e.stopPropagation();var n=$(this),i=n.closest(".selected-attendee-item").data("uuid");!n.closest(".selected-attendee-item").hasClass("declined")||t||W>J-V?s.notificationModal({type:"confirmation","class":"green",title:i18n.t("confirmation_title"),body:i18n.t("reinvite_confirm_message"),done:function(){var e=n.data("url");m.behalfOfMeetingAction(e,i,"post","onBehalfOfSuccess")}}):a.notificationModal({"class":"red",title:i18n.t("cannot_reinvite_title"),body:i18n.t("cannot_reinvite_as_capacity_reached_in_view")})}function te(e){e.preventDefault(),e.stopPropagation();var t=meetingInfo.request.action_urls.accept_meeting_url;m.meetingAction(t,"post","onMeetingAccepted","onMeetingActionFailed")}function ne(e){e.preventDefault(),e.stopPropagation();var t=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",t=window.meetingInfo.request.action_urls.decline_meeting_url;m.meetingAction(t,"post","onMeetingDeclined","onMeetingActionFailed",null,{declined_comments:e})},n=f.isDeclineCommentEnabled().enabled,i=M.getDeclineComments();n?w.show({comments:i,callback:t}):t()}function ie(e){e.preventDefault(),e.stopPropagation();var t=meetingInfo.request.action_urls.approve_meeting_url;m.meetingAction(t,"put","onMeetingApproved","onMeetingActionFailed")}function oe(e){e.preventDefault(),e.stopPropagation();var t=window.meetingInfo.request.action_urls.cancel_meeting_url;C.cancelMeeting({callback:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";m.meetingAction(t,"put","onMeetingCancelled","onMeetingActionFailed",null,{cancel_comments:e})}})}function ae(e){e.preventDefault(),e.stopPropagation();var t=$(this).filter("#js-requestor-survey").length,n=HandlebarsTemplates["meeting/meeting-servey-item"],i=t?meetingInfo.request.requestor_fill_survey_links:meetingInfo.request.fill_survey_links;_.forEach(i.survey_links,function(e){e.response_uuid?e.action=y.ENDPOINTS.survey_responses+"/"+e.response_uuid:e.survey_response_create_url&&(e.action=e.survey_response_create_url.slice(1)),e.show_survey=!0}),$("#attendee-survey-container").html(n({surveys:i.survey_links})),$("#js-attendee-survey-mail").hide(),t&&i.show_send_mail&&$("#js-attendee-survey-mail").show(),$(".js-attendee-survey-modal").modal({show:!0,backdrop:"static"})}function se(e){if(e&&(e.data&&e.data.custom_form_fields&&(e.custom_form_fields=e.data.custom_form_fields),e.custom_form_fields)){if((P=$(u).formViewRenderer({fieldCollection:e.custom_form_fields})).init(),meetingInfo.request){var t=meetingInfo.request.custom_fields||{};t.meeting_with=meetingInfo.request.meeting_with,t.topic_management=meetingInfo.request.topic_management&&meetingInfo.request.topic_management.name,meetingInfo.request.custom_fields=t,P.setValues(meetingInfo.request)}P.afterLoad(),l.getConsecutiveMeetingDetails(envDetails.consecutive_meeting_uuid,$.urlParam("activeMeeting",window.location.search))}}function re(){var e=envDetails.urlPrefix+G;if("undefined"!=typeof isEBCEvent&&1==isEBCEvent){var t=document.getElementsByTagName("base")[0].href;if("undefined"!=typeof briefing_uuid)e=t+y.ENDPOINTS.list_briefings_agenda.replace("{QUERY_PARAMS}","?current_location_uuid="+envDetails.current_location_uuid)+"/"+briefing_uuid;else e=t+y.ENDPOINTS.event_home}if("undefined"!=typeof jiffle){var n=window.location.search,i=new RegExp("[?&]mode=([^&#]*)").exec(n),o=new RegExp("[?&]meeting=([^&#]*)").exec(n);o&&(n=n.replace(o[0],"")),i&&(n=n.replace(i[0],"")),e=y.ENDPOINTS.apex_jnmeetings+n}window.commons.redirectPage(e)}function de(e){var t=$(this).val();v.highlightMeetingTab(t),l.editCurrentMeeting(t)}function ce(e){return new Option(HandlebarsTemplates["book/meeting-dropdown-tmpl"](e),e.uuid)}function ue(e,t){var n=t||{};_.forOwn(U,function(t,i){n[i]?(e[t]="",e[i]=n[i]):e[t]="hide"})}function le(e,t){var n=f.getCurrentMeeting().status,i={remove:!1,actions:!0,remove_label:i18n.t(Z.remove),accept_label:i18n.t(Z.accept),decline_label:i18n.t(Z.decline),isConsecutive:envDetails.isConsecutiveMeeting,meetingCancelled:"cancelled"===n};if(window.envDetails.enable_meeting_host&&window.envDetails.enable_meeting_host.toBoolean()){var o={meeting_host_label:window.envDetails.meeting_host_label,enable_meeting_host:window.envDetails.enable_meeting_host};e=_.sortByOrder(e,["meeting_host"],[!1]),_.merge(i,o)}_.merge(i,{users:e});var a=HandlebarsTemplates["book/selected_attendee"],s=a(i),r=a({users:t,remove:!1,actions:!0,remove_label:i18n.t(z.remove),accept_label:i18n.t(z.accept),decline_label:i18n.t(z.decline),meetingCancelled:"cancelled"===n});D.html(s),k.html(r),fe(),E.addClass("hide"),I.addClass("hide")}function fe(){var e=$("#roomFullHolder"),t=$("#occupiedRoomHolder"),n=W-(J-V);n<=0?(e.removeClass("hide"),t.addClass("hide")):(e.addClass("hide"),t.removeClass("hide").find(".occupiedCount").text(n))}function me(){commons.redirectPage(window.location.href+(-1!==window.location.search.indexOf("?")?"&":"?")+$.param({activeMeeting:meetingInfo.request.uuid}))}function he(e){o.trigger("consecutiveMeeitngStatusChange",e)}function _e(t,n){var i=e.internal,o=e.external;i.map(function(e){e.uuid==t?pe(e,O[e.uuid],n):ue(e,O[e.uuid])}),o.map(function(e){e.uuid==t?pe(e,O[e.uuid],n):ue(e,O[e.uuid])}),J=i.concat(o).length,V=_.filter(i.concat(o),{invite_status:B}).length,le(i,o)}function pe(e,t,n){n&&(e.invite_status=n),ue(e,t)}function ge(e){q.removeClass("pending cancelled approved").addClass(e),N.text(e),F.addClass("hide").filter("."+e+"-text").removeClass("hide"),o.trigger("meetingStatusChanged",e)}function ve(e){var t;Y.addClass("hide"),L.addClass("hide"),H.addClass("hide"),j.addClass("hide"),e.map(function(e,t){e=e.toLowerCase(),$("."+e+"-meeting").removeClass("hide")}),t=$(".js-secondary-action-list").find("li:not(.hide)").length,$(".js-secondary-action-dropdown")[t?"removeClass":"addClass"]("hide")}return{init:function(){f.listen(Q),h.listen(se),p.listen(function(e){var t=e.action,i=e.payload||{},o=n[t];o&&o(i)}),o.on("change","#js-select-consecutive-meeting",de).on("click",".accept-meeting",te).on("click",".decline-meeting",ne).on("click",".approve-meeting",ie).on("click",".cancel-meeting",oe).on("click",".js-meeting-survey",ae),i.on("click",".attendee_accept",K).on("click",".attendee_decline",X).on("click",".attendee_reinvite",ee),o.removeClass("hide"),m.getCustomForm(),S.select2({data:[],width:"100%",allowClear:!1,escapeMarkup:function(e){return e}}),T.addClass("hide"),g.init()}}}();t.exports=S}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/handlers/viewHandler.js","/app/scripts/Book/ConsecutiveMeetings/handlers")},{"../../../CommentsModal":66,"../../../utils":110,"../../MeetingInMaking/actions":42,"../../MeetingInMaking/form_store":45,"../../MeetingInMaking/store":47,"../../MeetingType/handler":49,"../../OngoingSales/store":54,"../../commonHandlerUtility":63,"../actions":20,"../stores/mainStore":31,"./mainHandler":23,_process:114,buffer:112,common_api:"common_api"}],27:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.exports=function(e,t){function n(e){return _.sortByOrder(e.internal,["meeting_host"],[!1])}_.assign(this,{room:{uuid:"",name:"",activityName:"",offsite_name:"",offsite:!1,offsite_address:"",capacity:"",address:undefined,isBoothTour:!1,booth_tour_name:"",booth_tour_address:""},meetingType:{name:"",uuid:""},booth_tour_uuid:null,external:[],internal:[],activityName:"",event:null,topic:{uuid:"",name:""},attendingMeetingStatus:null,totalExistingCount:0,account:{is_changed:!0,acc:{id:"",name:""},oppty:{id:"",name:""}},isNew:!e,activitySettings:{},onBehalfActions:{},persistRequestorAsHost:!0,newCreatedUsers:[]},t),this.getDisplayAttributes=function(e){var t=this.internal.length,o=this.external.length,a=!!this.event;return this.meeting_host_label=this.meeting_host_label||window.envDetails.meeting_host_label,this.enable_meeting_host=_.isUndefined(this.enable_meeting_host)?window.envDetails.enable_meeting_host:this.enable_meeting_host,{start_time:a&&moment(this.event.start_date).format("hh:mm a")||"",end_time:a&&moment(this.event.end_date).format("hh:mm a")||"",event_date:a&&this.event.start_date.toMediumDate()||"",display:a,internal_attendees:n(this),is_editable:i(this),internal_label:i18n.t(1==t?"internal_participant":"internal_participants"),internal_count:(t<10&&0!==t?"0":"")+t,external_attendees:this.external,external_label:i18n.t(1==o?"external_participant":"external_participants"),external_count:(o<10&&0!==o?"0":"")+o,offsite:this.room.offsite&&!this.room.isBoothTour,booth_tour:this.room.isBoothTour,booth_tour_name:this.room.booth_tour_name,booth_tour_address:this.room.booth_tour_address,offsite_name:this.room.offsite_name,offsite_address:this.room.offsite_address,meeting_type:function(e){return e.room.offsite||e.room.isBoothTour||!!e.room.uuid}(this)?this.meetingType.name:"",room_name:this.room.name,remove_label:i18n.t(this.isNew?"discard":"cancel"),mode:this.isNew?"new":"edit",uuid:this.uuid,meeting_host_label:this.meeting_host_label,enable_meeting_host:this.enable_meeting_host,persistRequestorAsHost:this.persistRequestorAsHost,newCreatedUsers:this.newCreatedUsers}}.bind(this),this.getColumnAttributes=function(e){var t=!!this.event;return _.merge({activity_uuid:this.meetingType.uuid,start_time:t&&moment(this.event.start_date).format("YYYY-MM-DD HH:mm A")||null,end_time:t&&moment(this.event.end_date).format("YYYY-MM-DD HH:mm A")||null,topic_uuid:this.topic.uuid,meeting_uuid:this.isNew?"":this.uuid},this.getRoomDetails(),this.getAttendees(),this.getUserPreferences(),e)}.bind(this),this.sortInternalAttendeesByHost=n.bind(this),this.hasEnoughRoom=function(e){return this.room.offsite||this.room.isBoothTour||!this.room.uuid||function(e,t){var n=e.room.capacity>e.totalExistingCount?e.room.capacity:e.totalExistingCount,i=Number(n)-o(e.internal).length-o(e.external).length;return 1==t?i>=t:i>0}(this,e)}.bind(this),this.setActivitySettings=function(e){this.activitySettings=e}.bind(this),this.getDisplayOptions=function(){return{meetingId:this.id?"#"+this.id:"",status:this.status,uuid:this.uuid,activityName:this.activityName,timeRange:(e=this.event,e?moment(e.start_date).format("h:mm a")+" - "+moment(e.end_date).format("h:mm a"):"")};var e}.bind(this),this.getRoomDetails=function(){var e={};return this.room.isBoothTour?e.booth_tour_uuid=this.booth_tour_uuid:this.room.uuid?e.room_uuid=this.room.uuid:(e.offsite_location_name=this.room.offsite_name,e.offsite_location_address=this.room.offsite_address),e}.bind(this),this.getUserPreferences=function(){var e={};return _.each(this.internal,function(t){t.meeting_host&&(e[t.uuid]={meeting_host:!0}),e[t.uuid]=Object.assign({},e[t.uuid],{pre_endorse:t.pre_endorse})}),{user_preferences:e}}.bind(this),this.getAttendees=this.isNew?function(){return{users:_.pluck(this.internal.concat(this.external),"uuid")}}.bind(this):function(e){var e=this,t=_.partition(e.internal.concat(e.external),{invite_status:"declined"});return{users:_.pluck(t[1],"uuid"),declined_attendees:_.pluck(t[0],"uuid")}}.bind(this),this.getAttendeeDetails=function(e){return[].concat(u(this.internal),u(this.external)).find(function(t){return t.uuid===e})},this.updateExternalAttendeeStatuses=function(e){this.external.forEach(function(t){e[t.uuid]&&(t.invite_status=e[t.uuid])})}.bind(this),this.updateInviteStatus=function(e,t){(_.find(this.internal.concat(this.external),{uuid:e})||{}).invite_status=t}.bind(this),this.uuid=e||"_"+Math.random().toString(36).substr(2,9),this.active="cancelled"!==this.status,this.isMeetingOverride=!1,this.setTopicSettings=function(e){this.topicSettings=e};var i=function(e){return e.isNew||e.can_edit};function o(e){return _.filter(e,function(e){return"declined"!==e.invite_status})}}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/meetingModel.js","/app/scripts/Book/ConsecutiveMeetings")},{_process:114,buffer:112}],28:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){e("../actions");var l={onEditCurrentMeeting:function(e){if(this.canEdit(e)){var t=this.getMeetingIndex(e);-1!==t&&(this.normalizeAttendees(),this.setUpMeetingState(this.consecutiveMeetings[t],t))}},onDiscardCurrentMeeting:function(e){var t=this.getMeetingIndex(e);if(-1!==t){var n=this.findNextMeeting(t);this.removedMeetings.push({meeting:this.consecutiveMeetings.splice(t,1),index:t}),n?(this.setUpMeetingState(n,this.consecutiveMeetings.length-1),this.fillMeetingOptions(n),this.trigger({type:"onDiscardMeeting"})):this.resetConsecutiveMeetings()}},findNextMeeting:function(e){var t=null;return this.consecutiveMeetings[e+1]?t=this.consecutiveMeetings[e+1]:this.consecutiveMeetings[e-1]&&(t=this.consecutiveMeetings[e-1]),t},resetConsecutiveMeetings:function(){this.consecutiveMeetings=[],this.trigger({type:"resetConsecutiveMeetings"}),this.updateCurrentMeetingDisplay(this.consecutiveMeetings.length-1)},setUpMeetingState:function(e,t){var n=e.meetingType.uuid;this.getOnBehalfActions(e),this.setupMeetingTopic(e),this.setupMeetingType(n,!e.isNew),this.setCurrentMeeting(e),this.updateOtherModules(n,e),this.updateCurrentMeetingDisplay(t)},fillMeetingOptions:function(e){var t=this.getSortedMeetings().map(function(e){return e.getDisplayOptions()});this.trigger({type:"fillMeetingOptions",data:{meetings:t,currentSelection:e.uuid}})},updateMeetingOptions:function(e){this.trigger({type:"updateMeetingsDropdown",data:{meeting:e.getDisplayOptions()}})},onUpdateSelectedRoom:function(e){var t={};e.room?(t.room={name:e.room.name||"",uuid:e.room.uuid||"",offsite:"undefined"!=typeof e.room.address,isBoothTour:e.room.isBoothTour,booth_tour_name:e.room.name,booth_tour_address:e.room.address,offsite_name:e.room.name||"",offsite_address:e.room.address,address:e.room.address,capacity:e.room.capacity||""},t.booth_tour_uuid=e.booth_tour_uuid):t.room={name:"",uuid:"",offsite:!1,offsite_name:"",capacity:"",isBoothTour:!1},this.updateMeetingsQueue(t)},onUpdateSelectedAttendees:function(e,t,n){e.meeting_host_label=window.envDetails.meeting_host_label,e.assign_requestors_as_meeting_host_by_default=window.envDetails.assign_requestors_as_meeting_host_by_default,e.assign_mapped_user_as_meeting_host_by_default=window.envDetails.assign_mapped_user_as_meeting_host_by_default,t=t||{},this.currMeetingInProgress.isMeetingOverride=t.overRided;var i=this.validateOtherMeetingRooms(t);if(this.impactedMeetingsWhileOverride=i.overRidedMeetings,this.updateNewCreatedUsers(e),i.valid||this.checkExternalOveridePopUpValue(t)){if(!n){var o=t,a=o.type,s=o.operation,r=o.user;"external"===a&&"insert"===s&&this.trigger({type:"externalAttendeeAdded",user:r}),this.updateAttendeesForMeetings(e)}this.trigger({type:"reinviteAttendees",data:n})}else!i.valid&&t.isJmmOrAbove?this.trigger({type:"canJmmOrAboveOverideRoomCapacity",data:{meetings:e,opts:t,validateRoomObj:i,callbackFunction:n}}):i.valid||t.isJmmOrAbove?this.unselectAttendee(t.uuid,i):this.trigger({type:"capacityOverflowForMeeting",data:{meetings:e,opts:t,validateRoomObj:i,alreadyMMOverided:this.alreadyMMOverided(),callbackFunction:n}})},updateNewCreatedUsers:function(e){this.currMeetingInProgress.newCreatedUsers=e.newCreatedUsers},checkExternalOveridePopUpValue:function(e){return"external"==e.type&&this.externalOverRidedPopupValue},alreadyMMOverided:function(){return this.currMeetingInProgress.totalExistingCount>this.currMeetingInProgress.room.capacity},updateAttendeesForMeetings:function(e){this.updateAttendeesForOtherMeetings(e),this.updateMeetingsQueue({internal:e.internal,external:e.external})},onUpdateSelectedTime:function(e){this.updateMeetingsQueue({event:e.event}),this.fillMeetingOptions(e)},onCurrMeetingTopicChange:function(e,t){this.currMeetingInProgress.topic={name:t,uuid:e}},onUpdatePersistRequestorAsHost:function(){this.currMeetingInProgress.persistRequestorAsHost=!1},updateSelfAttendance:function(e){this.currMeetingInProgress.attendingMeetingStatus=e},setCurrentMeeting:function(e){this.currMeetingInProgress=e},getCurrentMeeting:function(){return this.currMeetingInProgress}};t.exports=l}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/stores/currentMeetingStore.js","/app/scripts/Book/ConsecutiveMeetings/stores")},{"../actions":20,_process:114,buffer:112}],29:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){e("../actions");var l=e("common_api"),f=e("../meetingModel"),m=e("../../MeetingInMaking/actions"),h={declinedUserStatus:"declined",onGetConsecutiveMeetingDetails:function(e,t){var n=l.replaceUrlParams(l.ENDPOINTS.consecutive_meetings_details,["{uuid}",e]),i=l.fetch({url:n});i.then(function(e){var n=e.data.consecutive_meeting;this.consecutiveMeetingActionUrls=e.data.action_urls,this.consecutiveMeetings=n.meetings.map(function(e){return new f(e.uuid,this.getModelData(e))}.bind(this)),this.consecutiveMeetings=this.getSortedMeetings(),this.setMeetingRequestor(n.requestor.uuid),this.updateMeetingsData(t),this.trigger({type:"consecutiveMeetingDetails",data:{consecMeeting:n,formRenderer:this.formComponent}}),this.trigger({type:"consecutiveMeetingActions",data:this.consecutiveMeetingActionUrls})}.bind(this)),i[i.fail?"fail":"catch"](function(){this.trigger({type:"consecutiveMeetingDetailsFailure",data:this.activities})}.bind(this))},updateMeetingsData:function(e){var t,n=0;this.consecutiveMeetings.length&&(e&&-1===(n=this.getMeetingIndex(e))&&(n=this.consecutiveMeetings.length-1),t=this.consecutiveMeetings[n],this.setUpMeetingState(t,n),this.fillMeetingOptions(t))},getOnBehalfActions:function(e){!1===e.isNew&&m.getOnBehalfActions(e)},getModelData:function(e){var t="BoothTour"===e.room.type;return{event:{start_date:this.getFormattedDate(e.start_time),end_date:this.getFormattedDate(e.end_time),break_duration:e.meeting_break.meeting_break_duration},status:e.status,booth_tour_uuid:t?e.room.uuid:null,room:{name:e.room.name,address:e.room.offsite||t?e.room.location:undefined,offsite_name:e.room.name,offsite_address:e.room.location,offsite:e.room.offsite,uuid:e.room.uuid,capacity:e.room.capacity,isBoothTour:t,booth_tour_display_name:e.booth_tour_label},meeting_with:e.meeting_with,inviteOptions:e.invite_options,cancel_options:e.cancel_options,id:e.id,internal:e.users.internal,external:e.users.external,totalExistingCount:this.filterNonDeclinedUsers(e.users.internal)+this.filterNonDeclinedUsers(e.users.external),attendingMeetingStatus:_.find(e.users.internal,{uuid:envDetails.currentUser.uuid})?"yes":"no",meetingType:{name:e.activity.name,uuid:e.activity.uuid},activityName:e.activity.name,topic:e.topic,account:{is_changed:!0,acc:{id:"",name:""},oppty:{id:"",name:""}},meeting_host_label:e.activity.meeting_host_label,assign_requestors_as_meeting_host_by_default:e.activity.assign_requestors_as_meeting_host_by_default,assign_mapped_user_as_meeting_host_by_default:e.activity.assign_mapped_user_as_meeting_host_by_default,can_edit:e.edit}},filterNonDeclinedUsers:function(e){return _.filter(e,function(e){return e.invite_status!==this.declinedUserStatus}.bind(this)).length},setupMeetingTopic:function(e){var t=e.topic.uuid;$("#topic_management").val(t),window.meetingInfo.request.topic_uuid=t,window.topic_uuid=t},setupMeetingType:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1];$("#select_meeting_type").val(e).trigger("change.select2").attr("disabled",t)},getFormattedDate:function(e){return moment(moment(e).utc().format("DD-MM-YYYY HH:mm"),"DD-MM-YYYY HH:mm").toDate()},normalizeAttendees:function(){if("edit"===mode){var e={};_.forEach(this.currMeetingInProgress.external,function(t){e[t.uuid]=t.invite_status}),_.forEach(this.getActiveMeetings(),function(t){t.updateExternalAttendeeStatuses(e)})}}};t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/stores/editStore.js","/app/scripts/Book/ConsecutiveMeetings/stores")},{"../../MeetingInMaking/actions":42,"../actions":20,"../meetingModel":27,_process:114,buffer:112,common_api:"common_api"}],30:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){e("../actions");var l={getMeetingIndex:function(e){return _.findIndex(this.consecutiveMeetings,{uuid:e})},getOrderedMeetings:function(e){var t=this.consecutiveMeetings.map(function(e){return e.getDisplayAttributes()});return t.splice(e,1).concat(t.reverse())},updateCurrentMeetingDisplay:function(e){this.trigger({type:"updateMeetingsInMaking",data:this.getOrderedMeetings(e)})},getDoubleBookedParams:function(){return this.getActiveMeetings().map(function(e){return _.pick(e.getColumnAttributes(),["start_time","end_time","users","meeting_uuid"])})},getSortedMeetings:function(){return _.sortByOrder(this.consecutiveMeetings,["active","event.start_date"],[!1,!0])},getActiveMeetings:function(){return _.filter(this.consecutiveMeetings,{active:!0})},getNonOverridedMeetings:function(){return _.filter(this.consecutiveMeetings,{active:!0,isMeetingOverride:!1})},getRemainingMeetingsData:function(){var e=[];if(!this.isOnlyMeeting()){var t=this.currMeetingInProgress.uuid;_.forEach(this.getActiveMeetings(),function(n){n.uuid!==t&&e.push({meeting_request:_.pick(n.getColumnAttributes(),["start_time","end_time","users","room_uuid","activity_uuid"]),meeting_uuid:n.isNew?null:n.uuid})})}return{meetings:JSON.stringify(e),consecutive_activity_uuid:envDetails.activityUuid,consecutive_meeting_uuid:envDetails.consecutive_meeting_uuid,consecutive_meetings:!0}}};t.exports=l}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/stores/formatMeetingsStore.js","/app/scripts/Book/ConsecutiveMeetings/stores")},{"../actions":20,_process:114,buffer:112}],31:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../actions"),f=e("../../Attendee/actions"),m=e("../../Calendar/actions"),h=e("../../MeetingType/actions"),p=e("../../MeetingInMaking/actions"),g=e("../../Expert/actions"),v=e("../../RequestorMailers/handler"),y=e("../meetingModel"),b=e("./meetingSubmitStore"),w=e("./meetingTypesStore"),M=e("./currentMeetingStore"),C=e("./formatMeetingsStore"),S=e("./editStore"),A=e("./meetingActionsStore"),x=e("./validationStore"),D=Reflux.createStore({init:function(){this.consecutiveMeetings=[],this.removedMeetings=[],this.currMeetingInProgress={},this.impactedMeetingsWhileOverride={},this.formComponent=null,this.requestor=null,this.externalOverRidedPopupValue=!1,this.activities=window.activties_attributes||[],this.consecutiveMeetingActionUrls={},envDetails.isConsecutiveMeeting&&(this.listenTo(p.setFormComponent,this.setFormComponent),this.listenTo(p.topicChange,this.onCurrMeetingTopicChange),this.listenTo(p.updateInviteeHash,this.updateCurrMeetingInviteStatus),this.listenTo(p.updateAreYouAttending,this.updateSelfAttendance),this.listenTo(p.updateCustomFields,this.initFetchMeetingDetails),this.listenTo(f.updatePersistRequestorAsHost,this.onUpdatePersistRequestorAsHost),this.listenToMany(l))},mixins:[b,w,M,C,S,A,x],setFormComponent:function(e){this.formComponent=e},setCurrentMeetingInProgress:function(){this.currMeetingInProgress={}},getConsecutiveMeetings:function(){return this.consecutiveMeetings},getMeeting:function(e){return this.consecutiveMeetings.filter(function(t){return t.uuid===e})[0]||{}},initFetchMeetingDetails:function(){this.trigger({type:"initFetchMeetingDetails"})},setMeetingRequestor:function(e){this.requestor=e},setOverRidedFlagForMeetings:function(e){var t={};_.map(this.consecutiveMeetings,function(e){t[e.uuid]=e}),_.map(this.impactedMeetingsWhileOverride,function(n){t[n.uuid].isMeetingOverride=e})},onActivitySelected:function(e,t){this.clearCurrentMeeting();var n=this.getNewMeetingInstance(e,t);this.consecutiveMeetings.push(n),this.setUpMeetingState(n,this.getMeetingIndex(n)),this.fillMeetingOptions(n)},clearCurrentMeeting:function(){var e=this.currMeetingInProgress.uuid,t=e===undefined?"":e;_.remove(this.consecutiveMeetings,function(e){return e.uuid===t})},updateOtherModules:function(e,t){var n=_.cloneDeep(t);meetingInfo.request.uuid=n.isNew?null:n.uuid,v.setOptions({meetingRequestUuid:meetingInfo.request.uuid}),"-"===e?p.updateMeetingModel(e,n):(p.initiateNewMeeting(e,n),h.initiateNewMeeting(e,n),"view"!==window.mode&&(g.initiateNewMeeting(e,n),f.initiateNewMeeting(e,n),m.initiateNewMeeting(e,n)))},onCheckDoubleBookedStatus:function(e){this.validateDates()?p.checkDoubleBookedStatus(e,{meetings:JSON.stringify(this.getDoubleBookedParams())}):this.trigger({type:"invalidDates"})},unselectAttendee:function(e,t){var n,i=i18n.t("invalid_room_other_meeting"),o=_.first(t.invalidMeetings);n=!o||o.isNew?i18n.t("invalid_room_other_meeting_msg_in_new"):i18n.t("invalid_room_other_meeting_msg_in_edit",{id:o.id}),f.unselectAttendee(e,{silent:!1,title:i,message:n})},getNewMeetingInstance:function(e,t){var n=new y;n.meetingType={name:t,uuid:e},n.activityName=t;var i=[],o=_.first(this.consecutiveMeetings);return o&&o.external instanceof Array&&(i=_.cloneDeep(o.external)),n.internal=[],n.external=i,n},updateMeetingsQueue:function(e){var t=this.getMeetingIndex(this.currMeetingInProgress.uuid);if(-1!==t){var n=_.assign(this.currMeetingInProgress,_.cloneDeep(e));this.setCurrentMeeting(n),this.consecutiveMeetings[t]=this.currMeetingInProgress,this.updateCurrentMeetingDisplay(t)}},updateCurrentMeeting:function(){var e=this.getMeetingIndex(this.currMeetingInProgress.uuid);this.updateCurrentMeetingDisplay(e)},updateAttendeesForOtherMeetings:function(e){var t=[];envDetails.currentUser.uuid;e.external instanceof Array&&(t=_.cloneDeep(e.external)),this.consecutiveMeetings.forEach(function(e){e.active&&(e.external=t)})},getIcsConfirmationMsg:function(){var e=_.collect(this.consecutiveMeetings,"status");return _.includes(e,"approved")?"send_ics_body_message":"send_ics_internal_body_message"},isDeclineCommentEnabled:function(e){var t=this.currMeetingInProgress,n=t.inviteOptions,i=t.external.map(function(e){return e.uuid}),o=!1,a=!1;return n&&("yes"===n.decline_comments_enabled&&(o=!0),window.envDetails.isConsecutiveMeeting&&n.show_options_for_external&&e&&-1!==i.indexOf(e)&&(o=a="yes"===n.show_options_for_external)),{enabled:o,showOnlyOthers:a}}});t.exports=D}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/stores/mainStore.js","/app/scripts/Book/ConsecutiveMeetings/stores")},{"../../Attendee/actions":8,"../../Calendar/actions":13,"../../Expert/actions":36,"../../MeetingInMaking/actions":42,"../../MeetingType/actions":48,"../../RequestorMailers/handler":58,"../actions":20,"../meetingModel":27,"./currentMeetingStore":28,"./editStore":29,"./formatMeetingsStore":30,"./meetingActionsStore":32,"./meetingSubmitStore":33,"./meetingTypesStore":34,"./validationStore":35,_process:114,buffer:112}],32:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){e("../actions");var l=e("../../MeetingInMaking/actions"),f=e("common_api"),m={onApproveConsecutiveMeetings:function(){l.meetingAction(this.consecutiveMeetingActionUrls.approve_all_url,"post","approveSuccess","onMeetingActionFailed",this)},onCancelConsecutiveMeetings:function(e){l.meetingAction(this.consecutiveMeetingActionUrls.cancel_all_url,"post","cancelSuccess","onMeetingActionFailed",this,{cancel_comments:e})},onCancelCurrentMeeting:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";l.meetingAction(f.ENDPOINTS.cancel_meeting.replace("{meeting_uuid}",e),"put","onMeetingCancelled","onMeetingActionFailed",null,{cancel_comments:t})},onUpdateCurrentMeetingStatus:function(e){this.currMeetingInProgress.status=e,this.updateMeetingOptions(this.currMeetingInProgress)},updateCurrMeetingInviteStatus:function(e,t){this.currMeetingInProgress.updateInviteStatus(e,t),this.normalizeAttendees(),this.updateCurrentMeetingDisplay()}};t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/stores/meetingActionsStore.js","/app/scripts/Book/ConsecutiveMeetings/stores")},{"../../MeetingInMaking/actions":42,"../actions":20,_process:114,buffer:112,common_api:"common_api"}],33:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){e("../actions");var l=e("common_api"),f={onSubmitConsecutiveMeetings:function(e,t){this.normalizeAttendees();var n="new"===mode?this.getSortedMeetings():this.getActiveMeetings(),i=l.update({url:l.ENDPOINTS.create_consecutive_meetings,data:this.getFormattedData(e,t,n)});i.then(function(e){this.trigger({type:"onEventSaved",data:e})}.bind(this)),i[i.fail?"fail":"catch"](function(e){this.trigger({type:"onEventSaveFailed",data:"undefined"==typeof jiffle?e.responseJSON:e})}.bind(this))},getFormattedData:function(e,t,n){var i=this.formComponent.getValues();i.currency_field&&"string"==typeof i.currency_field&&(i.currency_field=i.currency_field.replace(/,/g,""));var o=i.meeting_with;delete i.meeting_with;var a=n.map(function(t){var n={meeting_request:t.getColumnAttributes({custom_fields:i,requestor:this.requestor,meeting_with:o,quick_meeting:e}),current_location_uuid:envDetails.current_location_uuid,topic_uuid:t.topic.uuid,meeting_uuid:t.isNew?null:t.uuid};return n.meeting_request.requestor=this.requestor,n.meeting_request.quick_meeting=e,n}.bind(this));return{meetings:JSON.stringify(a),custom_fields:i,consecutive_activity_uuid:envDetails.activityUuid,consecutive_meeting_uuid:envDetails.consecutive_meeting_uuid,send_ics:t}}};t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/stores/meetingSubmitStore.js","/app/scripts/Book/ConsecutiveMeetings/stores")},{"../actions":20,_process:114,buffer:112,common_api:"common_api"}],34:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){e("../actions");var l=e("common_api"),f={onShowMeetingTypes:function(e){this.setMeetingRequestor(e);var t=l.fetch({url:l.ENDPOINTS.meeting_types_of_consecutive_sub_meetings,data:{requestor_uuid:e}});t.then(function(e){this.setActivities(e.data),this.trigger({type:"onShowMeetingTypes",data:e.data})}.bind(this)),t[t.fail?"fail":"catch"](function(){this.trigger({type:"onShowMeetingTypes",data:this.activities})}.bind(this))},setActivities:function(e){this.activities=e},onSetMeetingTypeSettings:function(e){"function"==typeof this.currMeetingInProgress.setActivitySettings&&this.currMeetingInProgress.setActivitySettings(e)},onSetTopicSettings:function(e){if(e){var t=e.hidden,n=e.label;this.currMeetingInProgress.setTopicSettings({enabled:!t,label:n})}else this.currMeetingInProgress.setTopicSettings({enabled:!1,label:""})}};t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/stores/meetingTypesStore.js","/app/scripts/Book/ConsecutiveMeetings/stores")},{"../actions":20,_process:114,buffer:112,common_api:"common_api"}],35:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){e("../actions");var l=e("../../MeetingInMaking/actions"),f={onValidateCurrentMeetingProgress:function(e){var t=e.successCallBack,n=e.failureCallBack,i=e.ignoreDiffDates;this.consecutiveMeetings.length?l.validateMeeting(function(){i?t():this.validateMeeitngDatesAndWarn(t)}.bind(this),n):t()},validateOtherMeetingRooms:function(e){var t=!0,n=[],i=[];if("insert"===e.operation){var o=e.isCurrUser||"external"===e.type?1:0,a=this.currMeetingInProgress.isMeetingOverride?[]:[this.currMeetingInProgress],s="external"==e.type?this.getNonOverridedMeetings():a;_.forEach(s,function(a,s){n.push(a);var r=a.hasEnoughRoom(o);t&=r,"external"==e.type&&!r&&i.push(a)})}return{valid:t,invalidMeetings:n,overRidedMeetings:i}},validateMeeitngDatesAndWarn:function(e){this.validateDates()?e():this.trigger({type:"warnDifferentDatesBeforeChange",callback:e})},validateDates:function(){var e=!0,t=new Date(this.currMeetingInProgress.event.start_date).toDateString();return _.forEach(this.getActiveMeetings(),function(n,i){e&=new Date(n.event.start_date).toDateString()===t}),e},isOnlyMeeting:function(){return 1===this.consecutiveMeetings.length},canEdit:function(e){return!(this.isOnlyMeeting()||this.currMeetingInProgress.uuid===e)}};t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ConsecutiveMeetings/stores/validationStore.js","/app/scripts/Book/ConsecutiveMeetings/stores")},{"../../MeetingInMaking/actions":42,"../actions":20,_process:114,buffer:112}],36:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["fetchExperts","setCurrentEvent","initiateNewMeeting"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/Expert/actions.js","/app/scripts/Book/Expert")},{_process:114,buffer:112}],37:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){e("./actions"),e("./store");var l=function(){var e=$(".user-search-box");function t(){}return{init:function(){e.on("keyup",_.debounce(t,369))}}}();t.exports=l}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/Expert/handler.js","/app/scripts/Book/Expert")},{"./actions":36,"./store":38,_process:114,buffer:112}],38:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=window.selectedActivityUuid,h=Reflux.createStore({init:function(){this.listenToMany(l),this.currentEvent=null},onFetchExperts:function(e){var t={search:e.searchTerm,activity_uuid:m};if(envDetails.topicManagementEnabled&&envDetails.topicUserMappingEnabled)if("undefined"!=typeof topic_uuid)t.topic_uuid=topic_uuid;else if("new"===mode){var n=$("#topic_management-complement").val();"-"===n&&(n=""),t.topic_uuid=n}else t.topic_uuid=meetingInfo.request.topic_uuid;var i=$(".room-selected").data("uuid");void 0!==i&&(t.room_uuid=i),"edit"===meetingInfo.request.mode&&(t.meeting_request=meetingInfo.request.uuid),this.setMeetingTimes(t);var o=f.fetch({url:f.ENDPOINTS.expert_users,data:t});o.then(function(t){this.trigger({type:"experts",data:t,page:t.data.current_page,callback:e.callback})}.bind(this)),o[o.fail?"fail":"catch"](function(e){this.trigger({type:"expertsFetchError",data:e.responseJSON})}.bind(this))},onSetCurrentEvent:function(e){this.currentEvent=e},setMeetingTimes:function(e){if(this.currentEvent){var t=(this.currentEvent.end_date-this.currentEvent.start_date)/1e3/60,n=60*this.currentEvent.start_date.getHours()+this.currentEvent.start_date.getMinutes(),i=n+t;e.event_date=moment(this.currentEvent.start_date).format("DD-MM-YYYY"),e.start_time=n,e.end_time=i}},onInitiateNewMeeting:function(e,t){this.currentEvent=t.event||null,m=e}});t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/Expert/store.js","/app/scripts/Book/Expert")},{"./actions":36,_process:114,buffer:112,common_api:"common_api"}],39:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["getExternalRequestDetails"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ExternalRequest/actions.js","/app/scripts/Book/ExternalRequest")},{_process:114,buffer:112}],40:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./store"),f=e("./actions"),m=function(){var e={handleExternalRequestHandler:function(e){var t=e.payload;delete t.requestors,window.meetingInfo=_.merge({},window.meetingInfo,t);var n=scheduler.date.str_to_date("%m-%d-%Y %H:%i");meetingInfo.request.start_time=n(meetingInfo.request.start_time),meetingInfo.request.end_time=n(meetingInfo.request.end_time),"function"==typeof e.callBack&&(meetingInfo.request.isExternalRequest=!0,e.callBack.call())}};function t(t){"function"==typeof e[t.action]&&e[t.action](t)}return{init:function(e,n){l.listen(t),f.getExternalRequestDetails(e,"handleExternalRequestHandler",n),function(e){(envDetails.isCSM()||envDetails.isMeetingManager())&&($(".external_request_url").removeClass("hide"),$(".external_request_url").find("a").attr("href",envDetails.urlPrefix+"/external_request_view/"+e))}(e)}}}();t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ExternalRequest/handler.js","/app/scripts/Book/ExternalRequest")},{"./actions":39,"./store":41,_process:114,buffer:112}],41:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=Reflux.createStore({init:function(){this.listenToMany(l)},onGetExternalRequestDetails:function(e,t,n){f.fetch({url:f.ENDPOINTS.get_external_req_details.replace("{uuid}",e)}).then(function(e){this.trigger({action:t,payload:e.data,callBack:n})}.bind(this))}});t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/ExternalRequest/store.js","/app/scripts/Book/ExternalRequest")},{"./actions":39,_process:114,buffer:112,common_api:"common_api"}],42:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["createMeeting","editMeeting","rescheduleMeeting","updateAreYouAttending","meetingAction","getCustomForm","showHideRequestorsDropdown","checkDoubleBookedStatus","reinviteAttendee","setOffsiteLabel","fetchSfdcCustomForm","behalfOfMeetingAction","fetchRequestors","getQuickMeetingConfig","getActivityDetails","fetchRelatedTopics","resetAttendeesAndRooms","triggerSurveyMails","prepareExtpers","fetchMeetingInfo","initiateNewMeeting","initiateNewMeetingCustomForm","changeTopicValues","setFormComponent","topicChange","redirectPage","getApprovalToSendIcs","validateMeeting","updateCustomFields","getOnBehalfActions","updateInviteeHash","getBoothTourLocationUuids","fetchVaildStartTimesForMeeting","updateSurveyType","updateIntegrationData","updateMeetingModel","fetchCustomLabels","topicChangeRefeshAttendeesAndRoomsList","checkNonRetainedResources","topicChangeRetainResources","updateMeetingPartially","fetchTopicsForEBCMeeting"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingInMaking/actions.js","/app/scripts/Book/MeetingInMaking")},{_process:114,buffer:112}],43:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../../Attachments/actions"),f={fileUploadManager:null,updateAttachmentAttributes:function(e,t){if(!envDetails.isConsecutiveMeeting&&"cancelled"!==meetingInfo.request.status&&this.isEnabled(envDetails.canShowAttachmentsField)&&this.isEnabled(e.include_briefing_docs)){var n={resourceUuid:envDetails.currentMeetingUuid,resourceType:"meeting_request",canEdit:"view"!==mode,activityUuid:window.selectedActivityUuid};Array.isArray(t)||(t=[]),l.initAttachmentsComponent($("#js-attachments-form"),e,n,t),this.listenTo(l.setJiffleFileManager,this.onSetJiffleFileManager)}},onSetJiffleFileManager:function(e){this.fileUploadManager=e},getAttachments:function(){var e={};return this.fileUploadManager&&"function"==typeof this.fileUploadManager.getAttachments&&(e=this.fileUploadManager.getAttachments()),e},isEnabled:function(e){return"yes"===e||!0===e||"true"===e}};t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingInMaking/attachment_store.js","/app/scripts/Book/MeetingInMaking")},{"../../Attachments/actions":2,_process:114,buffer:112}],44:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("common_api"),f={boothTourConfigs:{},isBoothTourConfigsFetched:!1,getBoothTourUuid:function(e){return this.boothTourConfigs[e]},onGetBoothTourLocationUuids:function(e){var t=l.fetch({url:l.ENDPOINTS.get_booth_tour_details});t.then(function(e){_.forEach(e.data.booth_tours,function(e){this.boothTourConfigs[e.activity_uuid]=e.booth_tour_uuid||""}.bind(this)),this.isBoothTourConfigsFetched=!0}.bind(this)),t[t.fail?"fail":"catch"](function(e){}.bind(this))}};t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingInMaking/booth_tour_store.js","/app/scripts/Book/MeetingInMaking")},{_process:114,buffer:112,common_api:"common_api"}],45:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("./store"),m=e("common_api"),h=e("../../Sfdc/commons"),p=window.selectedActivityUuid,g=e("../ConsecutiveMeetings/actions"),v=Reflux.createStore({init:function(){this.listenToMany(l),this.customForm=null,this.remoteEntitiesCount=0},onInitiateNewMeetingCustomForm:function(e){p=e,this.onGetCustomForm({onlyTopicField:!0})},extractTopicField:function(e){var t=_.find(e,function(e){return"topic_management"===e.field_name});g.setTopicSettings(t),l.changeTopicValues(t,p)},onGetCustomForm:function(e){e=e||{};var t=m.ENDPOINTS.fetch_form,n=m.fetch({url:t,data:{form_type:"meeting_request_form",activity_uuid:p}});n.then(function(t){var n=this;if(e.onlyTopicField)this.extractTopicField(t.data.custom_form_fields);else if(null===this.customForm&&t.data&&t.data.custom_form_fields)if(this.customForm=t.data,l.updateCustomFields(t.data),"edit"===meetingInfo.request.mode&&"undefined"!=typeof jiffle)this.onFetchSfdcCustomForm(!0);else{if(!envDetails.topicManagementEnabled){var i=_.find(this.customForm.custom_form_fields,function(e){return"topic_management"==e.field_name});i&&(i.hidden=!0)}_.forEach(this.customForm.custom_form_fields,function(e){"string"==typeof e.entity&&""!==e.entity.trim()&&(n.remoteEntityFields[e.entity]=e.field_name,n.remoteEntitiesCount++)}),0!=this.remoteEntitiesCount?this.trigger(this.customForm,this.remoteEntityFields):this.trigger(t)}}.bind(this)),n[n.fail?"fail":"catch"](function(e){this.trigger({type:"CustomFormError",data:e.responseJSON})}.bind(this))},remoteEntityFields:{},remoteEntityEndPoints:{topic_of_interest:m.ENDPOINTS.fetch_topics},onFetchRelatedTopics:function(e){var t=this;(e=e||{}).per_page=1e3,e.meeting_uuid=meetingInfo.request&&meetingInfo.request.uuid,e.make_topic_editable=!(!meetingInfo.request||!meetingInfo.request.uuid);var n=m.fetch({url:this.remoteEntityEndPoints.topic_of_interest,data:e});n.then(function(e){t.trigger({type:"getTopicListSuccess",payload:e})}),n[n.fail?"fail":"catch"](function(e){t.trigger({type:"getTopicListFail",payload:e})})},onFetchTopicsForEBCMeeting:function(){this.trigger({type:"fetchTopics"})},onFetchSfdcCustomForm:function(e){var t=f.model.account,n={mapped_fields:{},account_id:t.acc.id,opportunity_id:t.oppty.id,mode:meetingInfo.request.mode};"new"===meetingInfo.request.mode?n.lead_id=h.getValidLeadId(f.model):"edit"===meetingInfo.request.mode&&(n.account_id=meetingInfo.request.custom_fields.meeting_account_id,n.opportunity_id=meetingInfo.request.custom_fields.meeting_opportunity_id,n.lead_id=meetingInfo.request.custom_fields.meeting_lead_id),_.forEach(this.customForm.custom_form_fields,function(e){if(e.integration_field&&e.integration_field.uuid){var t={value:meetingInfo.request.custom_fields[e.field_name]?meetingInfo.request.custom_fields[e.field_name]:"",prefill:"",integration_field_uuid:e.integration_field.uuid};n.mapped_fields[e.field_name]=t}});var i=m.fetch({url:m.ENDPOINTS.fetch_sf_custom_fields,data:n});i.then(function(t){var n=meetingInfo.request.meeting_with;"new"===meetingInfo.request.mode&&(n=f.model.account.acc.name,window.isLeadsMeeting&&(n=$("#req_page_meeting_with").val()));var i={sfdc_meeting_info:{custom_fields:{},meeting_with:n,second_page_active:e},custom_form_fields:_.cloneDeep(this.customForm.custom_form_fields)},o=_.cloneDeep(meetingInfo.request.custom_fields);_.forEach(i.custom_form_fields,function(e){var n=t.mapped_fields[e.field_name];if(n){var o=n.value;"textfield"===e.type&&(o=""===n.value?e.values:n.value),e.values=n.prefill,i.sfdc_meeting_info.custom_fields[e.field_name]=o}}),i.sfdc_meeting_info.custom_fields=_.assign(o,i.sfdc_meeting_info.custom_fields),this.trigger(i)}.bind(this)),i[i.fail?"fail":"catch"](function(e){console.log(e)}.bind(this))}});t.exports=v}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingInMaking/form_store.js","/app/scripts/Book/MeetingInMaking")},{"../../Sfdc/commons":86,"../ConsecutiveMeetings/actions":20,"./actions":42,"./store":47,_process:114,buffer:112,common_api:"common_api"}],46:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},f=e("./actions"),m=e("../../history/handler"),h=e("../../Reviews/handler"),p=e("../../Notes/handler"),g=e("../Attendee/handler"),v=e("./store"),y=e("./form_store"),b=e("../Attendee/actions"),w=e("common_api"),M=e("../Attendee/store").AttendeeStore,C=e("../MeetingType/store").MeetingStore,S=e("../BriefingRequest/store").BriefingRequestStore,A=e("../MeetingType/store").MeetingStore,x=e("../Expert/actions"),D=e("../ConsecutiveMeetings/actions"),k=e("../ConsecutiveMeetings/handlers/mainHandler"),T=e("../ConsecutiveMeetings/stores/mainStore"),E=e("../../commons/date_format"),I=e("../ChangeMeetingType/handler"),R=e("../Calendar/handler"),O=window.selectedActivityUuid,P=e("../commonHandlerUtility"),q=e("../../commons/book/MeetingInMaking/handler"),N=e("../../commons/granular_edit"),B=e("../OngoingSales/store"),U=e("../../CommentsModal"),F=e("../Calendar/actions"),j=e("../MeetingType/actions"),H=e("../../utils"),Y=window,L=Y.envDetails,J=Y.meetingInfo,V=Y.isEBCEvent,W=Y.mode,z=Y.mappingEnabled,Z=Y.isOngoingSales,G=Y.commons,Q=Y.location,K=function(){var e,t,n=$(".book-meeting .meeting-id"),i=$(".section-meeting-making"),o=$(".selected-room",i),a=$(".selected-time",i),s=$("#proceed_page"),r=$("#meeting-request-container"),d=$(".selected-room",s),c=$(".selected-time",s),u=$("#submitButton"),Y=$(".selected-external-attendee .selected-attendee-list",s),K=$(".selected-external-attendee .selected-attendee-list",i),X=$(".selected-internal-attendee .selected-attendee-list",s),ee=$(".selected-internal-attendee .selected-attendee-list",i),te=$("#dynamic_form",s),ne=$("#proceed-btn"),ie=$(".meeting-status:not(.js-consecutive-meeting)"),oe=$(".approved-text"),ae=null,se=$(".accept-meeting"),re=$(".conflict-meeting"),de=$(".participation-meeting"),ce=$(".decline-meeting"),ue=$(".cancel-meeting"),le=$(".approve-meeting"),fe=$(".js-meeting-survey"),me=window.ReactMessage||$(".notification-modal"),he=$(".notification-modal"),_e=$(".meeting-req-details",r),pe=$("#req_page_meeting_with",r),ge=$("li#meetingWithInfo"),ve=$("#req-page-meeting-form",r),ye=$("#req-page-topic-management",r),be=$("#meeting-type-header",r),we=$("#req-page-briefing-meeting-with-form",r),Me=$("#js-select-topic-holder",r),Ce=$("#meetingWithField",r),Se=!1,Ae=0,xe=0,De=$("#cancel-btn"),ke=$(".briefing-id-btn"),Te=O,Ee=!0,Ie="",Re="",$e="internal",Oe="external",Pe=$(".js-status-text"),qe=$("#topic-description"),Ne=$('[id^="requestor-select"]'),Be={accept_meeting_url:"Accept",decline_meeting_url:"Decline",reinvite_url:"ReInvite",endorse_url:"Endorse",approve_meeting_url:"approve",cancel_meeting_url:"cancel",approve_all_meeting_url:"approve-all",cancel_all_meeting_url:"cancel-all"},Ue={remove:"remove",accept:"accept",decline:"decline"},Fe={remove:"remove",accept:"accept",decline:"decline"},je={notes:!1,history:!1},He={"#targetId_meeting-history-tab":nt,"#targetId_notes-list":it},Ye=null,Le={},Je=null,Ve={checkDoubleBookedStatus:function(e){f.checkDoubleBookedStatus(e)},submitMeetingHandler:function(e,t){ft(function(){var n=ae.getValues();n.currency_field&&(n.currency_field=n.currency_field.replace(/,/g,""));var i=Ne.first().val();if(J.request&&"edit"===J.request.mode){var o=S.briefingRequestor;o&&L.briefingAndMeetingRequestorSame&&(i=o.uuid),st()?f.updateMeetingPartially(n,i,t):f.rescheduleMeeting(n,i,t)}else f.createMeeting(n,i,Ze&&e)})}},We={onRoomChosen:gn,onResetRoomList:gn,onAttendeeSelected:function(t){var n,i,o=t.internalAttendee.length,a=t.externalAttendee.length,s=!1,r=!1,d=v.showPartialParticipation();Ae=t.totalCount,vn(),q.setAttendeeCount({internalCount:o,externalCount:a}),$(".selectedInternalAttendeeCount").text((o<10&&0!==o?"0":"")+o),$(".selectedInternalAttendeeCount + span").html(i18n.t(1===o?"internal_participant":"internal_participants")),$(".selectedExternalAttendeeCount").text((a<10&&0!==a?"0":"")+a),$(".selectedExternalAttendeeCount + span").html(i18n.t(1===a?"external_participant":"external_participants")),s=mt(t.validInternalAttendees,"internal"),r=mt(t.validExternalAttendees,"external"),n=t.internalAttendee,i=t.externalAttendee,n.map(function(t,n){e[t.uuid]?yn(t,e[t.uuid]):_.forOwn(Be,function(e,n){t[e]="hide"}),t.edit_partial_participation=d&&(t.edit_partial_participation||!1),t.view_partial_participation=d&&(t.view_partial_participation||!1)}),i.map(function(t,n){e[t.uuid]?yn(t,e[t.uuid]):_.forOwn(Be,function(e,n){t[e]="hide"})}),wn(n,i,s,r),t.internalAttendee.length>0||t.externalAttendee.length>0?($("#attendee-label").removeClass("hide"),""===$("#room-label").text()&&$("#attendee-label").html(i18n.t("attendees"))):($("#attendee-label").addClass("hide"),""===$("#room-label").text()&&($("#attendee-label").closest(".header-right").addClass("hide"),$("#attendee-label").html(i18n.t("attendees_and"))));t.internalAttendee.length>0&&Ee?$(".go-to-main, .go-to-main-internal",".selected-internal-attendee").removeClass("hide"):$(".go-to-main, .go-to-main-internal",".selected-internal-attendee").addClass("hide");t.externalAttendee.length>0&&Ee?$(".go-to-main, .go-to-main-external",".selected-external-attendee").removeClass("hide"):$(".go-to-main, .go-to-main-external",".selected-external-attendee").addClass("hide");$(".go-to-main-internal",".selected-internal-attendee").data("i18n","UPDATE").text("UPDATE"),$(".go-to-main-external",".selected-external-attendee").data("i18n","UPDATE").text("UPDATE")},onEventCreated:Cn,onMeetingCancelled:function(e){L.isConsecutiveMeeting?$t():xn()},onMeetingApproved:function(e){me.notificationModal({timeout:!0,"class":"green",body:i18n.t("meeting_approve_success_message"),title:i18n.t("meeting_approve_success_header"),dismiss:Ot}),Qt(e.data.actions),qt(e.data.status),Pt(e.data.consecutive_meeting_status),J.request.status=e.data.status},onMeetingAccepted:function(t){me.notificationModal({timeout:!0,"class":"green",body:t.message,title:i18n.t("meeting_accept_success_header")}),Qt(t.data.actions),qt(t.data.status),J.request.status=t.data.status,Pt(t.data.consecutive_meeting_status);var n=L.currentUser.uuid;M.updateInviteeHash(n,t.data.invite_status),e=t.data.actions_on_behalf,Mt(n,t.data.invite_status,t.data)},onMeetingDeclined:function(t){me.notificationModal({timeout:!0,"class":"green",body:t.message,title:i18n.t("meeting_decline_success_header")}),Qt(t.data.actions),qt(t.data.status),J.request.status=t.data.status,Pt(t.data.consecutive_meeting_status);var n=L.currentUser.uuid;M.updateInviteeHash(n,t.data.invite_status),e=t.data.actions_on_behalf,Mt(n,t.data.invite_status,t.data),$('.attendee-item.added[data-uuid="'+L.currentUser.uuid+'"]').remove(),$('.attendee-item[data-uuid="'+L.currentUser.uuid+'"]',"#internal-attendees-tab").removeClass("hide"),vn(),function(e){if("StaffScheduling"!==L.eventType||!e.max_capacity)return;$("#available_capacity").html(i18n.t("available_slots_info",{availableSlots:e.available_slots,maxCapacity:e.max_capacity}))}(t.data),v.callShowAvailableRooms()},onMeetingActionFailed:function(e){t=e.RuntimeError||e.details.RuntimeError,me.notificationModal({"class":"red",body:t.join(", "),title:i18n.t("failure")});var t},onEventSaved:function(e){var t=L.currentUser.first_name;if("undefined"==typeof jiffle||_.isEmpty($.urlParam("accid"))&&_.isEmpty($.urlParam("oppid"))&&_.isEmpty($.urlParam("lead_ids")))me.notificationModal({title:i18n.t("meeting_notify_success_title",{user_first_name:t}),body:i18n.t("meeting_creation_success"),dismiss:function(){if(G.setItem("eventId",e.data.meeting_id),e.data.hooks){var t=_.find(e.data.hooks,function(e){return"meeting_submit_hook"===(e=JSON.parse(e)).name});(t=JSON.parse(t))&&"redirect"===t.action&&t.url&&!function(e,t){var n=e.open_new_tab?"_blank":"_self",i=e.url?e.url:"";if(i){var o=-1===i.indexOf("?")?"?":"&";return i=i+o+e.hook_parameters,e.open_new_tab?(G.openPageInNewTab(i,n),!0):(G.openPageInNewTab(i,n),!1)}}(t,e.data)?$.noop():xn()}else xn()}});else{var n=i18n.t("preserve_acc_opp_context_confirmation");_.isEmpty($.urlParam("lead_ids"))||(n=i18n.t("preserve_leads_context_confirmation")),he.notificationModal({type:"confirmation",title:i18n.t("meeting_notify_success_title",{user_first_name:t}),body:i18n.t("meeting_creation_success")+"<br>"+n,hideCloseBtn:!0,done:function(){Ge=!0,G.setItem("eventId",e.data.meeting_id),xn()},cancel:function(){Ge=!1,G.setItem("eventId",e.data.meeting_id),xn()}})}},onEventSaveFailed:function(e){var t=[];console.log(e),e=e.responseJSON||e,_.forEach(e.errors,function(e){t.push(e)}),me.notificationModal({timeout:!0,"class":"red",body:t.join(", "),title:e.title||i18n.t("meeting_notify_failure_title")})},onEventRescheduled:function(e){e.data.rescheduled_meeting_with_declined_attendees?he.notificationModal({type:"confirmation",title:i18n.t("reInvite_declined_attendees_after_reschedule_header"),body:i18n.t("reInvite_declined_attendees_after_reschedule"),hideCloseBtn:!0,done:function(){G.setItem("eventId",e.data.meeting_id),Q.reload()},cancel:function(){G.setItem("eventId",e.data.meeting_id),xn()}}):me.notificationModal({title:i18n.t("meeting_notify_success_title",{user_first_name:L.currentUser.first_name}),body:i18n.t("meeting_updation_success"),dismiss:function(){G.setItem("eventId",e.data.meeting_id),xn()}})},showHideRequestorsDropdown:Kt,onCheckDoubleBookedStatusSuccess:function(e){var t=e.callbackFn;if(e&&(200===e.status||e.success))if((e=e.data)&&e.double_booked_resources instanceof Array)if(0===e.double_booked_resources.length&&_.isEmpty(e.conflicted_data))t();else{var n=L.currentUser,i=e.double_booked_resources.map(function(e){var t;if(e===n.uuid)return n.first_name+" "+n.last_name;var i=T.consecutiveMeetings;return(t=window.envDetails.isConsecutiveMeeting?function(e,t){var n={};return e.forEach(function(e){var i=e.getAttendeeDetails(t);i&&(n=i)}),n}(i,e):M.getAttendeeDetails(e))?t.first_name+" "+t.last_name:""}),o=function(e){return _.map(e,function(e,t){var n="";return _.each(e.conflicted_time,function(e){n+=e.join(" - "),n+=" "}),{name:e.name,timeFormat:n}})}(e.conflicted_data),a=!1,s=e.double_booked_resources.length,r=_.size(e.conflicted_data),d=function(e,t){return L.isConsecutiveMeeting?i18n.t("double_booked_body_for_cm",{attendee:pluralize("attendee",t),is:pluralize("is",t)}):i18n.t("double_booked_body",{attendee:pluralize("attendee",t),start_time:E.convertDateTimeToTime(e.start_time),end_time:E.convertDateTimeToTime(e.end_time)})}(e,s),c=i18n.t("waitlist_attendee_body",{attendee:pluralize("attendee",r),is:pluralize("is",r)}),u={doubleBookAttendees:i,showDoubleBook:Boolean(s),doubleBookMessage:d,softBlockAttendees:o,showSoftBlock:_.isPresent(e.conflicted_data),waitlistMessage:c,isConsecutive:L.isConsecutiveMeeting};he.notificationModal({"class":"yellow double-booking-modal",type:"confirmation",body:HandlebarsTemplates["book/double_booked_message"](u),title:i18n.t("double_booked_title"),done:function(){a=!0},dismiss:function(){a&&t()},doneBtnText:i18n.t("proceed_in_notification"),cancelBtnText:i18n.t("cancel_in_notification")})}else t();else if(e&&e.errors){var l=_.flatten(_.values(e.errors));me.notificationModal({timeout:!0,"class":"red",body:l.join(", "),title:i18n.t("double_book_error_title")})}},onCheckDoubleBookedStatusFailed:function(e){e.callbackFn.call()},onBehalfOfSuccess:function(t){var n=t.onBehalfOf;qt(t.data.status),J.request.status=t.data.status,Qt(t.data.actions),J.request.action_urls=t.data.actions_urls,Pt(t.data.consecutive_meeting_status),M.updateInviteeHash(n,t.data.invite_status),f.updateInviteeHash(n,t.data.invite_status),e=t.data.actions_on_behalf,Mt(n,t.data.invite_status,t.data),me.notificationModal({timeout:!0,"class":"green",title:i18n.t("success"),body:t.message}),vn(),v.callShowAvailableRooms()},onBehalfOfFailure:function(e){var t=[];_.forEach(e.responseJSON.errors,function(e){t.push(e)});var n=i18n.t("failure");"re_invite"===e.responseJSON.action&&(n=e.responseJSON.error_header);setTimeout(function(){me.notificationModal({timeout:!0,"class":"red",body:t.join(", "),title:n})},500)},onGetQuickMeetingConfig:function(e){t=e.configurations.quick_meeting_enabled,(Ze="true"===t||"yes"===t||!0===t)?$("#quick_submit_btn").removeClass("hide").parent().find(".or").removeClass("hide"):ne.removeClass("btn-white").addClass("btn-blue");var t},onGetActivityDetails:function(e){be.text(e.activity.name)},surveyMailsTriggered:function(e){$(".js-attendee-survey-modal").modal("hide"),t=e.survey_uuid,n="internal"===Ie?v.getInternalAttendees():v.getExternalAttendees(),i=_.find(n,{uuid:Re}),o={requestor:J.request.requestor_fill_survey_links,creator:J.request.fill_survey_links,attendee:i},_.each(t,function(e){var t=_.find(o[v.survey_type].survey_links,{uuid:e.uuid});t&&_.merge(t,e)}),function(e){e.show_message&&me.notificationModal({"class":"green",body:e.message})}(e);var t,n,i,o},onChangeTopicValues:function(e){(e=_.isEmpty(e)?{hidden:!0}:e).hidden?ye.addClass("hide"):ye.removeClass("hide"),ye.removeClass("has-error"),ye.find(".error-class").remove();var t=e.label?e.label:"";ye.find("label").text(t)[e.required?"addClass":"removeClass"]("required"),ye.find("label").attr("data-original-title",t),ye.find("#topic_management-complement").prop("required",!e.hidden&&e.required),ye.find("span.help-block").text(e.helpText);var n=$("#topic-details");e.required&&n.validate({rules:{topic_management:{required:!0,notSelect2Empty:!0}}});f.fetchRelatedTopics({activity_uuids:O})},initiateNewMeeting:function(e){O=e.activity,Je=e.model.topic,$("#topic_management").val(Je?Je.uuid:"");var t=pe.val();$("#topic-details").validate().resetForm(),pe.val(t||e.model.meeting_with||"").trigger("change"),qt(e.model.status),Ee=e.model.isNew||e.model.can_edit},redirectPage:xn,getApprovalToSendIcs:function(e){dt(e.callbackFn)},onBehalfActions:function(t){e=t;var n=[];if(t[L.currentUser.uuid]){var i=_.cloneDeep(Be);J.request.action_urls=t[L.currentUser.uuid],_.forEach(t[L.currentUser.uuid],function(e,t){i[t]&&n.push(i[t])})}Qt(n)},autoAddMeetingHost:en,fetchCustomLabelsSuccess:function(e){var t=e.custom_labels.booth_tour_custom_label;$(".booth-tour-icon.js_tooltip").attr("title",t)},checkNonRetainedResourcesSuccess:function(e){var t=e.users,n=e.rooms;Vt({newTopic:e.topic,users:t,rooms:n})},getTopicListSuccess:function(e){var t=[],n=Yt();e&&e.data&&e.data.topics instanceof Array&&(t=e.data.topics.map(function(e){return{id:e.uuid,name:e.name,text:e.name,description:e.description,disabled:e.disable_in_meeting}}));t.unshift({id:"-",text:i18n.t("please_select")}),n.html("").select2({allowClear:!0,required:n.prop("required"),placeholder:i18n.t("please_select_topic"),data:t,templateResult:Ht,dropdownCssClass:"iris-select2-dropdown"}).on("select2:selecting",jt).on("select2:unselecting select2:open",function(){var e=n.val();null!==e&&Ye!==e&&(Ye=e,Le=qe.data("topicDetails"))}),qe.popover({trigger:"hover",content:"content",placement:"bottom",html:!0,template:'<div class="item-popover popover topic-desc-popover"><div class="arrow"></div><div class="popover-content"></div></div>'}),qe.addClass("hide"),qe.on("show.bs.popover",Ft),Je&&Lt(Je)&&function(e,t){var n=Yt();n.val(e.uuid),n.trigger("change.select2"),qe.removeClass("hide");var i=t.filter(function(t){return t.uuid===e.uuid});v.setModelData("topicName",i[0].name),qe.data("topicDetails",i[0])}(Je,e&&e.data&&e.data.topics);n.on("change",Jt)},getTopicListFail:function(e){var t=[];e=e.responseJSON||e,_.forEach(e.errors,function(e){t.push(e)}),me.notificationModal({timeout:!0,"class":"red",body:t.join(", "),title:e.title||i18n.t("topic_fetch_failure")})},fetchTopics:Xe,renderDeclineComments:function(e){H.updateDeclineComments(e.inviteOptions)}},ze=w.ENDPOINTS.meeting_list,Ze=!1,Ge=!1;function Qe(){return L.isCSM()||L.isMeetingManager()}function Ke(e){var t=$(e.currentTarget),n=t.is(":checked"),i=t.data("type");if(i){var o=t.closest(".conference-container").find(".form-control"),a={field_id:t.data("field_id"),checked:n};n&&"edit"===W&&o.val()?o.removeClass("hide"):o.addClass("hide"),f.updateIntegrationData({type:i,payload:a})}}function Xe(){Je=J.request.topic_management||null,f.fetchRelatedTopics({activity_uuids:O})}function et(){f.fetchCustomLabels()}function tt(){return unescape(unescape($.urlParam("meeting_with")))}function nt(){J.request.can_access_history&&!je.history&&(m.init({fetchUrl:w.ENDPOINTS.meeting_history.replace("{uuid}",J.request.uuid),mountPoint:"#meeting-history"}),je.history=!0)}function it(){J.request.can_access_note&&!je.notes&&(p.init({entityUuid:J.request.uuid,createUrl:J.request.note_urls.create_meetintg_note_url,fetchUrl:J.request.note_urls.fetch_meeting_note_url,mountPoint:"#meeting-notes"}),je.notes=!0)}function ot(){if(ct()){var e=$("#meetingWithInfo");ve.find("#meeting-req-help-text").attr("style",""),e.find(".jif-dropright-filled").removeClass("hide"),e.find(".jif-dropdown-filled").addClass("hide"),$(".meeting-with-overlay").slideUp()}}function at(){if(ct()){var e=$(this);e.find(".jif-dropright-filled").toggleClass("hide"),e.find(".jif-dropdown-filled").toggleClass("hide"),$(".meeting-with-overlay").slideToggle(800)}}function st(){return"edit"===window.mode&&!v.getOnDemandFirstPageLoaded()&&!window.isEBCEvent&&!window.envDetails.isConsecutiveMeeting}function rt(e){e.preventDefault(),e.stopPropagation();var t=J.request&&"edit"===J.request.mode,n=L.isJuniorMM()||L.isMeetingManager()||L.isCSM(),i=!0===st()?{error:!1}:v.isValidMeeting();i.error?me.notificationModal({"class":"red",timeout:!0,body:i.message,title:i.title||i18n.t("meeting_validation_notify_title")}):t&&n?dt(function(e){Ve.submitMeetingHandler(!1,e)}):Ve.submitMeetingHandler(!1)}function dt(e){var t,n,i=!1,o="pending"===J.request.status?i18n.t("send_ics_internal_body_message"):i18n.t("send_ics_body_message");o=o.concat((t=Ne.first().val(),n=S.briefingRequestor||{},L.briefingAndMeetingRequestorSame&&t!==n.uuid?"<br/><br/>"+i18n.t("briefing_meeting_requestor_msg"):"")),he.notificationModal({"class":"blue",type:"confirmation",body:o,title:i18n.t("meeting_updated"),done:function(){i=!0},dismiss:function(){e(i)}})}function ct(){var e=$("form#details-form"),t=Yt(),n=t.val();return"-"===n&&(n=""),t.val(n),e.validate({}),e.valid()||ut("slideDown")}function ut(e){$(".meeting-with-overlay")[e]();var t=$("#meetingWithInfo");return t.find(".jif-dropright-filled").addClass("hide"),t.find(".jif-dropdown-filled").removeClass("hide"),!1}function lt(e,t){ft(function(){var n={sendIcs:t,isQuickBook:e};e?r.trigger("meetingQuickSave",n):s.trigger("meetingSave",n)})}function ft(e){e="function"==typeof e?e:$.noop;var t=$("#customer_form"),n=t.validate({ignore:Ze?".form-element-ignorable:not([name=meeting_with])":""}),i=$("form.meeting-summary");i.validate(),ae.isFormValid(t)&&i.valid()?($("#cover").fadeIn(),e()):n.focusInvalid()}function mt(e,t){var n=!1,i="internal"===t?M.isInternalAttendeesHidden():M.isExternalAttendeesHidden();if(v.isAttendeeRequired(t+"_attendee_presence","relax_"+t+"_attendee_presence_for_mm")&&!1===i)if(n=e.length<=1){var o=e[0]||{};$("#"+t+'-attendees-tab .selected-attendee .unselect-attendee[data-uuid="'+o.uuid+'"]',r).attr("ask_confirm","")}else $("#"+t+"-attendees-tab .selected-attendee .unselect-attendee",r).removeAttr("ask_confirm");return n}function ht(e){e.preventDefault(),e.stopPropagation();var t=$(this).filter("#js-requestor-survey").length,n=HandlebarsTemplates["meeting/meeting-servey-item"],i=t?J.request.requestor_fill_survey_links:J.request.fill_survey_links;_.forEach(i.survey_links,function(e){e.response_uuid?e.action=w.ENDPOINTS.survey_responses+"/"+e.response_uuid:e.survey_response_create_url&&(e.action=e.survey_response_create_url.slice(1)),t&&(e.attendee=J.request.requestor.uuid),e.show_survey=!0}),$("#attendee-survey-container").html(n({surveys:i.survey_links})),$("#js-attendee-survey-mail").hide(),t&&i.show_send_mail&&$("#js-attendee-survey-mail").show(),f.updateSurveyType(t?"requestor":"creator"),$(".js-attendee-survey-modal").modal({show:!0,backdrop:"static"})}function _t(e){e.preventDefault();var t=window.meetingInfo.request.action_urls.export_report_url;t&&G.openPageInNewTab(t)}function pt(e){var t=[],n="";$(this).closest(".js-attendee-survey-modal").find(".js-meeting-servey-item").each(function(e,i){var o=$(i).data("uuid");$("#survey-"+o).is(":checked")&&(t.push($(i).data("uuid")),n=$(i).data("attendee"))}),t.length>0?f.triggerSurveyMails(n,J.request.uuid,t):me.notificationModal({"class":"yellow",title:i18n.t("required_survey"),body:i18n.t("survey_not_selected"),timeout:4e3})}function gt(e){e.preventDefault(),e.stopPropagation();var t="internal"===(Ie=$(this).closest(".selected-attendee-item").data("attendee_type"))?v.getInternalAttendees():v.getExternalAttendees(),n=$(this).closest(".selected-attendee-item").data("uuid");Re=n;var i=HandlebarsTemplates["meeting/meeting-servey-item"],o=_.find(t,function(e){return e.uuid===n});_.forEach(o.survey_links,function(e){e.response_uuid?e.action=w.ENDPOINTS.survey_responses+"/"+e.response_uuid:e.survey_response_create_url&&(e.action=e.survey_response_create_url.slice(1)),e.attendee=o.uuid,e.show_survey=_.contains(e.user_access,L.role)}),$("#attendee-survey-container").html(i({surveys:o.survey_links})),!1===o.show_send_mail?$("#js-attendee-survey-mail").hide():$("#js-attendee-survey-mail").show(),f.updateSurveyType("attendee"),$(".js-attendee-survey-modal").modal({show:!0,backdrop:"static"}).data("uuid",n)}function vt(e){e.preventDefault(),e.stopPropagation();var t=$(this),n=t.closest(".selected-item").hasClass("selected-internal-attendee"),i=t.closest(".selected-attendee-item").data("uuid"),o=function(){var e=t.closest(".selected-attendee-item").data("uuid"),n=t.data("url");f.behalfOfMeetingAction(n,e,"post","onBehalfOfSuccess","onBehalfOfFailure")},a=t.closest(".selected-attendee-item").hasClass("declined");!a&&he.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:function(e){var t=M.getAttendeeDetails(e),n=C.getMstConfigs();return P.isEmailNotification(t,n)}(i)?i18n.t("reinvite_confirm_email_message"):i18n.t("reinvite_confirm_message"),done:o});var s=n?$e:Oe;a&&b.canReinviteAttendee(i,s,o)}function yt(e){e.preventDefault(),e.stopPropagation();var t=$(this);he.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:i18n.t("accept_confirm_message"),done:function(){var e=t.closest(".selected-attendee-item").data("uuid");f.behalfOfMeetingAction(t.data("url"),e,"post","onBehalfOfSuccess","onBehalfOfFailure")}})}function bt(e){e.preventDefault(),e.stopPropagation();var t=$(this),n=t.closest(".selected-attendee-item").data("uuid"),i=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";f.behalfOfMeetingAction(t.data("url"),n,"post","onBehalfOfSuccess","onBehalfOfFailure",e)},o=(window.envDetails.isConsecutiveMeeting?T:P).isDeclineCommentEnabled(n),a=o.enabled,s=o.showOnlyOthers?[]:H.getDeclineComments();a?U.show({comments:s,callback:i}):he.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:i18n.t("decline_confirm_message"),done:function(){return i()}})}function wt(e){e.preventDefault(),e.stopPropagation();var t=$(this);he.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:i18n.t("endorse_confirm_message"),done:function(){var e=t.closest(".selected-attendee-item");f.behalfOfMeetingAction(t.data("url"),e.data("uuid"),"post","onBehalfOfSuccess","onBehalfOfFailure")}})}function Mt(t,n,i){var o=v.getInternalAttendees(),a=v.getExternalAttendees(),s=v.showPartialParticipation();o.map(function(o){var a=_.find(i.users.internal,{uuid:t});e[o.uuid]?(o.uuid===t?Ct(o,e[o.uuid],n):yn(o,e[o.uuid]),i&&o.uuid===t&&(o.show_survey=i.show_survey||!1,o.show_send_mail=i.show_send_mail||!1,o.edit_partial_participation=s&&(a.edit_partial_participation||!1),o.view_partial_participation=s&&(a.view_partial_participation||!1))):_.forOwn(Be,function(e,t){o[e]="hide"})}),a.map(function(i){e[i.uuid]?i.uuid===t?Ct(i,e[i.uuid],n):yn(i,e[i.uuid]):_.forOwn(Be,function(e,t){i[e]="hide"})}),Ae=v.getAttendeeCount(),vn(),wn(o,a,mt(v.getAttendees("internal"),"internal"),mt(v.getAttendees("external"),"external"))}function Ct(e,t,n){n&&(e.invite_status=n),yn(e,t)}function St(e){fn(e),b.showAttendeesList("internal")}function At(e){fn(e),b.showAttendeesList("external")}function xt(e){e.preventDefault(),e.stopPropagation();var t=J.request.action_urls.accept_meeting_url;f.meetingAction(t,"post","onMeetingAccepted","onMeetingActionFailed")}function Dt(e){e.preventDefault(),e.stopPropagation();var t=J.request.action_urls.conflict_meeting_url;window.commons.openPageInNewTab(t)}function kt(e){e.preventDefault(),e.stopPropagation();var t=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",t=J.request.action_urls.decline_meeting_url;f.meetingAction(t,"post","onMeetingDeclined","onMeetingActionFailed",null,{declined_comments:e})},n=(window.envDetails.isConsecutiveMeeting?T:P).isDeclineCommentEnabled().enabled,i=H.getDeclineComments();n?U.show({comments:i,callback:t}):t()}function Tt(e){e.preventDefault(),e.stopPropagation();var t=J.request.action_urls.approve_meeting_url;f.meetingAction(t,"put","onMeetingApproved","onMeetingActionFailed")}function Et(e){e.preventDefault(),e.stopPropagation();var t=J.request.action_urls.cancel_meeting_url;P.cancelMeeting({callback:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";f.meetingAction(t,"put","onMeetingCancelled","onMeetingActionFailed",null,{cancel_comments:e})}})}function It(e){e.preventDefault(),e.stopPropagation(),he.notificationModal({type:"confirmation",title:i18n.t("cancel_meeting_title"),body:i18n.t("discard_meeting_confirmation"),done:function(){A.blockRoom(!0)}})}function Rt(e){var t=e.type,n=e.data;"blockRoom"===t&&n.discard&&function(){if(I.isMeetingInDraftMode()){var e=Q.href.split("#")[0];window.commons.redirectPage(function(e,t){var n=t.split("?")[0],i=[],o=-1!==t.indexOf("?")?t.split("?")[1]:"";if(""!==o){for(var a=(i=o.split("&")).length-1;a>=0;a-=1)i[a].split("=")[0]===e&&i.splice(a,1);n=n+"?"+i.join("&")}return n}("destination_activity_uuid",e))}else xn()}()}function $t(){Q.href=Q.href+(-1!==Q.search.indexOf("?")?"&":"?")+$.param({activeMeeting:J.request.uuid})}function Ot(){L.isConsecutiveMeeting?$t():xn()}function Pt(e){s.trigger("consecutiveMeeitngStatusChange",e)}function qt(e){ie.removeClass("pending cancelled approved").addClass(e),oe.text(e),Pe.addClass("hide").filter("."+e+"-text").removeClass("hide"),s.trigger("meetingStatusChanged",e)}function Nt(e,t){var n=e.type,i=e.payload||{},o=We[n];if("function"!=typeof o)if("CustomFormError"!==e.type){e.data&&e.data.custom_form_fields&&(e.custom_form_fields=e.data.custom_form_fields);var a=e.sfdc_meeting_info?e.sfdc_meeting_info:J.request;if($.each(e.custom_form_fields,function(e,t){"meeting_with"===t.field_name?(pe.val(unescape(unescape($.urlParam("meeting_with")))).trigger("change"),ve.add(we).find("label").text(t.label).addClass(t.required&&"required"),ve.add(we).find("span.help-block").text(t.helpText),pe.add(Ce).attr("placeholder",t.placeholder).prop("required",t.required),t.disabled=!!window.isEBCEvent):"topic_management"===t.field_name&&(ye.add(Me).find("label").text(t.label).addClass(t.required&&"required"),ye.find("label").attr("data-original-title",t.label),ye.add(Me).find("#topic_management-complement, #topicField").prop("required",!t.hidden&&t.required),ye.add(Me).find("span.help-block").text(t.helpText),t.hidden?ye.addClass("hide"):ye.removeClass("hide")),v.setCustomFormLabels(t.field_name,t.label)}),_e.show(),setTimeout(function(){$(".meeting-detail-container").slideDown(800)},1),e.custom_form_fields=e.custom_form_fields.filter(function(e){return"agenda_participants"!==e.field_name}),(ae=$(te).formRenderer({fieldCollection:e.custom_form_fields,customCssClass:""})).init(),f.setFormComponent(ae),J.request.meeting_with&&(pe.val(J.request.meeting_with),$("a",ge).text(J.request.meeting_with)),a){if(a.custom_fields=a.custom_fields||{},J&&J.request&&"new"===J.request.mode){if("string"==typeof window.topic_uuid&&t&&(a.custom_fields[t.topic_of_interest]=window.topic_uuid),"boolean"==typeof V&&V){a.meeting_with=window.briefing_with;var r=S.briefingCustomFields;r&&r.briefing_account_id&&(a.custom_fields.meeting_account_id=r.briefing_account_id)}if("string"==typeof window.bam_uuid){var d={},c=S.briefingActivities;if(c.length){var u=_.find(c,function(e){return""+e.id===window.bam_uuid});u.custom_fields.topic_management=u.custom_fields.topic_management&&!1===u.topic_activities_mapped?null:u.custom_fields.topic_management,d=_.result(u,"custom_fields")}a.meeting_with=d.meeting_with||a.meeting_with,a.custom_fields=_.assign(a.custom_fields,d),a.agenda_participants=S.getAttendeesForAgenda(u.id)}}else if("string"==typeof bam_uuid){var l=S.getAttendeesForAgenda(A.getCurrentAgendaUUID());a.agenda_participants=l}a.meeting_with=a.meeting_with||tt(),ae.setValues(a)}ae.afterLoad(),L.isConsecutiveMeeting||function(e){var t=$("#topic_management",s);t.prop("disabled",!0),e.topic_management&&t.html(new window.Option(e.topic_management.name,e.topic_management.uuid,!0)).trigger("change")}(J.request),e.sfdc_meeting_info&&!e.sfdc_meeting_info.second_page_active&&Ve.checkDoubleBookedStatus(on)}else{var m=_.flatten(_.values(e.errors));me.notificationModal({"class":"red",timeout:!0,title:i18n.t("custom_field_error_title"),body:m.join(", ")})}else o(i)}function Bt(){var e=$("#topic-details");return!e.length||e.valid()}function Ut(e,t,n,i){return{topic_id:e,topic_name:t,topic_description:n,showIcon:i}}function Ft(e,t){var n=qe.data("bs.popover"),i=Ut(qe.data("topicDetails").id,qe.data("topicDetails").name,qe.data("topicDetails").description,!1);n.options.content=$(HandlebarsTemplates["book/topics_description"](i))}function jt(e){e.params.args.originalEvent.target;return e.stopPropagation(),qe.data("topicDetails",e.params.args.data),qe.removeClass("hide"),!0}function Ht(e){if(e&&e.id&&"-"!==e.id){var t=Ut(e.id,e.text,e.description,!0);return $(HandlebarsTemplates["book/topics_description"](t))}}function Yt(){return window.isEBCEvent?$("#topicField",r):$("#topic_management-complement",r)}var Lt=function(e){return"-"!==e.uuid&&null!==e.uuid&&""!==e.uuid};function Jt(e){var t,n=$(this),i=n.val(),o=$("#topic_management",s).val();("-"===i&&(i=""),i||qe.addClass("hide"),null!==i||"-"!==o&&o)&&(v.setModelData("topicName",n.find('option[value="'+i+'"]').text()),z?function(e){"edit"===W?function(e){$("#topic_management",s);var t=!1,n=window.envDetails.currentUser,i=n.can_manage_meetings_of_associated_topics&&-1!==n.topics.indexOf(e),o=window.envDetails.isJuniorMM()&&!i?i18n.t("reset_users_and_rooms_confirm_msg_for_jmm_mapped_to_topic"):i18n.t("reset_users_and_rooms_confirm_msg");he.notificationModal({title:i18n.t("please_note_title"),"class":"blue",type:"confirmation",body:o,hideCloseBtn:!0,done:function(){t=!0},dismiss:function(){t?(Wt(e),Zt()):zt()}})}(e):function(e){Wt(e),Zt()}(e)}(i):(t=i)?f.checkNonRetainedResources({topic:t}):Vt({newTopic:t}),setTimeout(function(){n.valid()},0))}function Vt(e){var t=e.newTopic,n=e.users,i=n===undefined?[]:n,o=e.rooms,a=o===undefined?[]:o,s=function(e){var t=e.newTopic,n=e.users,i=e.rooms,o=window.envDetails.currentUser,a=o.topics,s=a===undefined?[]:a,r=o.can_manage_meetings_of_associated_topics,d=window.envDetails.isJuniorMM(),c=r&&-1!==s.indexOf(t),u=0===n.length&&!i[0];return{skipModal:d&&c&&u||!d&&u,showTopicHeader:d&&!c}}({newTopic:t,users:i,rooms:a}),r=s.skipModal,d=s.showTopicHeader;r?(Wt(t),f.topicChangeRefeshAttendeesAndRoomsList()):function(e){var t=e.users,n=t===undefined?"":t,i=e.rooms,o=i===undefined?"":i,a=e.showTopicHeader,s=e.topic,r=(0,HandlebarsTemplates["book/confirm_topic_change"])({users:n,rooms:o,showTopicHeader:a}),d=!1;he.notificationModal({"class":"semantic-modal topic-change",type:"confirmation",body:r,title:i18n.t("confirm_topic_change"),done:function(){d=!0},dismiss:function(){d?(Wt(s),f.topicChangeRetainResources()):zt()},doneBtnText:i18n.t("proceed_in_notification"),cancelBtnText:i18n.t("cancel_in_notification")})}({users:i=i.join(", "),rooms:a=a.join(", "),showTopicHeader:d,topic:t})}function Wt(e){var t=Yt();"edit"===W&&(J.request.topic_uuid=e,v.setTopicDirty()),topic_uuid=e;var n=t.find('option[value="'+e+'"]').text();Gt(t,e),f.topicChange(e,n)}function zt(){var e=$("#topic_management",s),t=Yt();t.off("change",Jt),Ye&&"-"!==Ye?(t.select2("val",Ye),f.topicChange(Ye),qe.data("topicDetails",Le)):(t.val("").trigger("change"),e.html(""),e.val("").trigger("change"),f.topicChange("",""),qe.addClass("hide"),qe.data("topicDetails",{})),t.on("change",Jt)}function Zt(){x.fetchExperts({callback:function(){f.resetAttendeesAndRooms()}})}function Gt(e,t){var n=$("#topic_management",s);n.length&&(n.html(e.first().find("option").clone()),n.val(t),n.trigger("change.select2"))}function Qt(e){var t;se.addClass("hide"),ce.addClass("hide"),le.addClass("hide"),ue.addClass("hide"),re.addClass("hide"),de.addClass("hide"),e.map(function(e,t){"export report"===(e=e.toLowerCase())&&(e="export-report"),$("."+e+"-meeting").removeClass("hide")}),bn()||le.addClass("hide"),t=$(".js-secondary-action-list").find("li:not(.hide)").length,$(".js-secondary-action-dropdown")[t?"removeClass":"addClass"]("hide")}function Kt(e){var t,n=$("#requestor-select-complement"),i=$("#requestor-select");L.isConsecutiveMeeting&&(e=Qe()||L.isJuniorMM()?"yes":"no"),L.briefingAndMeetingRequestorSame&&(e="no"),"yes"===e?((t={allowClear:!0,minimumInputLength:1,cache:!0,width:"100%",placeholder:i18n.t("please_select_requestor"),dropdownCssClass:"iris-select2-dropdown"}).ajax={delay:256,transport:function(e,t,n){return f.fetchRequestors(e,t,n)},data:function(e){return{search_by_name:(e.term||"").trim(),activity_id:Te}},processResults:function(e,t){var n=[];return e&&e.users instanceof Array&&(n=e.users.map(function(e){return{id:e.uuid,text:e.name}})),{results:n}}},"undefined"!=typeof jiffle&&(t.ajax={data:function(e){return{search_by_name:(e.term||"").trim(),activity_id:Te}},transport:function(e,t,n){return w.fetch({data:e.data,url:w.ENDPOINTS.fetch_requestors}).then(t)["catch"](n)},delay:256,processResults:function(e){var t=[];return e&&e.users instanceof Array&&(t=e.users.map(function(e){return{id:e.uuid,text:e.name}})),{results:t}}}),n.select2(t),i.select2(t)):L.isExecutiveAdmin()&&!L.briefingAndMeetingRequestorSame?"All"===L.currentManagedUser||L.currentManagedUser instanceof Array&&(-1!==L.currentManagedUser.indexOf(L.currentUser.uuid)||L.currentManagedUser.length>1)||J.requestors instanceof Array&&J.requestors.length>1?((t={allowClear:!1,cache:!0,width:"100%",placeholder:i18n.t("please_select_requestor")}).data=J.requestors.map(function(e){return{id:e[1],text:e[0]}}),n.select2(t),i.select2(t)):(Xt(),$("[id^='requestor-label-div']").removeClass("hide").text(n.find("option:selected").text())):(Xt(),$("[id^='requestor-label-div']").removeClass("hide").text(i.find("option:selected").text())),window.envDetails.isConsecutiveMeeting&&n.off("change.custom").on("change.custom",function(e){$(this).val()&&k.fetchMeetingTypes()})}var Xt=function(){var e=$("#requestor-select-complement"),t=$("#requestor-select");e.addClass("hide"),t.addClass("hide")};function en(e){g.addAttendeeAsKeynoteSpeaker.call($('.add-keynote-speaker[data-uuid="'+e+'"]',".selected-attendee"))}function tn(e){if(e&&e.preventDefault(),$("#meet-details").removeClass("affix").removeClass("affix-top"),$(".meeting-detail-side-fix").removeClass("affix").removeClass("affix-bottom"),N.setTimeFieldsWithMeetingTime(),ct()&&Bt()){var t=v.isValidMeeting();!1===t.error?(t.meetingHostAutoAdd&&en(t.userUUID),t.confirmation&&"new"===J.request.mode?he.notificationModal({"class":"yellow",type:"confirmation",body:t.message,title:t.title||i18n.t("meeting_validation_notify_title"),done:function(){"undefined"!=typeof jiffle?nn():Ve.checkDoubleBookedStatus(on)}}):"undefined"!=typeof jiffle&&"new"===J.request.mode?nn():Ve.checkDoubleBookedStatus(on),M.isInternalAttendeesHidden()&&M.isMappingEnabled()&&($(".selected-internal-attendee div").hide(),$(".selected-internal-attendee").append('<div class="selected-title">'+i18n.t("auto_add_internal_attendees")+"</div>"))):me.notificationModal({"class":"red",timeout:!0,body:t.message,title:t.title||i18n.t("meeting_validation_notify_title")})}else q.showMandatoryFieldsMsg()}function nn(){window.isLeadsMeeting?f.fetchSfdcCustomForm():v.model.account.is_changed?(f.fetchSfdcCustomForm(),v.model.account.is_changed=!1):Ve.checkDoubleBookedStatus(on)}function on(){if(r.addClass("hide"),s.removeClass("hide"),window.scrollTo(0,0),!V){var e=$("#topic_management-complement",r);Gt(e,e.val())}"new"===J.request.mode&&"undefined"==typeof jiffle&&pe.trigger("change"),function(){if(Se||L.briefingAndMeetingRequestorSame)return;var e=L.currentUser.uuid,t=L.isExecutiveAdmin();if("new"===J.request.mode)if(t){var n=L.currentManagedUser;"All"===n?_.first(Ne.find("option")).selected=!0:n!==e&&Ne.find("option").each(function(e,t){n===t.value&&(t.selected=!0)})}else Ne.find("option").each(function(t,n){e===n.value&&(n.selected=!0)});Ne.trigger("change"),$("[id^='requestor-label-div']").text(Ne.first().find("option:selected").text())}()}function an(e,t){var n="",i=$(Ne.selector,s),o=$(Ne.selector,r),a=e.map(function(e){return t===e[1]&&(n=e[0]),$("<option>").val(e[1]).text(e[0])});sn(i,o),sn(o,i),Ne.append(a),Ne.val(t).trigger("change"),$('[id^="requestor-label-div"]').text(t&&n||"")}function sn(e,t){e.one("change",function(e){e.preventDefault(),e.stopPropagation(),function(e){var t=$("option:selected",this);Se=!0,$("[id^='requestor-label-div']").text(t.first().text()),v.setModelData("requestorName",t.first().text()),e.length>0&&(e.hasClass("select2-hidden-accessible")?(e.html($("option",this).clone()),e.select2("val",t.val())):e.val(t.val()),sn($(this),e),e.val()||ut("show"))}.call(this,t)})}var rn=function(e,t){var n=e.model,i=e.customFormLabels,o=e.mstConfigs,a=e.activitySettings,s=ae.getValues(),r=(L.event.time_zone_display_name||"").trim()||L.event.time_zone,d={};_.forEach(i,function(e,t){d[t]={label:e,value:s[t]}}),Z&&((r=B.getTimeZoneToBeShownOnProceedPage())||(r=B.getTimeZoneFromMeetingInfo())),!0===window.isEBCEvent&&(r=L.current_location.time_zone_display_name||L.current_location.timezone);var c=R.showBreakInfo(n.event,a),u=window.envDetails.topicManagementEnabled&&!ye.hasClass("hide");return{meetingData:l({},n,{customFieldsMap:d,showBreakInfo:c,activitySettings:a,isMeetingValid:t,isTopicEnabled:u,mstConfigs:o}),meetingTimeZone:r}};function dn(e){e.preventDefault(),e.stopPropagation(),N.setTimeFieldsWithMeetingTime();var t=$("form#details-form"),n=t.validate({showErrors:function(e,t){for(var n=0,i=this.validElements();i[n];n++)this.settings.unhighlight.call(this,i[n],this.settings.errorClass,this.settings.validClass);for(var o,a=0;t[a];a++)o=t[a],this.settings.highlight(o.element)}}),i=J.request&&"edit"===J.request.mode,o=L.isJuniorMM()||L.isMeetingManager()||L.isCSM();if(ct()&&Bt()){var a=v.isValidMeeting();if(a.error)me.notificationModal({"class":"red",timeout:!0,body:a.message,title:a.title||i18n.t("meeting_validation_notify_title"),dismiss:q.focusInMeetingWith});else{var s=function(){return cn(t,n,i,o)};a.meetingHostAutoAdd&&(s=function(){en(a.userUUID),cn(t,n,i,o)});var r=window.envDetails.isConsecutiveMeeting?function(e,t){var n=ae.getValues().meeting_with,i=e.model.event.start_date,o=e.model.requestorName,a=[];return t.consecutiveMeetings.forEach(function(e){var t=e.event,n=e.activitySettings,i=e.topicSettings,o=i===undefined?{enabled:window.envDetails.topicManagementEnabled,label:i18n.t("topic_of_interest")}:i,s=o.enabled,r={topic_management:o};a.push(Object.assign({},e,{showBreakInfo:R.showBreakInfo(t,n),isTopicEnabled:s,customFieldsMap:r}))}),{meetingWith:n,meetingData:a,meetingDate:i,requestorName:o}}(v,T):rn(v,a);r=l({},r,{submitCallBack:s,isConsecutive:window.envDetails.isConsecutiveMeeting}),Ve.checkDoubleBookedStatus(function(){window.renderMeetingSummary($(".mount-meeting-summary"),r)})}}else n.focusInvalid(),q.showMandatoryFieldsMsg()}function cn(e,t,n,i,o,a){n?i?dt(function(e){Ve.submitMeetingHandler(!0,e)}):Ve.submitMeetingHandler(!0):setTimeout(function(){Ve.submitMeetingHandler(!0)},1e3)}function un(e){D.checkDoubleBookedStatus(e)}function ln(){if(!v.getOnDemandFirstPageLoaded()){"undefined"==typeof briefing_uuid&&F.eventInfo(),et(),window.envDetails.isConsecutiveMeeting||F.initialAvailability();var e=J.request.users,t=_.isPresent(e)&&(e.internal.length||e.external.length),n=_.isEmpty(J.request.room)&&!t;J.request.location_preference&&j.locationPreferenceChange.trigger(J.request.location_preference,n),v.setOnDemandFirstPageLoaded(!0)}}function fn(e){e.preventDefault(),e.stopPropagation(),r.removeClass("hide"),s.addClass("hide"),$("#meet-details li:first a").click(),window.scrollTo(0,0),scheduler._is_initialized()&&scheduler.update_view(),"edit"!==W||window.envDetails.isConsecutiveMeeting||window.isEBCEvent||ln()}function mn(e){e.preventDefault(),e.stopPropagation();if(this.hasAttribute("ask_confirm"))me.notificationModal({title:i18n.t("meeting_notify_failure_title"),body:i18n.t("select_min_internal_attendee_to_continue",{company_name:L.companyName}),"class":"red",dismiss:function(){}});else{var t=hn(this,"internal");he.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:"edit"===W&&""!==t.attendee_name?i18n.t("remove_confirm_message_for_send_ics_opt"):i18n.t("remove_confirm_message_for_save"),done:function(){b.unselectInternalAttendee(t.uuid)}})}}function hn(e,t){var n=$(e).data("uuid"),i="";if("edit"===W){if(L.isConsecutiveMeeting){var o="internal"===t?v.getInternalAttendees():v.getExternalAttendees();i=_.find(o,{uuid:n})}else i=_.find(J.request.users[t],{uuid:n});i=_.isUndefined(i)?"":i.user_name}return{uuid:n,attendee_name:i}}function _n(e){e.preventDefault();var t,n,i=hn(this,"external");this.hasAttribute("ask_confirm")?me.notificationModal({title:i18n.t("meeting_notify_failure_title"),body:i18n.t("select_min_external_attendee_to_continue"),"class":"red",dismiss:function(){}}):(t=L.isConsecutiveMeeting?i18n.t("edit"===W&&""!==i.attendee_name?"remove_from_all_confirm_message":"remove_from_all_confirm_message_for_save",{activity:window.selectedActivityName,attendee_name:i.attendee_name}):i18n.t("edit"===W&&""!==i.attendee_name?(n=i.uuid,!1===$("#send_ics_"+n).prop("checked")?"remove_confirm_message_for_send_ics_opt":"remove_confirm_message"):"remove_confirm_message_for_save",{attendee_name:i.attendee_name}),he.notificationModal({type:"confirmation","class":"blue",title:i18n.t("confirmation_title"),body:t,done:function(){b.unselectExternalAttendee(i.uuid)}}))}function pn(){return J.request.can_change_room}function gn(e){var t,n,i,a=HandlebarsTemplates["book/selected_room"],r=HandlebarsTemplates["book/proceed_room"];e&&e.type&&e.room?(n=a(t=e.offsite||e.isBoothTour?{offsite:!0,booth_tour:e.isBoothTour,address:e.room.address||e.room.location,name:e.room.name,capacity:""}:{name:e.type.name,offsite:!1,booth_tour:e.isBoothTour,display_name:e.type.name,room_name:e.room.name,capacity:e.room.capacity}),t.showGotoMainOptionFromDetails=Ee,t.hideChangeRoom=!Ee,t.canChangeRoom=pn(),t.roomNotAvailable=!1,xe=t.capacity,i=r(t)):(n=a(),i=r({roomNotAvailable:!0,roomNotAvailableMessage:J.request.room_not_assigned_msg||i18n.t("room_not_assigned_msg"),canChangeRoom:pn()})),d.html(i),o.html(n),vn(),s.trigger("room_change",{isOffsite:e.offsite||e.isBoothTour,isMappingEnabledActivity:z,isSFDC:"undefined"!=typeof jiffle}),e.room?($("#room-label").text(e.offsite?t.name:t.room_name),$("#attendee-label").html(i18n.t("attendees_and"))):function(){if(!V){var e=[];scheduler.config.can_book_room&&e.push(i18n.t("room")),scheduler.config.offsite_enabled&&scheduler.config.can_book_offsite&&e.push(v.offsiteLabel)}$("#room-label").text(""),$("#attendee-label").hasClass("hide")&&$("#attendee-label").closest(".header-right").addClass("hide");$("#attendee-label").html(i18n.t("attendees_and"))}()}function vn(){(S.briefingInternalAttendees.length||S.briefingExternalAttendees.length)&&(Ae=v.getAttendeeCount());var e=$("#roomFullHolder"),t=$("#occupiedRoomHolder"),n=xe-Ae;n<=0?(e.removeClass("hide"),t.addClass("hide")):(e.addClass("hide"),t.removeClass("hide").find(".occupiedCount").text(n))}function yn(e,t){var n=t||{};_.forOwn(Be,function(t,i){n[i]?(e[t]="",e[i]=n[i]):e[t]="hide"})}function bn(){return!("undefined"!=typeof jiffle&&(Qe()||L.isJuniorMM()||L.isQueueManager()))}function wn(e,t,n,i){var o=window.envDetails.isConsecutiveMeeting?T.getCurrentMeeting().status:window.meetingInfo.request.status,a=HandlebarsTemplates["book/selected_attendee"],s={users:e,type:"internal",actions:!1,meetingCancelled:"cancelled"===o},r=(Qe()||L.isJuniorMM()||L.isExecutiveAdmin())&&"new"!==J.request.mode&&!L.isConsecutiveMeeting,d=Ee&&!1===M.isInternalAttendeesHidden()&&0===e.length,c=Ee&&!1===M.isExternalAttendeesHidden()&&0===t.length,u={users:e,isConsecutive:L.isConsecutiveMeeting,role_enabled:bn()&&r,askConfirm:n,remove:!1,remove_label:i18n.t(Fe.remove),accept_label:i18n.t(Fe.accept),decline_label:i18n.t(Fe.decline),type:"internal",actions:bn(),show_empty_state:d,empty_text:i18n.t("add_internal_participants"),meetingCancelled:"cancelled"===o};if(L.enable_meeting_host&&L.enable_meeting_host.toBoolean()){var l={meeting_host_label:L.meeting_host_label,enable_meeting_host:L.enable_meeting_host.toBoolean()};_.each(e,function(e){if(_.isUndefined(e.meeting_host))e.meeting_host=!1;else if(e.meeting_host){var t=$('a.add-keynote-speaker[data-uuid="'+e.uuid+'"]');g.meetingHostUIAction(t,e.uuid)}}),s.users=_.sortByOrder(s.users,["meeting_host"],[!1]),u.users=_.sortByOrder(u.users,["meeting_host"],[!1]),_.merge(s,l),_.merge(u,l)}var f=a(s),m=a({users:t,type:"external",actions:!1,meetingCancelled:"cancelled"===o});ee.html(f),K.html(m),Mn(e,ee),Mn(t,K),f=a(u),X.html(f),m=a({users:t,role_enabled:bn()&&r,askConfirm:i,remove:!1,remove_label:i18n.t(Ue.remove),accept_label:i18n.t(Ue.accept),decline_label:i18n.t(Ue.decline),type:"external",actions:bn(),show_empty_state:c,empty_text:i18n.t("add_external_participants"),meetingCancelled:"cancelled"===o}),Y.html(m),Mn(e,X),Mn(t,Y)}function Mn(e,t){var n={};e.forEach(function(e){n[e.uuid]=e});var i=HandlebarsTemplates["book/user_tooltip"];$(".selected-attendee-item",t).map(function(){var e=$(this).data("uuid"),t=n[e];$(this).popover({html:"true",template:"<div class='popover room-tooltip' role='tooltip'><div class='popover-content'></div></div>",content:i(t),trigger:"hover",placement:"right"})})}function Cn(e){var t=HandlebarsTemplates["book/selected_time"],n=HandlebarsTemplates["book/proceed_time"];if(e.event){var i=moment(e.event.start_date).format("hh:mm a"),o=function(e,t){var n=moment(e);return n.subtract(t,"minutes"),n.format("hh:mm a")}(e.event.end_date,e.event.break_duration),s=moment(e.event.start_date,"DD-MM-YYYY")._d.toMediumDate();$("#timeLabel").html('<span class="event_date">'+s+"&nbsp</span>"+i+"&nbsp-&nbsp"+o);var r=t({start_time:i,end_time:o,event_date:s,display:!0});a.html(r);var d="edit"===W&&Ee,u="new"===W,l=(L.event.time_zone_display_name||"").trim()||L.event.time_zone;Z&&((l=B.getTimeZoneToBeShownOnProceedPage())||(l=B.getTimeZoneFromMeetingInfo())),!0===V&&(l=L.current_location.time_zone_display_name||L.current_location.timezone),r=n({break_duration:e.event.break_duration,start_time:i,end_time:o,event_date:s,meeting_time_zone:l,uuid:e.event.uuid,showRescheduleTimeOption:d,showChangeTimeOption:u,showGotoMainOptionFromDetails:Ee}),c.html(r)}else $("#timeLabel").html(""),a.html(t({display:!1})),c.html(n())}function Sn(){if("undefined"!=typeof window.briefing_uuid){var e=""+document.getElementsByTagName("base")[0].href+w.ENDPOINTS.list_briefings_agenda.replace("{QUERY_PARAMS}","?current_location_uuid="+L.current_location_uuid)+"/"+window.briefing_uuid;window.commons.redirectPage(e)}}function An(e){var t=(e.target.value||"").trim();"select_account"==e.target.id&&(t=(r.find("#select_account").find("option:selected").text()||"").trim());var n=this.id;$("a","li#meetingWithInfo").text(t),"meeting_with"===n?pe.val(t):"req_page_meeting_with"===n&&$("#meeting_with",s).val(t),t||ut("show")}function xn(){var e=L.urlPrefix+ze,n=void 0!==V&&!0===V;if("undefined"!=typeof jiffle){var i=Q.search,o=new RegExp("[?&]accid=([^&#]*)").exec(i),a=new RegExp("[?&]oppid=([^&#]*)").exec(i),s=new RegExp("[?&]lead_ids=([^&#]*)").exec(i),r=new RegExp("[?&]eventName=([^&#]*)").exec(i),d=new RegExp("[?&]current_location_uuid=([^&#]*)").exec(i),c="";c+=""+r[0]+d[0],Ge&&(c+="&showActivities=true",o&&(c+=o[0]),a&&(c+=a[0]),s&&(c+=s[0])),c=c.replace(/^&/,"?"),e=n?""+w.ENDPOINTS.apex_jnlistagenda+c+"#/list_agenda/"+window.briefing_uuid:w.ENDPOINTS.apex_jnmeetings+c,window.sfdcNameSpace&&((e=e.split("/"))[2]=""+window.sfdcNameSpace+e[2],e=e.join("/")),e=isLightningExperience()?"/one/one.app#/alohaRedirect"+e:e}else if(n){var u=document.getElementsByTagName("base")[0].href;if("undefined"!=typeof window.briefing_uuid)if(window.redirect_to_meeting_list)e=e+(i?"&":"?")+"source=book_meeting#meeting_list";else e=""+u+w.ENDPOINTS.list_briefings_agenda.replace("{QUERY_PARAMS}","?current_location_uuid="+L.current_location_uuid)+"/"+window.briefing_uuid;else e=u+w.ENDPOINTS.event_home}n||(e=(e=e+(i?"&":"?")+"source=book_meeting")+"#"+(window.envDetails.isConsecutiveMeeting?"consecutive_meeting_list":window.mappingEnabled&&t?"mapping_list":"meeting_list"));window.commons.redirectPage(e)}return{init:function(){v.listen(function(e){var t=e.action,n=e.payload||{},i=We[t];i&&i(n)}),S.listen(function(e){f.getCustomForm();var n=e.data.data;if(void 0!==V&&!0===V){if(ke.text("Briefing Id #"+n.id+" : "),n.requestor&&L.briefingAndMeetingRequestorSame&&t){var i=n.requestor.uuid;an([[n.requestor.first_name+" "+n.requestor.last_name,i]],i)}vn()}}),y.listen(Nt),A.listen(Rt),ke.on("click",Sn),s.on("click","#js-meeting-history-tab",nt),s.on("click","#js-meeting-notes-tab",it),s.on("click",".go-to-main",fn),s.on("click",".go-to-main-external",At),s.on("click",".go-to-main-internal",St),$(s).on("change","#meeting_with",An),$(r).on("change","#req_page_meeting_with",An).on("change","#select_account",An).on("click","#quick_submit_btn",q.focusInMeetingWith).on("click","#quick_submit_btn",_.debounce(dn,2e3)).on("click",ne.selector,q.focusInMeetingWith).on("click",ne.selector,tn),s.on("click",".accept-meeting",xt).on("click",".decline-meeting",kt).on("click",".approve-meeting",Tt).on("click",".cancel-meeting",Et).on("click",".discard-meeting",It).on("click",".attendee_reinvite",vt).on("click",".attendee_accept",yt).on("click",".attendee_endorse",wt).on("click",".attendee_decline",bt).on("click",".attendee_survey",gt).on("click",".js-meeting-survey",ht).on("click",".export-report-meeting",_t).on("click",re.selector,Dt),$(document).on("click","#js-attendee-survey-mail",pt),s.on("click",".attendee-empty-state.internal",St),s.on("click",".attendee-empty-state.external",At),$(".selected-internal-attendee",s).on("click",".remove",mn),$(".selected-external-attendee",s).on("click",".remove",_n),r.on("click","#meetingWithSubmit",ot),s.on("click",".js-conference-type",Ke),r.on("click","li#meetingWithInfo",at),s.on("click","#submitButton",_.debounce(rt,2e3)),De.on("click",It),pe.on("focusout keyup paste",q.validateMeetingWith),v.getIsMascalOrigin()||"new"===W||I.isMeetingInDraftMode()?(r.removeClass("hide"),s.addClass("hide")):(r.addClass("hide"),s.removeClass("hide")),("new"===W||window.envDetails.isConsecutiveMeeting||window.isEBCEvent)&&et();var i=Qe()||L.isJuniorMM();if(t=J.request&&"new"===J.request.mode,an(J.requestors,function(){if(J.request&&"edit"===J.request.mode){for(var e=J.request.requestor.uuid,t=!1,n=J.requestors.length-1;!t&&n>=0;n--)t=J.requestors[n][1]===e;return!1!==t||_.isEmpty(J.request.requestor)||J.requestors.push([J.request.requestor.first_name+" "+J.request.requestor.last_name,e]),e}return L.isExecutiveAdmin()?_.first(L.currentManagedUser):J.requestors.length?_.first(J.requestors)[1]:L.currentUser.uuid}()),L.isConsecutiveMeeting&&(Kt(),"new"===window.mode&&k.fetchMeetingTypes(),Ve.checkDoubleBookedStatus=un,Ve.submitMeetingHandler=lt,Ue.remove="remove_from_all",Ue.accept="accept_all",Ue.decline="decline_all",J.domainValidateUrl=w.ENDPOINTS.portal+w.ENDPOINTS.domain_validation),i&&f.getQuickMeetingConfig(),window.isEBCEvent||L.isConsecutiveMeeting||!0!==L.topicManagementEnabled||Xe(),"undefined"!=typeof jiffle&&f.getActivityDetails(),e=window.actions_on_behalf,"undefined"==typeof jiffle&&(fe.filter("#js-meeting-survey")[J.request.fill_survey?"removeClass":"addClass"]("hide"),fe.filter("#js-requestor-survey")[J.request.requestor_fill_survey?"removeClass":"addClass"]("hide")),L.isConsecutiveMeeting||function(){if(J&&J.request&&"edit"===J.request.mode){v.getIsMascalOrigin()||I.isMeetingInDraftMode()||(r.addClass("hide"),s.removeClass("hide")),Qt(J.request.actions),n.removeAttr("data-i18n"),n.text(i18n.t("meeting_id")+J.request.id),oe.text(J.request.status),ie.addClass(J.request.status),window.scrollTo(0,0);var e=J.request.users.internal,t=L.currentUser.uuid,i=_.find(e,function(e){return e.uuid===t&&"declined"!==e.invite_status});i?f.updateAreYouAttending(!0):f.updateAreYouAttending(!1);var o=J.request.requestor;o&&o.uuid&&(Ne.val(o.uuid),$('[id^="requestor-label-div"]').text(Ne.first().find("option:selected").text()))}}(),"edit"===W&&u.attr("data-i18n","UPDATE"),!Qe()&&ne.removeClass("btn-white").addClass("btn-blue"),J.can_access_reviews&&h.init({entityUuid:J.request.uuid,mountPoint:"#meeting-review-tab",fetchUrl:w.ENDPOINTS.get_reviews,updateUrl:w.ENDPOINTS.update_review,entityType:window.entityNameForReview}),pe.val(tt()).trigger("change"),"new"===window.mode){var o=$.urlParam("location_preference");o&&j.locationPreferenceChange.trigger(o)}var a=J.request;_.isEmpty(a.room)&&function(e){var t=(0,HandlebarsTemplates["book/proceed_room"])({roomNotAvailable:!0,roomNotAvailableMessage:e.room_not_assigned_msg||i18n.t("room_not_assigned_msg"),canChangeRoom:pn()});d.html(t)}(a),q.init(),"function"==typeof He[Q.hash]&&He[Q.hash]();var c="edit"===window.mode&&!window.envDetails.isConsecutiveMeeting&&!window.isEBCEvent,l=I.isMeetingInDraftMode(),m=v.getIsMascalOrigin()&&!window.isEBCEvent||l;if(m&&ln(),c&&!m){!_.isEmpty(a.room)&&gn({type:J.request.activity,room:J.request.room,offsite:J.request.room.offsite,isBoothTour:"BoothTour"===J.request.room.type});var p={event:{end_date:moment(J.request.end_time,"DD-MM-YYYY hh:mm a")._d,start_date:moment(J.request.start_time,"DD-MM-YYYY hh:mm a")._d,break_duration:J.request.meeting_break.meeting_break_duration}};Cn(p),v.updateMeetingTime(p.event),Kt(i||J.request.show_all_requestors?"yes":"no"),v.updateAttachmentAttributes(J.attachmentSettings,J.request.attachments)}},setAddOffsiteLabel:function(e){scheduler.config.offsite_enabled&&$('#offsiteTab > a[data-i18n="add_offsite_location"]').text(e).attr("data-content",e)},setBoothTourLabels:function(e,t,n){$(".js-booth-tour-header").text(e),$(".js-booth-tour-btn-label").text(t)},setEnableEdit:function(e){Ee=e}}}();t.exports=K}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingInMaking/handler.js","/app/scripts/Book/MeetingInMaking")},{"../../CommentsModal":66,"../../Notes/handler":73,"../../Reviews/handler":79,"../../commons/book/MeetingInMaking/handler":94,"../../commons/date_format":96,"../../commons/granular_edit":97,"../../history/handler":108,"../../utils":110,"../Attendee/actions":8,"../Attendee/handler":9,"../Attendee/store":10,"../BriefingRequest/store":12,"../Calendar/actions":13,"../Calendar/handler":14,"../ChangeMeetingType/handler":17,"../ConsecutiveMeetings/actions":20,"../ConsecutiveMeetings/handlers/mainHandler":23,"../ConsecutiveMeetings/stores/mainStore":31,"../Expert/actions":36,"../MeetingType/actions":48,"../MeetingType/store":50,"../OngoingSales/store":54,"../commonHandlerUtility":63,"./actions":42,"./form_store":45,"./store":47,_process:114,buffer:112,common_api:"common_api"}],47:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function m(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var h=e("./actions"),p=e("common_api"),g=e("../MeetingType/actions"),v=e("../MeetingType/store"),y=e("../Attendee/store").AttendeeStore,b=e("../Attendee/actions"),w=e("../Attendee/store").AddEditAttendeeStore,M=e("../../Sfdc/SfdcAccount/store"),C=e("../Calendar/actions"),S=e("../ConsecutiveMeetings/actions"),A=e("../OngoingSales/actions"),x=e("../BriefingRequest/store").BriefingRequestStore,D=e("../Expert/store"),k=e("./attachment_store"),T=e("./booth_tour_store"),E=e("../../PartialParticipation/store"),I=e("../../commons/date_format"),R=e("../CommonStore"),O=e("../../Sfdc/commons"),P=$("#submitButton"),q=$("#quick_submit_btn"),N=window,B=N.envDetails,U=N.meetingInfo,F=N.isOngoingSales,j=N.mappingEnabled,H=e("../OngoingSales/store"),Y=e("../../commons/granular_edit").convertMinutesToReadable,L=e("../Calendar/store").CalendarAvailabilityStore,J=Reflux.createStore({init:function(){this.offsiteLabel=i18n.t("offsite"),this.model={room:{uuid:""},external:[],internal:[],event:null,attendingMeetingStatus:null,account:{is_changed:!0,acc:{id:"",name:""},oppty:{id:"",name:""}},location_preference:"",integrations:{},newCreatedUsers:[]},this.validStartTimes=[],this.topicDirtyFlag=!1,this.activitySettings={},this.customFormLabels={},this.listenTo(D,this.expertStoreSelection),this.listenTo(v.MeetingStore,this.onMeetingTypeChanged),this.listenTo(y,this.attendeeStoreSelection),this.listenTo(w,this.attendeeStoreSelection),this.listenTo(C.eventCreated,this.onEventCreated),this.listenTo(h.createMeeting,this.createSingleMeeting),this.listenTo(h.rescheduleMeeting,this.rescheduleSingleMeeting),this.listenTo(M,this.onAccountOpptySelected),this.listenTo(A.updateCalendar,this.onOngoingSalesMeetingDateChanged),this.listenTo(E,this.setParticipation),this.listenToMany(h),this.survey_type="",this.mstConfigs={},this.isMeetingUpdateInProgress=!1,this.nonRetainedResources={users:[],rooms:[]},this.onDemandFirstPageLoaded=!1,this.isMascalOrigin="cal"===$.urlParam("source")},mixins:[k,T,R],updateMeetingTime:function(e){this.model.event=e},onGetQuickMeetingConfig:function(){p.fetch({url:p.ENDPOINTS.system_configurations,data:{basic_info:!0}}).then(function(e){this.trigger({action:"onGetQuickMeetingConfig",payload:e.data})}.bind(this))},onUpdateSurveyType:function(e){this.survey_type=e},setParticipation:function(e){if("setParticipationTime"===e.action){var t=_.find(this.model.internal,{uuid:e.data.uuid});t&&(t.partial_start_time=e.data.startTime,t.partial_end_time=e.data.endTime)}},showPartialParticipation:function(){return U.request&&"new"===U.request.mode&&!window.envDetails.isConsecutiveMeeting},setValidStartTimeForMeeting:function(e){this.validStartTimes=e},getValidStartTimesForMeeting:function(){return this.validStartTimes},onFetchVaildStartTimesForMeeting:function(e){var t="-"===$("#topic_management").val()?"":$("#topic_management").val(),n={activity_uuid:window.selectedActivityUuid,topic_uuid:t,room_uuid:this.model.room.uuid,user_uuids:_.pluck(this.model.internal.concat(this.model.external),"uuid")};e&&(n.event_date=moment(e).format("DD-MM-YYYY")),p.fetch({url:p.ENDPOINTS.fetch_valid_mapping_Times,data:n}).then(function(e){this.setValidStartTimeForMeeting(e.data)}.bind(this))},onGetActivityDetails:function(){p.fetch({url:p.ENDPOINTS.activity_details.replace("{uuid}",window.selectedActivityUuid)}).then(function(e){this.trigger({action:"onGetActivityDetails",payload:e.data})}.bind(this))},onInitiateNewMeeting:function(e,t){this.onUpdateMeetingModel(e,t),h.initiateNewMeetingCustomForm(e),this.trigger({action:"initiateNewMeeting",payload:{activity:e,model:t}}),this.updateTimeRoom(),t.isNew&&this.updateAttendees()},onUpdateMeetingModel:function(e,t){var n=this.model.requestorName;this.model=_.assign({},t,{requestorName:n}),window.selectedActivityUuid=e},callShowAvailableRooms:function(){var e=this.getAttendeeCount();v.MeetingStore.showAvailableRooms(e)},updateTimeRoom:function(){this.callShowAvailableRooms();var e=this.model.room,t=this.model.meetingType;t.display_name=e.offsite_name,this.trigger({action:"onEventCreated",payload:{event:this.model.event}}),this.model.activitySettings&&this.model.activitySettings.booth_tour_label&&(e.booth_tour_display_name=this.model.activitySettings.booth_tour_label),this.trigger({action:"onRoomChosen",payload:{type:t,room:e,offsite:e.offsite,isBoothTour:e.isBoothTour}})},renderTimeRoomAttendee:function(){var e=this.model.room,t=this.model.meetingType;this.trigger({action:"onEventCreated",payload:{event:this.model.event}}),this.trigger({action:"onRoomChosen",payload:{type:t,room:e,offsite:e.offsite,isBoothTour:e.isBoothTour}}),this.updateAttendees()},updateAttendees:function(){this.trigger({action:"onAttendeeSelected",payload:{internalAttendee:this.model.internal,externalAttendee:this.model.external,validInternalAttendees:this.getAttendees("internal",this.model),validExternalAttendees:this.getAttendees("external",this.model),totalCount:this.getAttendeeCount()}})},onChangeTopicValues:function(e,t){this.trigger({action:"onChangeTopicValues",payload:e})},onFetchRequestors:function(e,t,n){var i=p.fetch({url:p.ENDPOINTS.mappable_requestors,data:_.assign(e.data,{activity_uuid:"-"===window.selectedActivityUuid?e.data.activity_id:window.selectedActivityUuid,external_request_uuid:U.external_request_uuid})});return i.then(t),i[i.fail?"fail":"catch"](n),i},onSetOffsiteLabel:function(e){this.offsiteLabel=e},onOngoingSalesMeetingDateChanged:function(e){this.model.dateToFetch=e,C.updateCalendar.trigger(this.model)},onMeetingAction:function(e,t,n,i,o){var a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{};o=o||this;var s={url:e,data:f({source_meeting_uuid:U.request.uuid},a)};"put"===t&&(s.type="PUT");var r=p.update(s);r.then(function(e){this.trigger({action:n,payload:e})}.bind(o)),r[r.fail?"fail":"catch"](function(e){var t=e.responseJSON;"undefined"!=typeof jiffle&&(t=e),this.trigger({action:i,payload:t.errors})}.bind(this))},onRedirectPage:function(){this.trigger({action:"redirectPage"})},onBehalfOfMeetingAction:function(e,t,n,i,o,a){var s={url:e};s.type=n,s.data={user_uuid:t,source_meeting_uuid:U.request.uuid},a&&(s.data.declined_comments=a);var r=p.update(s);r.then(function(e){e.onBehalfOf=t,this.trigger({action:i,payload:e})}.bind(this)),r[r.fail?"fail":"catch"](function(e){this.trigger({action:o,payload:e})}.bind(this))},onUpdateAreYouAttending:function(e){this.model.attendingMeetingStatus=e,this.trigger({action:"onYouAreAttending",payload:e})},expertStoreSelection:function(e){e.type},onGetOnBehalfActions:function(e){this.trigger({action:"renderDeclineComments",payload:e});var t=p.fetch({url:p.ENDPOINTS.on_behalf_actions,data:{uuid:e.uuid}});t.then(function(t){e.onBehalfActions=t.data||{},this.trigger({action:"onBehalfActions",payload:t.data}),this.updateAttendees(this.model,t.data)}.bind(this)),t[t.fail?"fail":"catch"](function(){this.trigger({action:"onBehalfActions",payload:{}}),this.updateAttendees(this.model,{})}.bind(this))},onPrepareExtpers:function(e){this.model.internal=this.removeOldExperts(this.model.internal,e.internal),this.model.external=this.removeOldExperts(this.model.external,e.external),this.trigger({action:"onAttendeeSelected",payload:{internalAttendee:this.model.internal,externalAttendee:this.model.external,validInternalAttendees:this.getAttendees("internal",this.model),validExternalAttendees:this.getAttendees("external",this.model),totalCount:this.getAttendeeCount()}})},removeOldExperts:function(e,t){return 0===e.length?[]:_.reject(e,function(e){return!!e.expert&&(void 0===_.find(t,function(t){return t.uuid===e.uuid})||void 0)})},addExperts:function(e,t){var n=_.union(t,e);return n=_.uniq(n,function(e,t,n){return e.uuid})},onResetAttendeesAndRooms:function(){B.topicManagementEnabled&&(B.topicUserMappingEnabled&&(this.model.internal=[],b.resetInternalAttendeeList(),j&&b.resetExternalAttendeeList()),B.topicRoomMappingEnabled&&(this.model.meetingType=v.MeetingStore.getActivity(),this.model.room={uuid:""},g.resetRoomList(B.topicUserMappingEnabled,this.model.external.length)),C.updateCalendar(this.model))},onMeetingTypeChanged:function(e){e.payload?"onRoomChosen"===e.action?(this.model.meetingType=e.payload.type,this.model.room=e.payload.room||{},this.model.room.isBoothTour?this.model.booth_tour_uuid=this.model.room.boothTourUuid||this.getBoothTourUuid(window.selectedActivityUuid):delete this.model.booth_tour_uuid,scheduler.callEvent("onDragEnd"),C.updateCalendar(this.model),this.trigger(e),S.updateSelectedRoom(this.model,e.payload)):"onResetRoomList"===e.action&&(this.model.meetingType=e.payload.type,this.model.room=e.payload.room||{},this.model.room.isBoothTour?this.model.booth_tour_uuid=this.getBoothTourUuid(window.selectedActivityUuid):delete this.model.booth_tour_uuid,this.trigger(e),S.updateSelectedRoom(this.model,e.payload)):"onActivitySettings"===e.type?(this.model.meetingType=e.data,S.setMeetingTypeSettings(e.data.settings),this.activitySettings=e.data.settings,this.updateAttachmentAttributes(this.activitySettings,U.request.attachments)):"selectedAttendeeReset"===e.type?this.trigger({action:"onAttendeeSelected",payload:{internalAttendee:this.model.internal,externalAttendee:this.model.external,validInternalAttendees:this.getAttendees("internal",this.model),validExternalAttendees:this.getAttendees("external",this.model),totalCount:this.getAttendeeCount()}}):"onLocationPreferenceChange"===e.type?(this.model.location_preference=e.data,e.triggerUpdateCalendar&&C.updateCalendar(this.model)):"onSetMstConfig"===e.type&&(this.mstConfigs=e.data)},onEventCreated:function(e,t,n){this.model.event=e,!t&&this.onResetPartialParticipation(),this.trigger({action:"onEventCreated",payload:{event:this.model.event}}),S.updateSelectedTime(this.model)},attendeeStoreSelection:function(e){var t,n,i=e.type,o=e.user,a=e.label,s=!1,r=!0,d=e.callbackFunction,c=e.userCallback,u=e.isNewAttendee,l={type:"",operation:"",isCurrUser:!1,uuid:"",overRided:y.getOverRideRoomcapacityPopup(),isJmmOrAbove:y.isJuniorMMorAbove()};if("canReinviteAttendeesInConsecMeeitngs"===i)s=!0,l.type=e.attendeeType,l.uuid=o.uuid,l.operation="insert",l.isCurrUser=t===B.currentUser.uuid,r=!1;else if("setMeetingHost"===i)s=!0,l.type="internal",l.uuid=o.uuid,l.operation="",l.isCurrUser=t===B.currentUser.uuid,r=!1;else if("setUserPreEndorsement"===i)s=!0,l.type="internal",l.uuid=o.uuid,l.operation="",l.isCurrUser=t===B.currentUser.uuid,r=!1;else if("internalAttendeeSelected"===i){if(s=!0,o){t=o.uuid;var f=_.find(this.model.internal,function(e){return e.uuid===t});f||this.model.internal.push(o),this.model.internal=_.uniq(this.model.internal,function(e){return e.uuid}),!window.mappingEnabled&&u&&this.model.newCreatedUsers.push(t)}l.type="internal",l.uuid=t,l.operation="insert",l.isCurrUser=t===B.currentUser.uuid}else if("externalAttendeeSelected"===i)s=!0,o&&(t=o.uuid,f=_.find(this.model.external,function(e){return e.uuid===t}),this.model.external.push(o),this.model.external=_.uniq(this.model.external,function(e){return e.uuid})),l.uuid=t,l.type="external",l.operation="insert",l.user=o||{};else if("internalAttendeeUnselected"===i)s=!0,t=o&&o.uuid,_.remove(this.model.internal,function(e){return e.uuid===t}),l.type="internal",l.operation="remove",l.uuid=t,l.isCurrUser=t===B.currentUser.uuid;else if("externalAttendeeUnselected"===i){s=!0,t=o&&o.uuid;var m=this.model.external;m=_.remove(m,function(e){return e.uuid===t}),l.type="external",l.uuid=t,l.operation="remove"}else"allExternalAttendeeUnselected"===i?(s=!0,m=this.model.external,_.forEach(o,function(e){_.remove(m,function(t){return t.uuid===e.uuid})}),l.type="external",l.operation="remove"):"editAttendees"===i?(s=!0,r=!e.dontUpdateCalendar,this.model.internal=e.users.internal.slice(),this.model.external=e.users.external.slice(),e.hasCurrUser&&(this.model.attendingMeetingStatus="yes")):"resetInternalAttendeeList"===i&&(s=!1,o&&(this.model.internal.push(o),this.model.internal=_.uniq(this.model.internal,function(e){return e.uuid})),l.type="internal",l.operation="remove",this.trigger({action:"onAttendeeSelected",payload:{internalAttendee:this.model.internal,externalAttendee:this.model.external,validInternalAttendees:this.getAttendees("internal",this.model),validExternalAttendees:this.getAttendees("external",this.model),totalCount:this.model.external.length}}),S.updateSelectedAttendees(this.model,l));n=this.getAttendeeCount(),s&&(this.model.dateToFetch=this.model.dateToFetch||L.getCalendarStartDate(),r&&C.updateCalendar(this.model,c),v.MeetingStore.showAvailableRooms(n),this.trigger({action:"onAttendeeSelected",payload:{internalAttendee:this.model.internal,externalAttendee:this.model.external,validInternalAttendees:this.getAttendees("internal",this.model),validExternalAttendees:this.getAttendees("external",this.model),totalCount:n,meetingHostLabel:a}}),S.updateSelectedAttendees(this.model,l,d))},onAccountOpptySelected:function(e){var t=e.type,n=e.data;"account"===t?(this.model.account.is_changed=!0,this.model.account.acc.id=n.id,this.model.account.acc.name=n.name):"opportunity"===t&&(this.model.account.is_changed=!0,this.model.account.oppty.id=n.id,this.model.account.oppty.name=n.name)},onResetPartialParticipation:function(){_.each(this.model.internal,function(e){e.partial_start_time=undefined,e.partial_end_time=undefined})},onValidateMeeting:function(e,t){var n=this.isValidMeeting();!1===n.error?(e(!0),!0===n.meetingHostAutoAdd&&this.trigger({action:"autoAddMeetingHost",payload:n.userUUID})):t(n.title,n.message)},isAttendeeRequired:function(e,t,n){return(n=n||this.activitySettings)&&"yes"===n[e]&&!this.canRelaxForMMs(n[t])},canRelaxForMMs:function(e){return(B.isCSM()||B.isMeetingManager()||B.isJuniorMM()||B.isQueueManager())&&"yes"===e},isValidMeeting:function(){return this.isValidSpecificMeeting(this.model,this.activitySettings)},isExternalAttendeesHidden:function(e){return e=e||this.activitySettings,!B.isConsecutiveMeeting&&"yes"===e.hide_external_attendees_in_book_meeting},isInternalAttendeesHidden:function(e){return"yes"===(e=e||this.activitySettings).hide_internal_attendees_in_book_meeting},isMeetingTimeValid:function(e,t){var n=e.startDate,i=e.endDate,o=t.minDuration,a=t.maxDuration,s=(i-n)/6e4;return s>=o&&s<=a?{error:!1}:{error:!0,message:window.i18n.t("slot_size_invalid",{min_duration:Y(o),max_duration:Y(a),silentMsg:"meeting"})}},isValidSpecificMeeting:function(e,t){var n,i=this.isAttendeeRequired("internal_attendee_presence","relax_internal_attendee_presence_for_mm",t),o=this.isAttendeeRequired("atleast_one_attendee_role_presence","relax_atleast_one_attendee_role_presence_for_mm",t),a=this.isAttendeeRequired("external_attendee_presence","relax_external_attendee_presence_for_mm",t),s="yes"===t.atleast_one_meeting_host&&"yes"===t.enable_meeting_host,r=this.mstConfigs.enabled,d=U.request,c=r&&"on_site"===e.location_preference&&"approved"!==d.status;if(e.event){var u=window.scheduler.config,l=u.minimum_duration,f=u.maximum_duration,m=e.event,h=m.start_date,p=m.end_date,g=this.isMeetingTimeValid({startDate:h,endDate:p},{minDuration:l,maxDuration:f});if(g.error)return g}if(window.envDetails.isConsecutiveMeeting&&"-"===e.meetingType.uuid)return{error:!0,message:i18n.t("select_meeting_type_to_continue"),title:i18n.t("select_meeting_type_to_continue_title")};if(null===e.attendingMeetingStatus)return{error:!0,message:n=i18n.t("select_if_attending_to_continue"),title:i18n.t("select_if_attending_to_continue_title")};if(null===e.event)return{error:!0,message:n=c?i18n.t("select_timeslot_to_continue"):i18n.t("time_and_room_validation_message",{type:i18n.t("meeting_custom_label")})};if(!1===c&&!e.room.isBoothTour&&(""===e.room.uuid||e.room.uuid===undefined)^e.room.address!==undefined)return{error:!0,message:n=i18n.t("time_and_room_validation_message",{type:i18n.t("meeting_custom_label")})};if(!this.isInternalAttendeesHidden(t)&&i&&0===this.getAttendees("internal",e).length)return{error:!0,message:n=i18n.t("select_min_internal_attendee_to_continue",{company_name:B.companyName}),title:i18n.t("meeting_notify_failure_title")};if(!this.isInternalAttendeesHidden(t)&&o&&0===this.getAttendeesRole("internal",e).length)return{error:!0,message:n=i18n.t("select_min_internal_attendee_role_to_continue"),title:i18n.t("meeting_notify_failure_title")};if(!window.isEBCEvent&&!1===this.isExternalAttendeesHidden(t)&&a&&0===this.getAttendees("external",e).length)return{error:!0,message:n=i18n.t("select_min_external_attendee_to_continue"),title:i18n.t("meeting_notify_failure_title")};if("undefined"!=typeof jiffle&&!window.isLeadsMeeting&&""===e.account.acc.id)return n=i18n.t("sfdc_account_not_selected"),{error:!1,confirmation:!0,title:i18n.t("meeting_notify_failure_title"),message:n};if("undefined"!=typeof jiffle&&window.isLeadsMeeting&&0===this.getAttendees("external",e).length)return{error:!0,message:n=i18n.t("lead_not_selected"),title:i18n.t("meeting_notify_failure_title")};if(!this.isInternalAttendeesHidden(t)&&s&&0===this.getMeetingHostCount(e.internal)){var v=this.getAttendees("internal",e);return 1!==v.length||!0===y.canAttendeeBeAssignedHost(_.first(v).uuid).error?{error:!0,message:i18n.t("atleast_one_meeting_host_message",{label:t.meeting_host_label}),title:i18n.t("atleast_one_meeting_host_title",{label:t.meeting_host_label})}:{error:!1,meetingHostAutoAdd:!0,userUUID:_.first(v).uuid,message:i18n.t("auto_add_meeting_host",{label:t.meeting_host_label,attendee_name:this.getName(_.first(v))}),title:i18n.t("are_you_sure")}}return{error:!1}},getName:function(e){return e.user_name?e.user_name:e.first_name},getMeetingHostCount:function(e){return _.filter(e,{meeting_host:!0}).length},getAttendees:function(e,t){return(t=t||this.model)[e]},getAttendeesRole:function(e,t){return t=t||this.model,_.filter(this.model[e],function(e){return e.role&&"Attendee"===e.role})},getAttendeeCount:function(){var e=y.filterNonDeclinedAttendees(this.getAttendees("internal",this.model)),t=y.filterNonDeclinedAttendees(this.getAttendees("external",this.model)),n=x.getAttendeesForAgenda(v.MeetingStore.getCurrentAgendaUUID());return _.uniq([].concat(m(e),m(t),m(n)),"uuid").length},onShowHideRequestorsDropdown:function(e){this.trigger({action:"showHideRequestorsDropdown",payload:e?"yes":"no"})},createSingleMeeting:function(e,t,n){var i=this.model.internal.map(function(e){return e.uuid});i=i.concat(this.model.external.map(function(e){return e.uuid}));var o=this.getUserEntities(this.model),a=e.meeting_with;delete e.meeting_with;var s=e.topic_management,r={activity_uuid:this.model.meetingType?this.model.meetingType.uuid:window.selectedActivityUuid,meeting_with:a,start_time:I.jsDateToDateTimeFormat(this.model.event.start_date),end_time:I.jsDateToDateTimeFormat(this.model.event.end_date),users:i,user_preferences:o.userPreferences,user_participation:o.partialParticipation,location_preference:this.model.location_preference,custom_fields:e,requestor:t,quick_meeting:n,topic_uuid:s,booth_tour_meeting:this.model.room.isBoothTour,external_request:U.request.isExternalRequest,external_request_uuid:U.external_request_uuid,meeting_uuid:B.currentMeetingUuid||null};this.model.room.isBoothTour?r.booth_tour_uuid=this.getBoothTourUuid(window.selectedActivityUuid):this.model.room.address!==undefined?(r.offsite_location_name=this.model.room.name,r.offsite_location_address=this.model.room.address):r.room_uuid=this.model.room.uuid,O.addMeetingRequestParams(r,this.model);var d={meeting_request:_.assign(r,this.getAttachments(),{integrations:this.model.integrations})};if("undefined"!=typeof window.briefing_uuid&&(d.briefing_uuid=window.briefing_uuid),void 0!==s&&(d.topic_uuid=s),"undefined"!=typeof window.bam_uuid&&(d.bam_uuid=window.bam_uuid),F&&this.setTimeZoneInfo(d),window.envDetails.setBlockToken(d),!this.isMeetingUpdateInProgress){P.attr("disabled",!0),q.attr("disabled",!0);var c=p.update({url:p.ENDPOINTS.meeting_create,global:!0,data:d});this.isMeetingUpdateInProgress=!0,c.then(function(e){this.isMeetingUpdateInProgress=!1,this.trigger({action:"onEventSaved",payload:e})}.bind(this)),c[c.fail?"fail":"catch"](function(e){P.attr("disabled",!1),q.attr("disabled",!1),this.isMeetingUpdateInProgress=!1;var t=e.responseJSON;"undefined"!=typeof jiffle&&(t=e),this.trigger({action:"onEventSaveFailed",payload:t})}.bind(this))}},setTimeZoneInfo:function(e){var t=H.getTimeZone();e.time_zone=t.timeZoneId,e.time_zone_city=t.timeZoneCity,e.time_zone_offset=t.timeZoneDisplayName},filterDeclined:function(e){return _.partition(e,function(e){return!e.invite_status||"declined"!==e.invite_status})},onCheckDoubleBookedStatus:function(e,t){if(!t){var n=this.model.internal.map(function(e){return e.uuid});n=n.concat(this.model.external.map(function(e){return e.uuid}));t={start_time:moment(this.model.event.start_date).format("YYYY-MM-DD HH:mm a"),end_time:moment(this.model.event.end_date).format("YYYY-MM-DD HH:mm a"),users:n,meeting_uuid:U.request.uuid||""},"OngoingSales"===B.eventType&&(t.time_zone=H.getTimeZoneId())}var i=p.update({url:p.ENDPOINTS.double_booked_resources,global:!1,data:t});i.then(function(n){(n=n||{}).callbackFn=e,_.merge(n.data,t),this.trigger({action:"onCheckDoubleBookedStatusSuccess",payload:n})}.bind(this)),i[i.fail?"fail":"catch"](function(t){(t=t||{}).callbackFn=e,this.trigger({action:"onCheckDoubleBookedStatusFailed",payload:t})}.bind(this))},onUpdateMeetingPartially:function(e,t,n){var i={meeting_with:e.meeting_with,custom_fields:e,requestor:t},o=e.topic_management,a={meeting_request:Object.assign(i,this.getAttachments(),{integrations:this.model.integrations}),meeting_uuid:U.request.uuid};void 0!==o&&(a.topic_uuid=o),void 0!==n&&(a.send_ics=n);var s=p.update({url:p.ENDPOINTS.partial_meeting_update,data:a});s.then(function(e){this.trigger({action:"onEventRescheduled",payload:e})}.bind(this)),s[s.fail?"fail":"catch"](function(e){P.attr("disabled",!1),q.attr("disabled",!1),this.trigger({action:"onEventSaveFailed",payload:e})}.bind(this))},rescheduleSingleMeeting:function(e,t,n){var i=this.filterDeclined(this.model.internal),o=this.filterDeclined(this.model.external),a=_.pluck(i[0],"uuid"),s=this.getUserEntities(this.model);a=a.concat(_.pluck(o[0],"uuid"));var r=_.pluck(i[1],"uuid");r=r.concat(_.pluck(o[1],"uuid"));var d=e.meeting_with;delete e.meeting_with;var c=e.topic_management,u={activity_uuid:this.model.meetingType?this.model.meetingType.uuid:window.selectedActivityUuid,meeting_with:d,start_time:I.jsDateToDateTimeFormat(this.model.event.start_date),end_time:I.jsDateToDateTimeFormat(this.model.event.end_date),users:a,location_preference:this.model.location_preference,declined_attendees:r,custom_fields:e,requestor:t,meeting_uuid:U.request.uuid,user_preferences:s.userPreferences,user_participation:s.partialParticipation,booth_tour_meeting:this.model.room.isBoothTour,topic_uuid:c};this.model.room.isBoothTour?u.booth_tour_uuid=this.getBoothTourUuid(window.selectedActivityUuid):this.model.room.address!==undefined?(u.offsite_location_name=this.model.room.name,u.offsite_location_address=this.model.room.address):u.room_uuid=this.model.room.uuid,O.addMeetingRequestParams(u,this.model);var l={meeting_request:_.assign(u,this.getAttachments(),{integrations:this.model.integrations}),meeting_uuid:U.request.uuid};"undefined"!=typeof window.briefing_uuid&&(l.briefing_uuid=window.briefing_uuid),void 0!==c&&(l.topic_uuid=c),F&&this.setTimeZoneInfo(l),void 0!==n&&(l.send_ics=n),window.envDetails.setBlockToken(l),P.attr("disabled",!0),q.attr("disabled",!0);var f=p.update({url:p.ENDPOINTS.reschedule_meeting,data:l,global:!0});f.then(function(e){this.trigger({action:"onEventRescheduled",payload:e})}.bind(this)),f[f.fail?"fail":"catch"](function(e){P.attr("disabled",!1),q.attr("disabled",!1),this.trigger({action:"onEventSaveFailed",payload:e})}.bind(this))},getInternalAttendees:function(){return this.model.internal},getExternalAttendees:function(){return this.model.external},onGetApprovalToSendIcs:function(e){this.trigger({action:"getApprovalToSendIcs",payload:{callbackFn:e}})},onTriggerSurveyMails:function(e,t,n){var i={survey_uuid:n};""!==e&&(i.attendee_uuid=e);var o=p.update({type:"PUT",data:i,url:p.ENDPOINTS.send_survey_meeting_mail.replace("{UUID}",t)});o.then(function(e){this.trigger({action:"surveyMailsTriggered",payload:e})}.bind(this)),o[o.fail?"fail":"catch"](function(e){})},setTopicDirty:function(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0];this.topicDirtyFlag=e},isTopicDirty:function(){return this.topicDirtyFlag},onUpdateIntegrationData:function(e){this.model.integrations[e.type]=e.payload},getIntegrationData:function(){return this.model.integrations},setCustomFormLabels:function(e,t){this.customFormLabels[e]=t},getCustomFormLabels:function(e,t){return this.customFormLabels},onFetchCustomLabels:function(){var e=this;p.fetch({url:p.ENDPOINTS.custom_labels}).then(function(t){e.trigger({action:"fetchCustomLabelsSuccess",payload:t.data})})},onTopicChangeRefeshAttendeesAndRoomsList:function(){this.removeNonSelectedNewUsers(),this.resetNonRetainedResources(),B.topicUserMappingEnabled&&b.resetAndFetchInternalAttendees(),B.topicRoomMappingEnabled&&g.getAllMeetingTypes({isFirstLoad:!0,byPassMasCalEntry:!0}),C.updateCalendar(this.model)},removeNonSelectedNewUsers:function(){var e=this.model.internal.map(function(e){return e.uuid});this.model.newCreatedUsers=this.model.newCreatedUsers.filter(function(t){return e.includes(t)})},onCheckNonRetainedResources:function(e){var t=this;this.resetNonRetainedResources();var n=this.getResourcesToBeCheckedForRetention(),i=n.users,o=n.rooms;if(0!==i.length||o[0]){var a={resources:{users:i,rooms:o},resource_attributes:["mapped_to_topic"],dependant_attributes:{topic_uuid:e.topic}};p.fetch({url:p.ENDPOINTS.fetch_resource_data,data:a}).then(function(n){var i=n.data&&n.data.resources||{},o=i.users,a=i.rooms;o=t.getNonRetainedUsers(o),a=t.getNonRetainedRooms(a),t.trigger({action:"checkNonRetainedResourcesSuccess",payload:{users:o,rooms:a,topic:e.topic}})})}else this.trigger({action:"checkNonRetainedResourcesSuccess",payload:{users:i,rooms:o,topic:e.topic}})},onTopicChangeRetainResources:function(){this.retainNewCreatedUsersOnTopicChange(),this.retainUsersOnTopicChange(),this.retainRoomsOnTopicChange(),C.updateCalendar(this.model)},resetNonRetainedResources:function(){this.resetNonRetainedUsers(),this.resetNonRetainedRooms()},resetNonRetainedUsers:function(){this.nonRetainedResources.users=[]},resetNonRetainedRooms:function(){this.nonRetainedResources.rooms=[]},getResourcesToBeCheckedForRetention:function(){var e=v.MeetingStore.getActivitySettings();return{users:this.getUsersToBeCheckedForRetention(e),rooms:this.getRoomsToBeCheckedForRetention(e)}},getUsersToBeCheckedForRetention:function(e){var t=[];return B.topicUserMappingEnabled&&!this.canUnmappedUsersBeShown(e)&&(t=this.model.internal.filter(this.removeCurrentUser).map(function(e){return e.uuid})),t},getRoomsToBeCheckedForRetention:function(e){var t=[];return B.topicRoomMappingEnabled&&!this.canUnmappedRoomsBeShown(e)&&(t=[this.model.room.uuid]),t},canUnmappedUsersBeShown:function(e){return e&&e.show_unmapped_users_for_topic.toBoolean()},canUnmappedRoomsBeShown:function(e){return e&&e.show_unmapped_rooms_for_topic.toBoolean()},removeCurrentUser:function(e){return e.uuid!==B.currentUser.uuid},getNonRetainedUsers:function(e){return(e||[]).filter(this.notMappedToTopic).map(this.setNonRetainedUsersAndGetAttendeeInfo)},getNonRetainedRooms:function(e){return(e||[]).filter(this.notMappedToTopic).map(this.setNonRetainedRoomsAndGetRoomInfo)},notMappedToTopic:function(e){return!e.mapped_to_topic},setNonRetainedUsersAndGetAttendeeInfo:function(e){return this.setNonRetainedUsers(e),this.getAttendeeInfo(e)},setNonRetainedRoomsAndGetRoomInfo:function(e){return this.setNonRetainedRooms(e),this.getRoomInfo(e)},setNonRetainedUsers:function(e){this.nonRetainedResources.users.push(e.uuid)},setNonRetainedRooms:function(e){this.nonRetainedResources.rooms.push(e.uuid)},getAttendeeInfo:function(e){return y.getAttendeeDetails(e.uuid).user_name},getRoomInfo:function(e){var t=v.MeetingStore.getPreSelectedRoom(e.uuid),n=""+t.name;return t.location&&(n+=", "+t.location),n},retainNewCreatedUsersOnTopicChange:function(){B.topicUserMappingEnabled&&(this.model.newCreatedUsers=this.model.newCreatedUsers.filter(this.removeNonRetainedUsers))},retainUsersOnTopicChange:function(){B.topicUserMappingEnabled&&(this.model.internal=this.model.internal.filter(this.removeNonRetainedUsers),b.resetInternalAttendeeList(this.nonRetainedResources.users.slice(),!0),this.resetNonRetainedUsers())},removeNonRetainedUsers:function(e){var t="object"===(void 0===e?"undefined":l(e))?e.uuid:e;return-1===this.nonRetainedResources.users.indexOf(t)},retainRoomsOnTopicChange:function(){B.topicRoomMappingEnabled&&(this.model.room.uuid&&0!==this.nonRetainedResources.rooms.length?(this.model.meetingType=v.MeetingStore.getActivity(),this.model.room={uuid:""},g.resetRoomList(B.topicUserMappingEnabled,this.model.internal.length+this.model.external.length)):g.getAllMeetingTypes({isFirstLoad:!0,byPassMasCalEntry:!0}),this.resetNonRetainedRooms())},getOnDemandFirstPageLoaded:function(){return this.onDemandFirstPageLoaded},setOnDemandFirstPageLoaded:function(e){this.onDemandFirstPageLoaded=e},getIsMascalOrigin:function(){return this.isMascalOrigin},setModelData:function(e,t){return this.model[e]=t,this.model}});t.exports=J}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingInMaking/store.js","/app/scripts/Book/MeetingInMaking")},{"../../PartialParticipation/store":77,"../../Sfdc/SfdcAccount/store":83,"../../Sfdc/commons":86,"../../commons/date_format":96,"../../commons/granular_edit":97,"../Attendee/actions":8,"../Attendee/store":10,"../BriefingRequest/store":12,"../Calendar/actions":13,"../Calendar/store":15,"../CommonStore":19,"../ConsecutiveMeetings/actions":20,"../Expert/store":38,"../MeetingType/actions":48,"../MeetingType/store":50,"../OngoingSales/actions":52,"../OngoingSales/store":54,"./actions":42,"./attachment_store":43,"./booth_tour_store":44,_process:114,buffer:112,common_api:"common_api"}],48:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["getAllMeetingTypes","meetingTypeChosen","roomChosen","offsiteChosen","boothTourChosen","eventBarCreated","editRoom","searchRoom","attendeeCountChanged","updateFilter","applyFilter","resetFilter","resetRoomList","fetchActivitySettings","initiateNewMeeting","setBookMeetingInstructions","locationPreferenceChange","setMstConfigs","nonJmmRoomChosen"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingType/actions.js","/app/scripts/Book/MeetingType")},{_process:114,buffer:112}],49:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},f=e("./actions"),m=e("./store"),h=e("../Attendee/actions"),p=e("../MeetingInMaking/actions"),g=e("../MeetingInMaking/store"),v=e("../MeetingInMaking/handler"),y=e("../Calendar/handler"),b=e("../Expert/actions"),w=e("../Attendee/store").AttendeeStore,M=e("../BriefingRequest/store").BriefingRequestStore,C=e("../../commons/book/MeetingInMaking/handler"),S=function(){var e=$("#js-instructions-display"),t=m.MeetingStore,n=window.ReactMessage||$(".notification-modal"),i=$(".notification-modal"),o=null,a=null,s=null,r=!1,d=!1,c=!1,u=!1,S=!1,A="",x=!0,D="offsites",k="BoothTour",T=$("#attendee-label").closest(".header-right"),E=i18n.t("offsite"),I=i18n.t("booth_tour_header"),R=i18n.t("booth_tour_label"),O=i18n.t("booth_tour_name"),P="",q=".js_check_room",N=$("#roomsTabList"),B=$("#mappedTab"),U=$("#mappedroom"),F=$(".room-list",U),j=$(".js_selected_room",U),H=$("#boothTour",U),Y=$("#nonJmmRoom",U),L=$("#othersTab"),J=$("#otherroom"),V=$(".meeting-list",J),W=$(".room-list",J),z=$("#offsiteTab"),Z=$("#offsite"),G=$(".meeting-list",Z),Q=$(".js-offsite-location",Z),K=$(".mst-offsite-check",Z),X=$(".mst-selected-offsite",Z),ee=$(".mst-selected-offsite .room-selected-icon",K),te=$(N,'a[data-toggle="tab"]'),ne={onGetAllMeetingTypes:function(e){if(function(e){var t=window.envDetails.isCSM()||window.envDetails.isMeetingManager()||window.envDetails.isJuniorMM();e.data&&e.data.activity&&"no"===e.data.activity.settings.can_edit_approved_meeting&&!t&&"approved"===g.model.status&&(v.setEnableEdit(!1),g.renderTimeRoomAttendee())}(e),re()?(Xe(J),Xe(J)):(Ke(L),Ke(J)),Xe(N),Xe(Z),e.isCapicityFilter)return be(!0,e.lastAttendeeUuid,e.groupData),void ce();var l=e.data.activity.rooms||[],m=e.data.activity.other_rooms||[];if(200===e.status||e.success){var h=e.data.manual_scheduling_configs;if(_.isEmpty(t.getMstConfigs())&&f.setMstConfigs.trigger(h),e.first_load){var y;setTimeout(function(){scheduler.updateView()},100),be(null,null,e.groupData,h),ve();window.meetingInfo.booth_tour_label||i18n.t("booth_tour");if("new"===window.mode)if(e.byPassMasCalEntry)o&&fe();else if(!1===_.isEmpty(window.meetingInfo.request.room)){var b=$.urlParam("entityType"),C=$.urlParam("copy_meeting");C?ue(window.meetingInfo.request.room):b&&b===D?(de(h,"off_site"),Te()):b&&b===k?qe(meetingInfo.request.room.uuid):(y=t.getPreSelectedRoom(window.meetingInfo.request.room.uuid),o=y,window.briefing_uuid&&o?function(e){var t=M.briefingAttendeesCount,n=e.uuid,o=e.capacity,a=window.envDetails.isConsecutiveMeeting;if(e&&xe(n),De(),!a&&f.editRoom(e),t>o){var s=!1;i.notificationModal({type:"confirmation","class":"yellow",title:i18n.t("override_room_capacity_header"),body:i18n.t("override_room_capacity_body"),done:function(){s=!0},dismiss:function(){s?w.persistOverRideRoomPopup(s):Ze()}})}}(o):(de(h,"on_site"),o&&xe(o.uuid),De(),window.envDetails.isConsecutiveMeeting||f.editRoom(o)))}else ce();else if("edit"===window.mode)if(g.isTopicDirty())o&&fe();else{var S=window.meetingInfo.request.room||o||{};ue(S)}}else e.isNewEvent&&(j.empty(),V.empty(),be(null,null,e.groupData,h),ce());scheduler.config.booth_tour_enabled=e.configs.booth_tour_enabled,le()&&p.getBoothTourLocationUuids(),scheduler.config.offsite_enabled=e.configs.offsite_enabled,scheduler.config.can_book_offsite=e.configs.can_book_offsite,scheduler.config.can_book_booth_tour=e.configs.can_book_booth_tour,scheduler.config.can_book_room=e.configs.can_book_room,ge(),v.setAddOffsiteLabel(E),A&&function(e,t,n){var i=e.parentSelector,o=e.selectedRoomType,a=n.offsite_enabled,s=n.can_book_offsite,r="offsiteLocation"===o&&a&&s,d="otherRooms"===o&&t.length;if(r||d)return void $(i+" a").tab("show");$("#mappedTab a").tab("show")}(A,m,scheduler.config),function(e,n){n.enabled?(!function(e,n){"off_site"===t.locationPreference&&(d=!0),scheduler.config.offsite_enabled?c?me():null===a&&he():(me(),_e());scheduler.config.booth_tour_enabled?u?Ke(H):null===s&&Xe(H):Ke(H);e.length?(Me()&&Ke(Y),Xe(B),Xe(F),me()):Me()||r?(Ke(Y),Xe(B),Xe(F)):Xe(Y);"edit"===window.mode?(me(),_e(),Ke(H),Ke(Y),K.addClass("hide"),"on_site"===window.meetingInfo.request.location_preference?Me()?(o?xe(o.uuid):(Xe(j),Xe(V),oe(U),oe(B)),De()):Ne():"off_site"===window.meetingInfo.request.location_preference?(Xe(z),Xe(Z),pe(),Ke(B),Ke(U)):"booth_tour"===window.meetingInfo.request.location_preference&&(Ke(F),pe())):"off_site"===t.locationPreference?($('a[href="#offsite"]').tab("show"),Fe(t.isOffsiteSelected||d)):"booth_tour"===t.locationPreference?(me(),qe()):"on_site"===t.locationPreference&&(me(),Ke(Y),Me()||Ne())}(e),x&&(!Me()&&B.find("a").text(i18n.t("mst_on_site")),$(".meeting-type-section .section-title").text(i18n.t("mst_preferred_location"))),x=!1):function(e){scheduler.config.offsite_enabled?scheduler.config.can_book_offsite?(c?(me(),Te()):null===a&&(he(),scheduler.config.can_book_room&&e.length||scheduler.config.can_book_booth_tour||(Ke(B),Te())),Xe(B),Xe(F)):(me(),_e(),(window.scheduler.config.can_book_room||window.scheduler.config.can_book_booth_tour)&&(Xe(F),Xe(B)),a&&Ye()):(me(),_e());scheduler.config.booth_tour_enabled?scheduler.config.can_book_booth_tour?(u?Ke(H):null===s&&Xe(H),e.length?scheduler.config.can_book_room&&Xe(F):Ke(F)):(scheduler.config.can_book_room&&Xe(F),Ke(H),s&&Le()):Ke(H);K.addClass("hide")}(e)}(l,h),scheduler.updateView()}else if(e.errors){var T=_.flatten(_.values(e.errors));n.notificationModal({timeout:!0,"class":"red",body:T.join(", "),title:i18n.t("room_information_title")})}},overRidedRoomcapacity:function(e){if(w.getOverRideRoomcapacityPopup())return void m.MeetingStore.chooseRoomForOverRideCapacity(e);var t=!1;i.notificationModal({type:"confirmation","class":"yellow",title:i18n.t("override_room_capacity_header"),body:i18n.t("override_room_capacity_body"),done:function(){t=!0},dismiss:function(){t?(m.MeetingStore.chooseRoomForOverRideCapacity(e),w.persistOverRideRoomPopup(t)):Ze()}})},onResetRoomList:function(){Se(),o=null,a=null,s=null,u=!1,c=!1,f.getAllMeetingTypes({isFirstLoad:!0,byPassMasCalEntry:!0})},initiateNewMeeting:function(t){if(et===t.uuid)return;et=t.uuid,o=null,a=null,s=null,S=!1,t.room&&(t.room.isBoothTour?(s={name:t.room.name,address:t.room.address,isBoothTour:!0},c=!1,u=!0):t.room.offsite?(a={name:t.room.offsite_name,address:t.room.offsite_address,offsite_location_address:t.room.offsite_address,offsite:!0},c=!0,u=!1):(o={uuid:t.room.uuid},c=!1,u=!1));Se(),e.html(""),f.fetchActivitySettings(),f.getAllMeetingTypes({isFirstLoad:!0,isNewEvent:!0,showInstructions:!0})},setBookMeetingInstructions:function(t){t.book_meeting_instructions_header=t.book_meeting_instructions_header||i18n.t("instructions");var n=t.instruction_book_meeting,i=t.book_meeting_instructions_body,o=i===undefined?"":i;if("yes"===n&&o.trim()){var a=HandlebarsTemplates["book/book_meeting_instructions"];e.html(a({configs:t,isConsecutiveMeeting:window.envDetails.isConsecutiveMeeting})),e.find("input[type=checkbox]").prop("checked","edit"!==window.mode)}}},ie={setHiddenExpertsCount:function(e){m.MeetingStore.setHiddenExpertsCount(e)}};function oe(e){e.addClass("active")}function ae(){o?Ge():a?ze():s&&Ve()}function se(){d?(K.hasClass("hide")&&K.removeClass("hide"),He()):r&&Je()}function re(){return!("undefined"!=typeof jiffle)&&!window.mappingEnabled&&Me()}function de(e,t){e.enabled&&f.locationPreferenceChange.trigger(t)}function ce(){var e=t.getMstConfigs().enabled;o?(xe(o.uuid),De()):a?(Be(),Te()):s?(Ue(),ke()):r?Ne():e&&d&&Te()}function ue(e){var n=e;window.meetingInfo.request.room&&"BoothTour"===window.meetingInfo.request.room.type&&(s={name:window.meetingInfo.request.room.name,address:window.meetingInfo.request.room.location,isBoothTour:!0,boothTourUuid:window.meetingInfo.request.room.uuid},n={}),n.uuid?function(e){xe((o=e).uuid),De(),t.isBoothTourSelected=!1,t.isOffsiteSelected=!1,window.envDetails.isConsecutiveMeeting||f.editRoom(o)}(n):(_.assign(n,a),n.offsite_location_address!==undefined||n.offsite?function(e){a={name:e.offsite_location_name||e.name,address:e.address||e.offsite_location_address||e.location},Be(),Te(),c=!0,t.isBoothTourSelected=!1,t.isOffsiteSelected=!0,window.envDetails.isConsecutiveMeeting||f.offsiteChosen(a)}(n):(_.assign(n,s),n.isBoothTour&&function(e){s={name:O,address:e.address||e.boothTourAddress||P,isBoothTour:!0,booth_tour_display_name:R,boothTourUuid:e.boothTourUuid},Ue(),ke(),u=!0,t.isBoothTourSelected=!0,t.isOffsiteSelected=!1,window.envDetails.isConsecutiveMeeting||f.boothTourChosen(s)}(n)))}var le=function(){return(window.envDetails.isConsecutiveMeeting||window.scheduler.config.booth_tour_enabled)&&!1===g.isBoothTourConfigsFetched};function fe(){j.empty(),V.empty(),xe(o.uuid),De()}function me(){Ke(Q)}function he(){Xe(Q),Xe(z),Xe(Z)}function _e(){Ke(z),Ke(Z)}function pe(){Ke(L),Ke(J)}function ge(){if(!a&&!o&&!s)if(window.isEBCEvent)$("#room-label").html(i18n.t("briefing_center"));else{var e=[];scheduler.config.can_book_room&&e.push(i18n.t("room")),scheduler.config.offsite_enabled&&scheduler.config.can_book_offsite&&e.push(E),scheduler.config.booth_tour_enabled&&scheduler.config.can_book_booth_tour&&e.push(R),$("#room-label").text(e.join(", "))}}function ve(){var e,n,i,o,a,s,r,d,c,u,l,f,m=t.getActivitySettings();_.forEach(m,function(t,m){switch(m){case"minimum_timeslot":s=Number(t)||0;break;case"min_duration":r=Number(t)||0;break;case"max_duration":d=Number(t)||30;break;case"time_slot":e=Number(t)||0;break;case"offsite_enabled":o="yes"===t;break;case"offsite_min_duration":c=Number(t)||0;break;case"offsite_max_duration":u=Number(t)||30;break;case"show_all_requestors":S="yes"===t;break;case"duration_restrictions_for_mm":n="no"===t;break;case"offsite_duration_restrictions_for_mm":i="no"===t;break;case"offsite_label":E=t||E;break;case"booth_tour_enabled":a="yes"===t;break;case"booth_tour_label":R=t||i18n.t("booth_tour_label");break;case"booth_tour_header":I=t||i18n.t("booth_tour_header");break;case"booth_tour_max_duration":l=Number(t)||0;break;case"booth_tour_min_duration":f=Number(t)||0;break;case"booth_tour_default_name":O=t||O;break;case"booth_tour_default_location":P=t||P}}),scheduler.config.room_mm_override=n,scheduler.config.offsite_mm_override=i&&o,scheduler.config.booth_tour_mm_override=a,(n||scheduler.config.offsite_mm_override||scheduler.config.booth_tour_mm_override)&&(window.envDetails.isMeetingManager()||window.envDetails.isCSM()||window.envDetails.isJuniorMM())?(scheduler.config.maximum_duration=1440,scheduler.config.minimum_duration=e,scheduler.config.meetingMaximumDuration=n?1440:d,scheduler.config.meetingMinimumDuration=n?window.mappingEnabled?s:e:r,scheduler.config.offsiteMaximumDuration=i?1440:u,scheduler.config.offsiteMinimumDuration=i?e:c,scheduler.config.boothTourMaximumDuration=a?1440:l,scheduler.config.boothTourMinimumDuration=a?e:f,scheduler.config.event_duration=e,scheduler.config.mm_override=!0):(scheduler.config.maximum_duration=d,scheduler.config.minimum_duration=r,scheduler.config.meetingMaximumDuration=d,scheduler.config.meetingMinimumDuration=r,scheduler.config.offsiteMaximumDuration=u,scheduler.config.offsiteMinimumDuration=c,scheduler.config.boothTourMaximumDuration=l,scheduler.config.boothTourMinimumDuration=f,scheduler.config.event_duration=r,scheduler.config.mm_override=!1),scheduler.config.time_step=e,p.setOffsiteLabel(E),S=S||window.envDetails.isMeetingManager()||window.envDetails.isCSM()||window.envDetails.isJuniorMM()||window.envDetails.isQueueManager(),p.showHideRequestorsDropdown(S),v.setAddOffsiteLabel(E),v.setBoothTourLabels(I,R,O,P),ye(O,P)}var ye=function(e,t){$("#boothTourName").text(e),$("#boothTourAddress").text(t)};function be(e,n,i,a){var s=t.getActivityRooms()||[];s&&0===s.length&&o&&j.find(".room-selected[data-uuid='"+o.uuid+"']").length&&(j.empty(),Ie(o.uuid),o=null),s=we(s),F.html(Ce(s,i,a)),re()&&((s=t.getActivityOthersRooms()||[])&&0===s.length&&o&&V.find(".room-selected[data-uuid='"+o.uuid+"']").length&&(V.empty(),Ie(o.uuid),o=null),(s=we(s)).length?(Xe(L),Xe(B),W.html(Ce(s,i,a))):Ke(L)),e||We()}function we(e){return e=_.filter(e,function(e){var n=Me()||e.capacity>=t.attendeeCount;return o&&o.uuid===e.uuid?e.hide="hide":e.hide="",n})}function Me(){return window.envDetails.isCSM()||window.envDetails.isMeetingManager()||window.envDetails.isJuniorMM()}function Ce(e,t,n){var i=(n||{}).enabled,o=i!==undefined&&i&&!Me()?i18n.t("location_will_assign_by_mm"):"";if(t){var a=[],s=[],r=_.groupBy(e,"mapped_topic");return _.forEach(r,function(e,t){"true"===t?a=a.concat(e):s=s.concat(e)}),HandlebarsTemplates["book/room_item"]({mapped_rooms:a,unmapped_rooms:s,show_mapped_header:a.length,show_unmapped_header:s.length,hasRooms:e.length>0,showRoomAssignMessage:o,roomAssignMessage:o})}return HandlebarsTemplates["book/room_item"]({mapped_rooms:[],unmapped_rooms:e,show_mapped_header:!1,show_unmapped_header:!1,hasRooms:e.length>0,showRoomAssignMessage:o,roomAssignMessage:o})}function Se(){F.html(""),j.html(""),W.html(""),V.html(""),G.html("")}function Ae(){var e=window.meetingInfo.request;return"edit"===e.mode&&!1===e.can_change_room}function xe(e){var n,i=t.getSpecificRoom(e),a=t.getOthersRoom(e);return i?(i.read_only=Ae(),n=HandlebarsTemplates["book/selected_room_done"](i),j.html(n),Ee(e),Xe(j),o=i,i):a?(a.read_only=Ae(),n=HandlebarsTemplates["book/selected_room_done"](a),V.html(n),Ee(e),Xe(V),o=a,a):(We(),void(o=null))}function De(){if(o){var e=t.getSpecificRoom(o.uuid),n=t.getOthersRoom(o.uuid);e?ke():n&&re()&&$('a[href="#otherroom"]').tab("show")}}function ke(){$('a[href="#mappedroom"]').tab("show")}function Te(){z.removeClass("hide"),$('a[href="#offsite"]').tab("show")}function Ee(e){$('.room-select-item[data-uuid="'+e+'"]').addClass("hide")}function Ie(e){$('.room-select-item[data-uuid="'+e+'"]').removeClass("hide")}function Re(e){e.preventDefault(),ae(),se(),de(t.getMstConfigs(),"on_site"),y.setSetByDefualt(!1),T.removeClass("hide"),xe($(this).data("uuid")),f.roomChosen(o),w.resetOverRideRoomNonMMcapacityPopup(!1),window.mappingEnabled&&b.fetchExperts({callback:function(){h.resetAllAttendees()}})}function $e(e){e.preventDefault(),e.stopPropagation();var n=$("form",Q),i=$("#name",n).attr("name","offsiteName"),o=$("#address",n).attr("name","offsiteAddress");n.validate(),y.setSetByDefualt(!1),n.valid()&&(ae(),a={name:i.val(),address:o.val()},c=!0,de(t.getMstConfigs(),"off_site"),Be(),function(){(t.getActivityRooms()||[]).length?Xe(F):!Me()&&Ke(F);!function(e){$("input, textarea",e).val(""),Ke(e);var t=e.find("form").validate();t.resetForm(),t.reset(),$(".form-group",e).removeClass("has-error"),$(".help-block:not(.form-builder-help-block)",e).show(),scheduler.config.booth_tour_enabled&&scheduler.config.can_book_booth_tour&&!s&&Xe(H)}(Q)}(),f.offsiteChosen(a),w.resetOverRideRoomNonMMcapacityPopup(!1),T.removeClass("hide"),K.addClass("hide"))}var Oe=function(e){e&&e.preventDefault(),e&&e.stopPropagation(),ae(),se(),f.nonJmmRoomChosen(),f.roomChosen(null),Ne(),Ke(Y)},Pe=function(e){e.preventDefault(),e.stopPropagation(),qe()},qe=function(e){var n=t.getMstConfigs().enabled;ae(),se(),s={name:O,address:P,isBoothTour:!0,boothTourUuid:e},n&&(f.locationPreferenceChange.trigger("booth_tour"),Me()||Xe(Y)),Ue(),y.setSetByDefualt(!1),f.boothTourChosen(s)};function Ne(){var e=(window&&window.meetingInfo||{}).request,t=(e===undefined?{}:e).room,n=t===undefined?{}:t,i=n.name,o=n.capacity,a=n.mm_only,s=(n.hideCapacity,"edit"===window.mode),d=s&&!_.isEmpty(n);r=!0;var c=HandlebarsTemplates["book/offsite_selection"]({mstNonJmm:!0,name:d?i:"Onsite Room",canChangePref:s,showRoomDetails:d,capacity:o,mm_only:a});f.locationPreferenceChange.trigger("on_site"),j.html(c)}function Be(){var e=t.getMstConfigs().enabled,n=HandlebarsTemplates["book/offsite_selection"](l({},a,{isMstEditFlow:e&&"edit"===window.mode}));G.html(n)}function Ue(){var e=t.getMstConfigs().enabled,n=HandlebarsTemplates["book/offsite_selection"](l({},s,{isMstEditFlow:e&&"edit"===window.mode}));j.html(n),Ke(H)}function Fe(e){e?(t.isOffsiteSelected=!0,f.locationPreferenceChange.trigger("off_site"),ee.removeClass("hide"),X.addClass("mst-offsite-highlight"),Xe(Q),a&&me()):(t.isOffsiteSelected=!1,f.locationPreferenceChange.trigger(Me()?"on_site":""),ee.addClass("hide"),X.removeClass("mst-offsite-highlight"),me())}function je(e){d=e}function He(e){ae(),Me()||Je(),je(!d),Fe(d)}function Ye(e){var n=t.getMstConfigs().enabled;if(e&&(e.preventDefault(),e.stopPropagation()),n&&"edit"===mode)return!1;f.offsiteChosen(null),ze()}function Le(e){var n=t.getMstConfigs().enabled;if(e&&(e.preventDefault(),e.stopPropagation()),n){if("edit"===mode)return!1;var i=Me()?"on_site":"";f.locationPreferenceChange.trigger(i)}f.boothTourChosen(null),Ve()}function Je(e){e&&(e.preventDefault(),e.stopPropagation()),f.roomChosen(null),r=!1,j.empty(),Xe(Y)}function Ve(){s=null,u=!1,j.empty(),Xe(H)}function We(){(t.getActivityRooms()||[]).length&&Xe(F)}function ze(){var e=t.getMstConfigs().enabled;a=null,j.empty(),G.empty(),scheduler.config.can_book_offsite&&Xe(Q),e&&(K.removeClass("hide"),je(!d),Fe(d)),c=!1}function Ze(e){e&&(e.preventDefault(),e.stopPropagation()),f.roomChosen(null),Ge(),window.mappingEnabled&&b.fetchExperts({callback:function(){h.resetAllAttendees()}})}function Ge(){var e=o&&o.uuid||"";o=null,j.empty(),V.empty(),Ie(e)}function Qe(e){e.stopPropagation(),e.preventDefault(),Xe(Q),$(".selected-offsite",G).addClass("hide"),a&&($("#name",Q).val(a.name),$("#address",Q).val(a.address))}function Ke(e){e.addClass("hide")}function Xe(e){e.removeClass("hide")}var et="";return{init:function(){$.validator.setDefaults({onkeyup:!1,onsubmit:!1,highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error"),$(e).siblings(".help-block:not(.form-builder-help-block)").hide()},errorElement:"span",errorClass:"help-block error-class",onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},showErrors:function(e,t){for(var n=0,i=this.validElements();i[n];n++)this.settings.unhighlight.call(this,i[n],this.settings.errorClass,this.settings.validClass),$("[id="+i[n].name+"-error]").hide();for(var o,a=0;t[a];a++)o=t[a],this.settings.highlight(o.element),$("[id="+o.element.name+"-error]").show(),this.showLabel(o.element,o.message)},errorPlacement:function(e,t){t.parent(".input-group").length?e.insertAfter(t.parent()):e.insertAfter(t)},messages:{offsiteName:{required:i18n.t("is_required",{attr:i18n.t("name")})},offsiteAddress:{required:i18n.t("is_required",{attr:i18n.t("address")})}}}),t.listen(function(e){if(e.type){var t=ne[e.type];"function"==typeof t&&t(e.data)}}),w.listen(function(e){if(e.type){var t=ie[e.type];"function"==typeof t&&t(e.data)}}),F.on("click",q,Re),W.on("click",q,Re),$(te).on("shown.bs.tab",function(e){var t=e.target,n=t&&"#"+t.parentElement.id,i=$(t).data("roomtype");A={parentSelector:n,selectedRoomType:i}}),j.on("click",".remove-selected-room",Ze),V.on("click",".remove-selected-room",Ze),Q.on("click","#add-offsite-btn",$e),G.on("click",".js-remove-selected-offsite",Ye),K.on("click",".js-mst-toggle-offsite",He),G.on("click",".edit-offsite",Qe),$(".js-selectBoothTour").on("click",Pe),$(".js-selectNonJmmMstRoom").on("click",Oe),j.on("click",".js-remove-selected-booth-tour",Le),j.on("click",".js-remove-selected-nonjmm-mstRoom",Je),e.on("change","input:checkbox",function(){!$(this).is(":checked")&&C.focusInMeetingWith()}),window.envDetails.isConsecutiveMeeting||(f.fetchActivitySettings(),("new"===mode||window.isEBCEvent)&&f.getAllMeetingTypes({isFirstLoad:!0,showInstructions:!0}))}}}();t.exports=S}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingType/handler.js","/app/scripts/Book/MeetingType")},{"../../commons/book/MeetingInMaking/handler":94,"../Attendee/actions":8,"../Attendee/store":10,"../BriefingRequest/store":12,"../Calendar/handler":14,"../Expert/actions":36,"../MeetingInMaking/actions":42,"../MeetingInMaking/handler":46,"../MeetingInMaking/store":47,"./actions":48,"./store":50,_process:114,buffer:112}],50:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("../Attendee/actions"),m=e("common_api"),h=window.selectedActivityUuid,p=e("../ConsecutiveMeetings/stores/mainStore"),g=e("../OngoingSales/store"),v=e("../ChangeMeetingType/store"),y=Reflux.createStore({init:function(){this.listenToMany(l),this.listenToMany(f),this.activity="",this.selectedMeetingType={},this.selectedRoom={},this.attendeeCount=0,this.showOverlay=!1,this.currentEvent=null,this.isSettingsSet=!1,this.canSelect=!0,this.hiddenExpertsCount=0,this.mstConfigs={},this.locationPreference=null},setActivity:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1];this.activity=e,t&&this.trigger({type:"setBookMeetingInstructions",data:this.activity.settings}),this.isSettingsSet||(this.trigger({type:"onActivitySettings",data:this.activity}),window.envDetails.isConsecutiveMeeting&&(window.envDetails.canUserChangeSelfAttendance=this.isEnabled(this.activity.settings.can_user_change_self_attendance),window.envDetails.defaultStateOfAreYouAttending="2"===this.activity.settings.default_state_of_are_you_attending?"yes":"no",window.envDetails.enable_meeting_host=this.isEnabled(this.activity.settings.enable_meeting_host),window.envDetails.meeting_host_label=this.activity.settings.meeting_host_label,window.envDetails.assign_requestors_as_meeting_host_by_default=this.isEnabled(this.activity.settings.assign_requestors_as_meeting_host_by_default),window.envDetails.assign_mapped_user_as_meeting_host_by_default=this.isEnabled(this.activity.settings.assign_mapped_user_as_meeting_host_by_default),window.envDetails.assign_only_topic_mapped_user_as_meeting_host=this.isEnabled(this.activity.settings.assign_only_topic_mapped_user_as_meeting_host),window.envDetails.allow_requestors_to_unassign_meeting_host=this.isEnabled(this.activity.settings.allow_requestors_to_unassign_meeting_host),p.updateCurrentMeeting(),this.trigger({type:"selectedAttendeeReset"})),this.isSettingsSet=!0)},onLocationPreferenceChange:function(e){var t=!(arguments.length>1&&arguments[1]!==undefined)||arguments[1];this.locationPreference=e,this.trigger({type:"onLocationPreferenceChange",data:e,triggerUpdateCalendar:t})},onSetMstConfigs:function(e){this.mstConfigs=e,this.trigger({type:"onSetMstConfig",data:e})},getMstConfigs:function(){return this.mstConfigs||{}},isEnabled:function(e){return"yes"===e||!0===e||"true"===e},getActivity:function(){return this.activity},getActivityRooms:function(){return this.activity.rooms},getActivityOthersRooms:function(){return this.activity.other_rooms},getActivityAllRooms:function(){return this.getActivityRooms().concat(this.getActivityOthersRooms())},getActivitySettings:function(){return this.activity.settings},setHiddenExpertsCount:function(e){this.hiddenExpertsCount=e,this.onAttendeeCountChanged(this.attendeeCount)},onCanSelectRooms:function(e){this.canSelect=e},onInitiateNewMeeting:function(e,t){h=e,this.activity.uuid=e,this.selectedRoom=t.room,this.attendeeCount=t.internal.length+t.external.length,this.showOverlay=!1,this.isSettingsSet=!1,this.isOffsiteSelected=this.selectedRoom&&this.selectedRoom.offsite,this.isBoothTourSelected=this.selectedRoom&&this.selectedRoom.isBoothTour,this.currentEvent=t.event||null,this.onAttendeeCountChanged(this.attendeeCount),this.trigger({type:"initiateNewMeeting",data:t})},showAvailableRooms:function(e){this.onAttendeeCountChanged(e);var t=!1;if(envDetails.topicManagementEnabled&&envDetails.topicRoomMappingEnabled)if("undefined"!=typeof topic_uuid)t=!!topic_uuid;else if("new"===mode){var n=$("#topic_management").val();void 0===n&&(n=meetingInfo.request.topic_uuid),"-"===n&&(n=""),t=!!n}else t=!!meetingInfo.request.topic_uuid;this.trigger({type:"onGetAllMeetingTypes",data:{isCapicityFilter:!0,groupData:t}})},setMeetingTimes:function(e){if(this.currentEvent){var t=(this.currentEvent.end_date-this.currentEvent.start_date)/1e3/60,n=60*this.currentEvent.start_date.getHours()+this.currentEvent.start_date.getMinutes(),i=n+t;e.event_date=moment(this.currentEvent.start_date).format("DD-MM-YYYY"),e.start_time=n,e.end_time=i<=1440?i:1440}},onResetRoomList:function(e,t){this.activity.rooms=[],this.activity.other_rooms=[],this.selectedRoom=null,this.isOffsiteSelected=!1,this.isBoothTourSelected=!1,this.attendeeCount=e?t:this.attendeeCount,this.onAttendeeCountChanged(this.attendeeCount),this.blockRoom(),this.trigger({action:"onResetRoomList",payload:{type:this.getActivity(),room:null,offsite:!1}}),this.trigger({type:"onResetRoomList"})},onGetAllMeetingTypes:function(e){var t=e.isFirstLoad,n=t!==undefined&&t,i=e.isNewEvent,o=i!==undefined&&i,a=e.byPassMasCalEntry,s=a!==undefined&&a,r=e.showInstructions,d=r!==undefined&&r,c={activity_uuid:h};window.briefing_uuid&&(c.briefing_uuid=window.briefing_uuid),this.setMeetingTimes(c),"edit"===meetingInfo.request.mode&&(c.meeting_request=meetingInfo.request.uuid,c.destination_activity_uuid=v.getDestinationActivityUuid()),"undefined"!=typeof location_uuid&&(c.location_uuid=location_uuid);var u=!1;if(envDetails.topicManagementEnabled&&envDetails.topicRoomMappingEnabled){if("undefined"!=typeof topic_uuid)c.topic_uuid=topic_uuid;else if("new"===mode){var l=$("#topic_management").val();void 0===l&&(l=meetingInfo.request.topic_uuid),"-"===l&&(l=""),c.topic_uuid=l}else c.topic_uuid=meetingInfo.request.topic_uuid;u=!!c.topic_uuid}if(this.locationPreference&&(c.location_preference=this.locationPreference),isOngoingSales){var f=g.getTimeZoneId();f&&(c.time_zone=f)}window.envDetails.setBlockToken(c);var p=m.fetch({url:m.ENDPOINTS.room_activities,data:c});p.then(function(e){var t=this;this.setActivity(e.data.activity,d);var i=e.data.booking_configs,a=e.data.manual_scheduling_configs;e.isCapicityFilter=!1;window.meetingInfo.request;this.getActivity().rooms=this.activity.rooms.filter(function(e){var n=t.getRoomsFilter(e,i,a);return e.mapped_meeting_types=_.pluck(e.activities,"name"),n}),this.activity.other_rooms?this.getActivity().other_rooms=this.activity.other_rooms.filter(function(e){var n=t.getRoomsFilter(e,i,a);return e.mapped_meeting_types=_.pluck(e.activities,"name"),n}):this.activity.other_rooms=[],e.selectedRoom=this.selectedRoom,e.first_load=n,e.isNewEvent=o,e.byPassMasCalEntry=s,e.configs=i,e.groupData=u,this.trigger({type:"onGetAllMeetingTypes",data:e})}.bind(this)),p[p.fail?"fail":"catch"](function(e){this.trigger(e.responseJSON)}.bind(this))},getRoomsFilter:function(e,t,n){var i=window.meetingInfo.request,o=window.envDetails.isCSM()||window.envDetails.isMeetingManager()||window.envDetails.isJuniorMM();return"edit"===i.mode&&i.room&&i.room.uuid===e.uuid||n.enabled&&e.available&&o||t.can_book_room&&e.available},getMeetingType:function(e){return _.find(this.meetingTypes,function(t){return t.uuid===e})},getSpecificRoom:function(e){var t=this.getActivityRooms();return _.find(t,function(t,n){return t.uuid===e})},getOthersRoom:function(e){var t=this.getActivityOthersRooms();return _.find(t,function(t,n){return t.uuid===e})},getPreSelectedRoom:function(e){var t=this.getActivityAllRooms();return _.find(t,function(t,n){return t.uuid===e})},chooseRoomForOverRideCapacity:function(e){this.blockRoom(),this.trigger({action:"onRoomChosen",payload:{type:e.type,room:e.room,offsite:e.offsite,boothTour:e.boothTour}})},getSelectedRoom:function(e,t){var n=this.selectedMeetingType;if(this.selectedMeetingType.uuid||(n=this.getMeetingType(t)),!n&&t&&(n=this.getMeetingType(t)),n){var i=n.rooms||[];return _.find(i,function(t){return t.uuid==e})}return{}},onMeetingTypeChosen:function(e){this.selectedMeetingType=e,this.trigger({action:"onMeetingTypeChosen",payload:e})},onRoomChosen:function(e){this.selectedRoom=e,this.isOffsiteSelected=!1,this.isBoothTourSelected=!1,this.onAttendeeCountChanged(this.attendeeCount),!e||this.roomCapacityCheck()?(this.blockRoom(),this.trigger({action:"onRoomChosen",payload:{type:this.getActivity(),room:e,offsite:!1,boothTour:!1}})):this.trigger({type:"overRidedRoomcapacity",data:{type:this.getActivity(),room:e,offsite:!1,boothTour:!1}})},onNonJmmRoomChosen:function(){this.selectedRoom={},this.isOffsiteSelected=!1,this.isBoothTourSelected=!1},roomCapacityCheck:function(){return this.attendeeCount+this.hiddenExpertsCount<=this.selectedRoom.capacity},onEditRoom:function(e){this.selectedRoom=e,this.isOffsiteSelected=!1,this.isBoothTourSelected=!1,this.onAttendeeCountChanged(this.attendeeCount),this.blockRoom(),this.trigger({action:"onRoomChosen",payload:{type:this.getActivity(),room:e,offsite:!1,isBoothTour:!1}})},onOffsiteChosen:function(e){this.selectedRoom=e,this.isOffsiteSelected=null!==e,this.isBoothTourSelected=!1,this.onAttendeeCountChanged(this.attendeeCount),e&&(e.address=e.address||""),this.blockRoom(),this.trigger({action:"onRoomChosen",payload:{type:this.getActivity(),room:e,offsite:!0,isBoothTour:!1}})},onBoothTourChosen:function(e){this.selectedRoom=e,this.isOffsiteSelected=!1,this.isBoothTourSelected=null!==e,this.onAttendeeCountChanged(this.attendeeCount),this.blockRoom(),this.trigger({action:"onRoomChosen",payload:{type:this.getActivity(),room:e,offsite:!1,isBoothTour:!!e}})},onEventBarCreated:function(e){this.currentEvent=e,this.blockRoom(),this.onGetAllMeetingTypes({isFirstLoad:!(!e||!e.didEventAddedOnDemand),isNewEvent:!0})},isRoomBigEnough:function(e){return this.attendeeCount<=e.capacity},onAttendeeCountChanged:function(e){this.attendeeCount=e;var t=!0;this.selectedRoom&&this.selectedRoom.capacity&&(t=this.attendeeCount+this.hiddenExpertsCount<this.selectedRoom.capacity),f.canSelectAttendees(t),this.canSelect=t},canRoomBeBlocked:function(){return window.envDetails.enableRoomInterimBlock&&"undefined"==typeof jiffle&&"view"!==window.mode&&!window.mappingEnabled&&!window.envDetails.isConsecutiveMeeting},blockRoom:function(e){var t=this;if(this.canRoomBeBlocked()){var n={room:e?undefined:this.selectedRoom&&this.selectedRoom.uuid,meeting_uuid:meetingInfo.request&&meetingInfo.request.uuid,time_zone:g.getTimeZoneId()};this.setMeetingTimes(n),window.envDetails.setBlockToken(n);var i=m.update({url:m.ENDPOINTS.room_block,data:n});i.then(function(n){t.trigger({type:"blockRoom",data:{discard:e}})}),i[i.fail?"fail":"catch"](function(n){t.trigger({type:"blockRoom",data:{discard:e}})})}else this.trigger({type:"blockRoom",data:{discard:e}})},getCurrentAgendaUUID:function(){return window.bam_uuid}});t.exports={MeetingStore:y}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingType/store.js","/app/scripts/Book/MeetingType")},{"../Attendee/actions":8,"../ChangeMeetingType/store":18,"../ConsecutiveMeetings/stores/mainStore":31,"../OngoingSales/store":54,"./actions":48,_process:114,buffer:112,common_api:"common_api"}],51:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../MeetingInMaking/store"),f=e("../MeetingInMaking/form_store"),m=e("../MeetingInMaking/actions"),h=e("../MeetingType/actions"),p=e("../MeetingType/store").MeetingStore,g=e("../../history/handler"),v=e("../../Notes/handler"),y=e("../../Reviews/handler"),b=e("../BriefingRequest/actions"),w=e("../BriefingRequest/store").BriefingRequestStore,M=e("common_api"),C=e("../../commons/date_format"),S=e("../commonHandlerUtility"),A=e("../../CommentsModal"),x=e("../../utils"),D=function(){var e,t,n=$("#proceed-page"),i=$(".selected-room",n),o=$(".selected-time",n),a=$(".selected-internal-attendee .selected-attendee-list",n),s=$(".selected-external-attendee .selected-attendee-list",n),r=$("#requestor-select"),d=$("#dynamic_form",n),c=$(".approved-text"),u=$(".meeting-status"),D=$(".accept-meeting"),k=$(".conflict-meeting"),T=$(".participation-meeting"),E=$(".decline-meeting"),I=$(".approve-meeting"),R=$(".cancel-meeting"),O=$(".js-meeting-survey"),P=$(".selected-attendee-list"),q=$(".count.js_attendee_count"),N=0,B=0,U=(envDetails.isJuniorMM()||envDetails.isExecutiveAdmin())&&"new"!=meetingInfo.request.mode&&!envDetails.isConsecutiveMeeting,F=M.ENDPOINTS.meeting_list,j=window.ReactMessage||$(".notification-modal"),H=$(".notification-modal"),Y={onMeetingAccepted:function(e){j.notificationModal({timeout:!0,"class":"green",body:e.message,title:i18n.t("meeting_accept_success_header")}),Me(e.data.actions),we(e.data.status);var n=envDetails.currentUser.uuid;t=e.data.actions_on_behalf,le(n,e.data.invite_status,e)},onMeetingDeclined:function(e){j.notificationModal({timeout:!0,"class":"green",body:e.message,title:i18n.t("meeting_decline_success_header")}),Me(e.data.actions),we(e.data.status);var n=envDetails.currentUser.uuid;t=e.data.actions_on_behalf,le(n,e.data.invite_status,e),ie(),function(e){if("StaffScheduling"!==envDetails.eventType||!e.max_capacity)return;$("#available_capacity").html(i18n.t("available_slots_info",{availableSlots:e.available_slots,maxCapacity:e.max_capacity}))}(e.data)},onMeetingApproved:function(e){j.notificationModal({timeout:!0,"class":"green",body:e.message,title:i18n.t("meeting_approve_success_header")}),Me(e.data.actions),we(e.data.status)},onMeetingCancelled:function(e){var t=envDetails.urlPrefix+F;if("undefined"!=typeof isEBCEvent&&1==isEBCEvent){var n=document.getElementsByTagName("base")[0].href;if("undefined"!=typeof briefing_uuid){var i=M.ENDPOINTS.list_briefings_agenda.replace("{QUERY_PARAMS}","?current_location_uuid="+envDetails.current_location_uuid);t=n+i+"/"+briefing_uuid}else t=n+M.ENDPOINTS.event_home}if("undefined"!=typeof jiffle){var o=window.location.search,a=new RegExp("[?&]mode=([^&#]*)").exec(o),s=new RegExp("[?&]meeting=([^&#]*)").exec(o);s&&(o=o.replace(s[0],"")),a&&(o=o.replace(a[0],"")),t=M.ENDPOINTS.apex_jnmeetings+o}window.commons.redirectPage(t)},onMeetingActionFailed:function(e){t=e.RuntimeError,j.notificationModal({"class":"red",body:t.join(", "),title:i18n.t("failure")});var t},onBehalfOfSuccess:function(e){var n=e.onBehalfOf;we(e.data.status),meetingInfo.request.status=e.data.status,Me(e.data.actions),meetingInfo.request.action_urls=e.data.actions_urls,t=e.data.actions_on_behalf,le(n,e.data.invite_status,e),ie()},onBehalfOfFailure:function(e){var t=[];_.forEach(e.responseJSON.errors,function(e){t.push(e)});var n=i18n.t("failure");"re_invite"==e.responseJSON.action&&(n=e.responseJSON.error_header);setTimeout(function(){j.notificationModal({timeout:!0,"class":"red",body:t.join(", "),title:n})},500)}},L=[],J=0,V={accept_meeting_url:"Accept",decline_meeting_url:"Decline",reinvite_url:"ReInvite",endorse_url:"Endorse"},W={remove:"remove",accept:"accept",decline:"decline"},z={remove:"remove",accept:"accept",decline:"decline"},Z={onGetAllMeetingTypes:function(e){if(200===e.status||e.success){var t=e.data.manual_scheduling_configs;h.setMstConfigs(t)}}},G={notes:!1,history:!1},Q={"#targetId_meeting-history-tab":K,"#targetId_notes-list":X};function K(){window.meetingInfo.request.can_access_history&&!G.history&&(g.init({fetchUrl:M.ENDPOINTS.meeting_history.replace("{uuid}",window.meetingInfo.request.uuid),mountPoint:"#meeting-history"}),G.history=!0)}function X(){window.meetingInfo.request.can_access_note&&!G.notes&&(v.init({entityUuid:window.meetingInfo.request.uuid,createUrl:window.meetingInfo.request.note_urls.create_meetintg_note_url,fetchUrl:window.meetingInfo.request.note_urls.fetch_meeting_note_url,mountPoint:"#meeting-notes"}),G.notes=!0)}function ee(e,t){"StaffScheduling"!==envDetails.eventType&&(B=_.filter(e,{invite_status:"declined"}).length+_.filter(t,{invite_status:"declined"}).length)}function te(e,t){N=e.concat(t).length}function ne(){var e=$("#sf-jiffle-now");e.length&&$.urlParam&&$.urlParam("ebc")&&($(".selected-external-attendee").addClass("hide"),e.removeClass().addClass("jiffle-briefings iris-bootstrap"))}function ie(){var e=$("#roomFullHolder"),t=$("#occupiedRoomHolder"),n=J-(N-B);n<=0?(e.removeClass("hide"),t.addClass("hide")):(e.addClass("hide"),t.removeClass("hide").find(".occupiedCount").text(n))}function oe(e){meetingInfo.request.users.external=e.data.data.external_attendees,_.each(meetingInfo.request.users.external,function(e){"Declined"===e.ics_status&&(e.invite_status="declined")}),te(meetingInfo.request.users.internal,meetingInfo.request.users.external),ee(meetingInfo.request.users.internal,meetingInfo.request.users.external),ie()}function ae(e,t){var n=t||{};_.forOwn(V,function(t,i){n[i]?(e[t]="",e[i]=n[i]):e[t]="hide"})}function se(t){t.preventDefault(),t.stopPropagation();var n=$(this),i=n.closest(".selected-attendee-item").data("uuid");!n.closest(".selected-attendee-item").hasClass("declined")||e||J>N-B?H.notificationModal({type:"confirmation","class":"green",title:i18n.t("confirmation_title"),body:function(e){var t=function(e){return _.find(L,{uuid:e})}(e),n=p.getMstConfigs();return S.isEmailNotification(t,n)}(i)?i18n.t("reinvite_confirm_email_message"):i18n.t("reinvite_confirm_message"),done:function(){var e=n.data("url");m.behalfOfMeetingAction(e,i,"post","onBehalfOfSuccess","onBehalfOfFailure")}}):j.notificationModal({"class":"red",title:i18n.t("cannot_reinvite_title"),body:i18n.t("cannot_reinvite_as_capacity_reached_in_view")})}function re(e){e.preventDefault(),e.stopPropagation(),attendeeType=$(this).closest(".selected-attendee-item").data("attendee_type");var t="internal"===attendeeType?meetingInfo.request.users.internal:meetingInfo.request.users.external,n=$(this).closest(".selected-attendee-item").data("uuid");attendeeUuid=n;var i=HandlebarsTemplates["meeting/meeting-servey-item"],o=_.find(t,function(e){return e.uuid==n});_.forEach(o.survey_links,function(e){e.response_uuid?e.action=M.ENDPOINTS.survey_responses+"/"+e.response_uuid:e.survey_response_create_url&&(e.action=e.survey_response_create_url.slice(1)),e.attendee=o.uuid,e.show_survey=_.contains(e.user_access,window.envDetails.role)}),$("#attendee-survey-container").html(i({surveys:o.survey_links})),0==o.show_send_mail?$("#js-attendee-survey-mail").hide():$("#js-attendee-survey-mail").show(),m.updateSurveyType("attendee"),$(".js-attendee-survey-modal").modal({show:!0,backdrop:"static"}).data("uuid",n)}function de(e){e.preventDefault(),e.stopPropagation();var t=$(this).filter("#js-requestor-survey").length,n=HandlebarsTemplates["meeting/meeting-servey-item"],i=t?meetingInfo.request.requestor_fill_survey_links:meetingInfo.request.fill_survey_links;_.forEach(i.survey_links,function(e){e.response_uuid?e.action=M.ENDPOINTS.survey_responses+"/"+e.response_uuid:e.survey_response_create_url&&(e.action=e.survey_response_create_url.slice(1)),t&&(e.attendee=meetingInfo.request.requestor.uuid),e.show_survey=!0}),$("#attendee-survey-container").html(n({surveys:i.survey_links})),$("#js-attendee-survey-mail").hide(),t&&i.show_send_mail&&$("#js-attendee-survey-mail").show(),$(".js-attendee-survey-modal").modal({show:!0,backdrop:"static"})}function ce(e){e.preventDefault(),e.stopPropagation();var t=$(this).closest(".selected-attendee-item");m.behalfOfMeetingAction($(this).data("url"),t.data("uuid"),"post","onBehalfOfSuccess","onBehalfOfFailure")}function ue(e){e.preventDefault(),e.stopPropagation();var t=$(this),n=t.closest(".selected-attendee-item").data("uuid"),i=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";m.behalfOfMeetingAction(t.data("url"),n,"post","onBehalfOfSuccess","onBehalfOfFailure",e)},o=S.isDeclineCommentEnabled(n),a=o.enabled,s=o.showOnlyOthers,r=s?[]:x.getDeclineComments();a?A.show({comments:s?[]:r,callback:i}):i()}function le(e,n,i){var o=meetingInfo.request.users.internal,a=meetingInfo.request.users.external;o.map(function(o){var a=_.find(i.data.users.internal,{uuid:e});o.uuid==e?(he(o,t[o.uuid],n),o.edit_partial_participation=a.edit_partial_participation||!1,o.view_partial_participation=a.view_partial_participation||!1):ae(o,t[o.uuid])}),a.map(function(i){i.uuid==e?he(i,t[i.uuid],n):ae(i,t[i.uuid])}),te(o,a),ee(o,a),"StaffScheduling"==envDetails.eventType&&"view"==window.mode?(occupiedRoomHolder=$("#occupiedRoomHolder"),occupiedRoomHolder.addClass("hide")):ie(),me(o,a)}function fe(e){var t=[],n="";modalEl=$(this).closest(".js-attendee-survey-modal"),modalEl.find(".js-meeting-servey-item").each(function(e,i){var o=$(i).data("uuid");$("#survey-"+o).is(":checked")&&(t.push($(i).data("uuid")),n=$(i).data("attendee"))}),t.length>0?m.triggerSurveyMails(n,meetingInfo.request.uuid,t):j.notificationModal({"class":"yellow",title:i18n.t("required_survey"),body:i18n.t("survey_not_selected")})}function me(e,t){var n=HandlebarsTemplates["book/selected_attendee"],i={users:e,isConsecutive:envDetails.isConsecutiveMeeting,remove:!1,actions:!0,role_enabled:U,remove_label:i18n.t(W.remove),accept_label:i18n.t(W.accept),decline_label:i18n.t(W.decline),type:"internal",meetingCancelled:"cancelled"===window.meetingInfo.request.status};if(window.envDetails.enable_meeting_host&&window.envDetails.enable_meeting_host.toBoolean()){var o={meeting_host_label:window.envDetails.meeting_host_label,enable_meeting_host:window.envDetails.enable_meeting_host.toBoolean()};_.merge(i,o),i.users=_.sortByOrder(e,["meeting_host"],[!1])}var r=n(i),d=n({users:t,remove:!1,actions:!0,role_enabled:U,remove_label:i18n.t(z.remove),accept_label:i18n.t(z.accept),decline_label:i18n.t(z.decline),type:"external",meetingCancelled:"cancelled"===window.meetingInfo.request.status});a.html(r),s.html(d),"cancelled"===meetingInfo.request.status&&$(".dropdown",".selected-internal-attendee").addClass("hide"),q.html(e.length)}function he(e,t,n){n&&(e.invite_status=n),ae(e,t)}function _e(e){e.preventDefault(),e.stopPropagation();var t=meetingInfo.request.action_urls.accept_meeting_url;m.meetingAction(t,"post","onMeetingAccepted","onMeetingActionFailed")}function pe(e){e.preventDefault(),e.stopPropagation();var t=meetingInfo.request.action_urls.conflict_meeting_url;window.commons.openPageInNewTab(t)}function ge(e){e.preventDefault();var t=window.meetingInfo.request.action_urls.export_report_url;t&&commons.openPageInNewTab(t)}function ve(e){e.preventDefault(),e.stopPropagation();var t=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",t=meetingInfo.request.action_urls.decline_meeting_url;m.meetingAction(t,"post","onMeetingDeclined","onMeetingActionFailed",null,{declined_comments:e})},n=S.isDeclineCommentEnabled().enabled,i=x.getDeclineComments();n?A.show({comments:i,callback:t}):t()}function ye(e){e.preventDefault(),e.stopPropagation();var t=meetingInfo.request.action_urls.approve_meeting_url;m.meetingAction(t,"put","onMeetingApproved","onMeetingActionFailed")}function be(e){e.preventDefault(),e.stopPropagation();var t=meetingInfo.request.action_urls.cancel_meeting_url;S.cancelMeeting({callback:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";m.meetingAction(t,"put","onMeetingCancelled","onMeetingActionFailed",null,{cancel_comments:e})}})}function we(e){u.removeClass("pending cancelled approved").addClass(e),c.text(e),meetingInfo.request.status=e}function Me(e){var t;D.addClass("hide"),E.addClass("hide"),I.addClass("hide"),R.addClass("hide"),T.addClass("hide"),k.addClass("hide"),e.map(function(e,t){"export report"===(e=e.toLowerCase())&&(e="export-report"),$("."+e+"-meeting").removeClass("hide")}),t=$(".js-secondary-action-list").find("li:not(.hide)").length,$(".js-secondary-action-dropdown")[t?"removeClass":"addClass"]("hide")}function Ce(e){if(e&&(e.data&&e.data.custom_form_fields&&(e.custom_form_fields=e.data.custom_form_fields),e.custom_form_fields)){if(formRenderer=$(d).formViewRenderer({fieldCollection:e.custom_form_fields}),formRenderer.init(),meetingInfo.request){var t=meetingInfo.request.custom_fields||{};t.meeting_with=meetingInfo.request.meeting_with,t.topic_management=meetingInfo.request.topic_management&&meetingInfo.request.topic_management.name,meetingInfo.request.custom_fields=t,formRenderer.setValues(meetingInfo.request)}formRenderer.afterLoad()}}return{init:function(){f.listen(Ce),w.listen(oe),l.listen(function(e){var t=e.action,n=e.payload||{},i=Y[t];i&&i(n)}),p.listen(function(e){if(e.type){var t=e.data,n=Z[e.type];"function"==typeof n&&n(t)}}),m.getCustomForm(),h.getAllMeetingTypes({});var a=$.urlParam("briefing_uuid");!_.isEmpty(a)&&b.briefingDetails(a);var s=meetingInfo.request,d={};d=_.isEmpty(s.room)?{roomNotAvailable:!0,roomNotAvailableMessage:s.room_not_assigned_msg||i18n.t("room_not_assigned_msg")}:s.room.uuid?"BoothTour"===s.room.type?{offsite:!0,name:s.room.name,address:s.room.location}:{offsite:!1,display_name:s.activity.display_name,room_name:s.room.name,capacity:s.room.capacity}:{offsite:!0,name:s.room.offsite_location_name||s.room.name,address:s.room.offsite_location_address||s.room.location,capacity:""};var g=HandlebarsTemplates["book/proceed_room"];$(i).html(g(d));var v,S,A,x=HandlebarsTemplates["book/proceed_time"],T=C.convertDateTimeServerToTime(s.start_time),q=C.convertDateTimeServerToTime(s.end_time),N=C.convertDateTimeServerToJsDate(s.start_time).toMediumDate(),B=(envDetails.event.time_zone_display_name||"").trim()||envDetails.event.time_zone;window.isOngoingSales&&(U=meetingInfo.request,F=U.meeting_time_zone,j=U.meeting_time_zone_offset,H=U.meeting_time_zone_city,B=j&&H?j+" "+H.split(",")[0]:j||F),!0===window.isEBCEvent&&(B=window.envDetails.current_location.time_zone_display_name||window.envDetails.current_location.timezone),$(".book-meeting .meeting-id").removeAttr("data-i18n").text(i18n.t("meeting_id")+s.id),html=x({break_duration:s.meeting_break.meeting_break_duration,start_time:T,end_time:(v=q,S=s.meeting_break.meeting_break_duration||0,A=v._isAMomentObject?v:moment(v,"hh:mm A"),A.subtract(S,"minutes"),A.format("hh:mm A")),event_date:N,meeting_time_zone:B,showGotoMainOptionFromDetails:!1}),o.html(html);var U,F,j,H;var W=s.users.internal,z=s.users.external;L=L.concat(W,z),t=actions_on_behalf,W.map(function(e,n){t[e.uuid]?ae(e,t[e.uuid]):_.forOwn(V,function(t,n){e[t]="hide"})}),z.map(function(e,n){t[e.uuid]?ae(e,t[e.uuid]):_.forOwn(V,function(t,n){e[t]="hide"})}),me(W,z);var G=s.users.internal.length,le=s.users.external.length;$(".selectedInternalAttendeeCount").text(G),$(".selectedInternalAttendeeCount + span").html(i18n.t(1==G?"internal_participant":"internal_participants")),$(".selectedExternalAttendeeCount").text(le),$(".selectedExternalAttendeeCount + span").html(i18n.t(1==le?"external_participant":"external_participants"));var he=s.requestor;r.addClass("hide"),$("[id^='requestor-label-div']").removeClass("hide").text(he.first_name+" "+he.last_name),"undefined"==typeof jiffle&&(O.filter("#js-meeting-survey")[meetingInfo.request.fill_survey?"removeClass":"addClass"]("hide"),O.filter("#js-requestor-survey")[meetingInfo.request.requestor_fill_survey?"removeClass":"addClass"]("hide")),Me(s.actions),c.text(s.status),u.addClass(s.status),te(s.users.internal,s.users.external),ee(s.users.internal,s.users.external),J=d.capacity,e=d.offsite||!1,ie(),ne(),ie(),ne(),"StaffScheduling"==envDetails.eventType&&"view"==window.mode?(occupiedRoomHolder=$("#occupiedRoomHolder"),occupiedRoomHolder.addClass("hide")):ie(),$(".go-to-main").hide(),$(".go-to-main-internal").addClass("hide"),$(".go-to-main-external").addClass("hide"),D.on("click",_e),E.on("click",ve),I.on("click",ye),R.on("click",be),O.on("click",de),k.on("click",pe),$(".export-report-meeting").on("click",ge),P.on("click",".attendee_accept",ce).on("click",".attendee_decline",ue).on("click",".attendee_reinvite",se).on("click",".attendee_survey",re),n.on("click","#js-meeting-history-tab",K),n.on("click","#js-meeting-notes-tab",X),$(document).on("click","#js-attendee-survey-mail",fe),window.meetingInfo.can_access_reviews&&y.init({entityUuid:window.meetingInfo.request.uuid,mountPoint:"#meeting-review-tab",fetchUrl:M.ENDPOINTS.get_reviews,updateUrl:M.ENDPOINTS.update_review,entityType:window.entityNameForReview}),"function"==typeof Q[window.location.hash]&&Q[window.location.hash](),$("#sf-jiffle-now").length&&$("a[href='#meeting-history-tab']").parent().addClass("hide")}}}();t.exports=D}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/MeetingView/handler.js","/app/scripts/Book/MeetingView")},{"../../CommentsModal":66,"../../Notes/handler":73,"../../Reviews/handler":79,"../../commons/date_format":96,"../../history/handler":108,"../../utils":110,"../BriefingRequest/actions":11,"../BriefingRequest/store":12,"../MeetingInMaking/actions":42,"../MeetingInMaking/form_store":45,"../MeetingInMaking/store":47,"../MeetingType/actions":48,"../MeetingType/store":50,"../commonHandlerUtility":63,_process:114,buffer:112,common_api:"common_api"}],52:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["updateCalendar","getCityTimeZone"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/OngoingSales/actions.js","/app/scripts/Book/OngoingSales")},{_process:114,buffer:112}],53:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){e("../Calendar/actions");var l=e("../Calendar/store").CalendarAvailabilityStore,f=e("./actions"),m=e("../MeetingType/store").MeetingStore,h=(e("common_api"),e("./store")),_=e("../../commons/timeZoneHelper/actions"),p=e("../../commons/timeZoneHelper/handler"),g=function(){var e,t=$(".js-date-picker-section"),n=($(".room-list"),new Date),i=void 0,o=void 0,a=void 0,s=void 0,r=void 0,d=void 0;function c(){v(scheduler.getState().date),m.blockRoom()}function u(e,t){o.closest("div").removeClass("hide");var n={format:"dd-mm-yyyy",startDate:e,defaultViewDate:{year:t.getFullYear(),month:t.getMonth(),day:t.getDate()},beforeShowDay:function(e){var n=moment(e),i=o.data("datepicker").getDate()||t,a=moment(i).startOf("week"),s=moment(i).endOf("week");if(n.isSame(a)||n.isSame(s)||n.isBetween(a,s))return{classes:"highlighted"}},maxViewMode:2};"undefined"!=typeof jiffle&&$.extend(n,{container:$("#sf-jiffle-now")}),o.bootstrapDP(n),g(t),o.on("changeDate",function(e){var t=e.date;scheduler.setCurrentView(t),l.updateCalendarStartDate(t),v(t),o.data("datepicker").hide()})}function g(e){0!=o.length&&o.data("datepicker").setDate(e)}function v(e){f.updateCalendar.trigger(e)}function y(e){e.preventDefault(),e.stopPropagation();var t=moment(scheduler.getState().date).startOf("week");t-a>0&&(scheduler._click.dhx_cal_next_button(0,-1),g((t=scheduler.getState().date)-a>0?t:a))}function b(e){e.preventDefault(),e.stopPropagation(),scheduler._click.dhx_cal_next_button(0,1),g(scheduler.getState().date)}function w(e){var t=moment(n).startOf("day");return moment(e).startOf("day")-t<0}return{init:function(){if(t.html(HandlebarsTemplates["book/ongoing_sales"]({book_meeting:!0})),o=$("#meeting-week-picker"),r=$("#city-for-time-zone"),d=$(".js-display-timezone"),p.init({timeZoneCityField:r,displayTimeZoneField:d,Actions:_,Store:h,timeZoneChangeCallback:c,isExternalWidget:!1,timeZoneCityContainer:"#select2-city-for-time-zone-container"}),p.setTimeZoneField(),meetingInfo.request&&meetingInfo.request.start_time&&(e=meetingInfo.request.start_time instanceof Date?meetingInfo.request.start_time:new Date(moment(meetingInfo.request.start_time,"DD-MM-YYYY"))),a=n,s=n,e)s=e,"new"===mode&&w(e)&&(s=n),"edit"===mode&&w(e)&&(a=e),l.updateCalendarStartDate(s),u(a,s);else{var i=new Date(moment(envDetails.event.start_date,"YYYY-MM-DD"));w(i)||(s=i,a=i),l.updateCalendarStartDate(s),v(s),u(a,s)}},setCalendarConfig:function(){scheduler.config.first_hour=0,scheduler.config.last_hour=24,scheduler.config.limit_start=null,"new"!==window.mode||meetingInfo.request&&meetingInfo.request.start_time||(scheduler.config.scroll_hour=8),scheduler.config.limit_end=null,scheduler.config.limit_view=!1,$(".js-calendar-dropleft,.js-calendar-dropright").removeClass("hide"),$(".js-calendar-dropright").off("click"),$(".js-calendar-dropleft").off("click"),$(".js-calendar-dropright").on("click",b),$(".js-calendar-dropleft").on("click",y),scheduler.attachEvent("onEventAdded",function(e,t){i=t}),scheduler.attachEvent("onBeforeDrag",function(e,t,n){return i=scheduler.getEvent(e),!0}),scheduler.attachEvent("onDragEnd",function(){var e,t;i&&"start_date"in i&&(e=i.start_date,!t&&scheduler.setCurrentView(e),v(e))}),scheduler.update_view()},isPastDay:w,fetchAvailablity:v}}();t.exports=g}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/OngoingSales/handler.js","/app/scripts/Book/OngoingSales")},{"../../commons/timeZoneHelper/actions":103,"../../commons/timeZoneHelper/handler":104,"../Calendar/actions":13,"../Calendar/store":15,"../MeetingType/store":50,"./actions":52,"./store":54,_process:114,buffer:112,common_api:"common_api"}],54:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../../commons/timeZoneHelper/actions"),f=e("../../commons/timeZoneHelper/store"),m=Reflux.createStore(Object.assign({init:function(){this.listenToMany(l),this.setStoreVariables()}},f));t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/OngoingSales/store.js","/app/scripts/Book/OngoingSales")},{"../../commons/timeZoneHelper/actions":103,"../../commons/timeZoneHelper/store":105,_process:114,buffer:112}],55:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=$(".notification-modal"),l=function(){var e=$("#header"),t=$("#navigation"),n={previous:"meeting_request"},i={meeting_request:"meeting_request_1"};function o(e,t){return JSON.stringify(e)===JSON.stringify(t)}function a(e){return o(e,n)}function s(e){var t=e.currentTarget.href;null!==t.match(/^\s*(http|https)/)&&(e.preventDefault(),r(function(){commons.redirectPage(t)}))}function r(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:$.noop,n=!1;u.notificationModal({title:i18n.t("user_navigation_title"),"class":"blue",type:"confirmation",body:i18n.t("user_navigation_body"),done:function(){n=!0},dismiss:function(){n?e():t()}})}function d(){a(c())?window.history.back():window.history.go(-2)}function c(){return window.history.state}return{init:function(){if(window.history.length>1){var u=c();null===u?(window.history.replaceState(n,"",null),window.history.pushState(i,"",null)):o(u,n)&&window.history.forward(),window.onpopstate=function(e){var t=e.state;a(t)&&r(d,function(){var e=c();a(e)&&window.history.forward()})}}e.on("click","a",s),t.on("click","a",s)},isHistoryEnabled:function(){return!!window.history}}}();t.exports=l}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/PageNavigation.js","/app/scripts/Book")},{_process:114,buffer:112}],56:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["getRequestorMailForm","sendRequestorMail"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/RequestorMailers/actions.js","/app/scripts/Book/RequestorMailers")},{_process:114,buffer:112}],57:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=window.CKEDITOR||{},l={CKEDITOR_CONFIGS:{toolbar:[["Bold","Italic","Underline"],["Link","Unlink"],["Table"],["Undo","Redo"],["NumberedList","BulletedList"]],format_tags:"p;h1;h2;h3;pre",removeDialogTabs:"image:advanced;link:advanced",removePlugins:"elementspath,a11yHelp,about,paste",linkShowTargetTab:!1,linkShowAdvancedTab:!1,resize_enabled:!1,enterMode:u.ENTER_BR},setupEditorConfigs:function(){u.basePath=envDetails.urlPrefix+"/assets/ckeditor/",u.on("dialogDefinition",function(e){e.data.definition.resizable=u.DIALOG_RESIZE_NONE}),u.on("instanceReady",function(e){var t=e.editor;if(void 0!==t){t.focus();var n=t.document.getBody(),i=t.createRange();i&&(i.moveToElementEditablePosition(n,!1),i.select())}})},initialiseCKEditor:function(e){u.replace(e,this.CKEDITOR_CONFIGS),this.setupEditorConfigs()},insertHTML:function(e,t){u.instances[e].insertHtml(t)},getData:function(e){return u.instances[e].getData()},setData:function(e,t){u.instances[e].setData(t)}};t.exports=l}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/RequestorMailers/ck_editor.js","/app/scripts/Book/RequestorMailers")},{_process:114,buffer:112}],58:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./store"),f=e("./actions"),m=function(){var t,n,i=$("#requestor-mail-modal"),o=$("#send-requestor-mail-btn"),a={mountPoint:"",isSFDC:0,isFromBookMeeting:!0,meetingRequestUuid:"",meetingRequestor:""},s={renderForm:function(e){e.payload.requestor=m().meetingRequestor,i.find("form").html(HandlebarsTemplates["book/send_requestor_mail"](e.payload)),n.initialiseCKEditor("ckeditor-mail-body"),i.modal({show:!0,backdrop:"static"})},mailSentSuccess:function(){i.modal("hide"),r.notificationModal({body:i18n.t("mail_sent_success_msg"),"class":"green",title:i18n.t("mail_sent_success_title",{first_name:envDetails.currentUser.first_name})})}},r=window.ReactMessage||$(".notification-modal"),d=$(".notification-modal");function c(e){_.merge(a,e)}function u(){(m().isFromBookMeeting?!m().isSFDC&&"edit"===mode&&meetingInfo.request.requestor.uuid!==envDetails.currentUser.uuid:m().ShowRequestorEmail)?o.removeClass("hide"):o.addClass("hide")}function m(){return a}function h(e){"function"==typeof s[e.action]&&s[e.action](e)}function p(){$(".modal").css("overflow","auto"),$("body").css("overflow","auto")}function g(){var e,t,n;window.CKEDITOR?v():(e="/"+window.location.pathname.split("/")[1]+"/assets/ckeditor/ckeditor.js",t=!1,(n=document.createElement("script")).src=e,n.async=t,n.onload=b,window.document.body.appendChild(n))}function v(){f.getRequestorMailForm("renderForm",m().meetingRequestUuid)}function y(){var e=$("#cc_me").is(":checked"),t=!1;d.notificationModal({"class":"blue",type:"confirmation",title:i18n.t("mail_confirmation_title"),body:i18n.t("send_mail_confirmation_msg",{action:i18n.t(e?"will":"wont")}),cancel:function(){$(".modal").css("overflow","auto"),$("body").css("overflow","hidden")},done:function(){t=!0},dismiss:function(){if(t){var i={body:n.getData("ckeditor-mail-body"),subject:($("#subject").val()||"").trim(),cc_me:e,meeting_uuid:m().meetingRequestUuid};f.sendRequestorMail(i,"mailSentSuccess")}}})}function b(){n=e("./ck_editor"),v()}return{init:function(e){c(e),function(e){t=$(e.mountPoint)}(e),l.listen(h),t.on("click","#send-requestor-mail-btn",g),i.on("click","#send-mail-to-requestor",y),i.on("hide.bs.modal",p),m().isFromBookMeeting&&u()},initUiForMascal:function(e){e&&_.assign(a,e),u()},setOptions:c,showRequestorEmailButton:u}}();t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/RequestorMailers/handler.js","/app/scripts/Book/RequestorMailers")},{"./actions":56,"./ck_editor":57,"./store":59,_process:114,buffer:112}],59:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=Reflux.createStore({init:function(){this.listenToMany(l)},onGetRequestorMailForm:function(e,t){f.fetch({url:f.ENDPOINTS.fetch_requestor_email,data:{meeting_uuid:t}}).then(function(t){this.trigger({action:e,payload:t.data})}.bind(this))},onSendRequestorMail:function(e,t){f.update({url:f.ENDPOINTS.send_requestor_email,data:e}).then(function(e){this.trigger({action:t,payload:e.data})}.bind(this))}});t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/RequestorMailers/store.js","/app/scripts/Book/RequestorMailers")},{"./actions":56,_process:114,buffer:112,common_api:"common_api"}],60:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["getSwappableRoomList","swapRoomsWithOtherMeetings"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/SwapRoom/actions.js","/app/scripts/Book/SwapRoom")},{_process:114,buffer:112}],61:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){function l(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var f=e("./store"),m=e("./actions"),h=e("common_api"),p=e("../MeetingType/store").MeetingStore,g=e("../Attendee/store").AttendeeStore,v=function(){var e=$(".notification-modal"),t={isMascalRoomSwap:!1,selectedMeeting:null,selected_meeting_uuid:null,swapButtonMountPoint:$("#proceed_page"),swapRoomListMountPoint:$("#roomSwapModal"),swapRoomCancelBtn:$("#swap-room-btn-cancel"),roomListTemplatePath:"book/swap_room_listing",showNotification:window.ReactMessage.notificationModal||$.fn.notificationModal.bind(e),showConfirmation:$.fn.notificationModal.bind(e),roomListContainer:$("#roomSwapModal").find("#swappable-room-list")},n={renderSwappableRooms:function(e){_.isEmpty(e.payload.rooms)?t.showNotification({title:i18n.t("no_swappable_rooms"),"class":"yellow",body:i18n.t("try_changing_room")}):(t.roomListContainer.html(HandlebarsTemplates[t.roomListTemplatePath](e.payload)),t.isMascalRoomSwap?($(".jn-c-previewpane--btn").hide(),t.roomListContainer.prev(".jn-c-previewpane__scroll").hide(),t.roomListContainer.removeClass("hide").fadeIn(300)):t.swapRoomListMountPoint.modal({show:!0,backdrop:"static"}))},swapRoomSuccess:function(e){a(),t.showNotification({"class":"green",title:i18n.t("swap_room_success_title",{first_name:envDetails.currentUser.first_name}),body:i18n.t("swap_room_success_message"+(t.isMascalRoomSwap?"_mascal":"")),dismiss:function(){var e=h.ENDPOINTS.meeting_list;window.commons.redirectPage(envDetails.urlPrefix+e)}})},swapRoomFailure:function(e){a(),t.showNotification({"class":"red",title:i18n.t("swap_room_failure_title"),body:e.payload||i18n.t("swap_room_failure_message"),dismiss:function(){}})}};function i(e){"function"==typeof n[e.action]&&n[e.action](e)}function o(){t.showConfirmation({type:"confirmation","class":"yellow",title:i18n.t("are_you_sure"),body:i18n.t("confirm_swap_room"),done:u,dismiss:a})}function a(){t.swapRoomListMountPoint.modal("hide")}function s(e){var n=$(e.currentTarget).data("uuid"),i=f.getSwapableRoomdata(n);if(g.isJuniorMMorAbove()){var o="",a=function(e){var n="";(function(e){var n,i,o=p.attendeeCount,a=p.selectedRoom.capacity;t.isMascalRoomSwap&&(n=t.selectedMeeting,i=n.users,a=n.room.capacity,o=_.uniq([].concat(l(i.internal),l(i.external),l(i.agenda)),"uuid").length);return!g.getOverRideRoomcapacityPopup()&&(a<e.number_of_attendees||e.room_capacity<o)})(e)&&(n=t.isMascalRoomSwap?i18n.t("swap_room_overide_confirm_inline_message"):i18n.t("override_room_capacity_body"));return n}(i),s=function(e){var n="";r(e)||d(e)?r(e)?d(e)||(n=i18n.t("room_not_mapped",{room:e.room_name,meeting_type:t.isMascalRoomSwap?t.selectedMeeting.activity.display_name:meetingInfo.request.activity.display_name})):n=i18n.t("room_not_mapped",{room:t.isMascalRoomSwap?t.selectedMeeting.room.name:p.selectedRoom.name,meeting_type:e.meeting_type}):n=i18n.t("both_rooms_unmapped_to_meetings");return n}(i);if(a&&(o=a+"<br>"),s&&(o+=s),o){var c=!1;t.showConfirmation({type:"confirmation","class":"yellow",title:i18n.t("are_you_sure"),body:o,done:function(){c=!0},dismiss:function(){c?a&&g.persistOverRideRoomPopup(c):t.roomListContainer.find(".js-swap_room_with_meeting").prop("checked",!1)}})}}}function r(e){var n=(t.isMascalRoomSwap?t.selectedMeeting.room:p.selectedRoom).activities;if(n&&n.length){var i=_.pluck(n,"uuid");if("ALL"==i[0])return!0;if(i.indexOf(e.meeting_type_uuid)>-1)return!0}return!1}function d(e){return e.mapped_to_meeting}function c(){t.roomListContainer.html(""),t.swapRoomListMountPoint.find("#errorMsg").text("")}function u(){var e=t.roomListContainer.find('[name="swap_room_with_meeting"]:checked');if(_.isEmpty(e))t.isMascalRoomSwap?t.showNotification({body:i18n.t("select_room_to_swap"),"class":"red"}):t.swapRoomListMountPoint.find("#errorMsg").text(i18n.t("select_room_to_swap"));else{var n={toMeeting:e.data("uuid")},i=!1;t.showConfirmation({type:"confirmation","class":"blue",title:i18n.t("send_swap_room_update_ics_title"),body:i18n.t("send_swap_room_update_ics_body"),proceedActionText:"Yes",cancelActionText:"No",done:function(){i=!0},dismiss:function(){n.sendIcs=i,m.swapRoomsWithOtherMeetings(n,"swapRoomSuccess","swapRoomFailure")}})}}function v(e,n){t.swapButtonMountPoint.find(".js-swap-room-btn")[n.isOffsite||n.isMappingEnabledActivity||n.isSFDC?"addClass":"removeClass"]("hide")}function y(e){e.preventDefault(),m.getSwappableRoomList(t.selected_meeting_uuid,"renderSwappableRooms")}return{init:function(e){e&&_.assign(t,e),f.listen(i),t.swapButtonMountPoint.on("room_change",v).on("click",".js-swap-room-btn",y),t.swapRoomListMountPoint.on("click","#swap-room-btn",o).on("hidden.bs.modal",c),t.swapRoomListMountPoint.on("click","#swap-room-btn-cancel",function(){a()}),t.swapRoomListMountPoint.on("click",".js-swap_room_with_meeting",s)},initUiForMascal:function(e){e&&_.assign(t,e)}}}();t.exports=v}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/SwapRoom/handler.js","/app/scripts/Book/SwapRoom")},{"../Attendee/store":10,"../MeetingType/store":50,"./actions":60,"./store":62,_process:114,buffer:112,common_api:"common_api"}],62:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=e("./actions"),m=e("common_api"),h=Reflux.createStore({init:function(){this.listenToMany(f),this.swapableRoomList={},this.current_meeting_uuid=null},setSwapableRoomdata:function(e){_.each(e.rooms,function(e){this.swapableRoomList[e.meeting_uuid]=e}.bind(this))},getSwapableRoomdata:function(e){return this.swapableRoomList[e]},onGetSwappableRoomList:function(e,t){this.current_meeting_uuid=e||meetingInfo.request.uuid||"";var n=m.fetch({url:m.ENDPOINTS.get_swappable_room_list,data:{meeting_uuid:this.current_meeting_uuid}});n.then(function(e){this.setSwapableRoomdata(e.data),this.trigger({action:t,payload:e.data}),this.trigger({action:"updateFooterActions",data:e.data})}.bind(this)),n[n.fail?"fail":"catch"](function(e){this.trigger({action:t,payload:[]})}.bind(this))},onSwapRoomsWithOtherMeetings:function(e,t,n){var i=m.update({url:m.ENDPOINTS.swap_room_submit,data:{from_meeting_uuid:this.current_meeting_uuid||meetingInfo.request.uuid||"",to_meeting_uuid:e.toMeeting,send_ics:e.sendIcs}});i.then(function(n){this.trigger({action:t,payload:n.data}),this.trigger({action:"renderUserInvitessList",data:this.getSwapableRoomdata(e.toMeeting)})}.bind(this)),i[i.fail?"fail":"catch"](function(e){var t=[];e.responseJSON&&"object"===l(e.responseJSON.errors)&&(t=_.flatten(_.values(e.responseJSON.errors))),this.trigger({action:n,payload:t.join(", ")})}.bind(this))}});t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/SwapRoom/store.js","/app/scripts/Book/SwapRoom")},{"./actions":60,_process:114,buffer:112,common_api:"common_api"}],63:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./ConsecutiveMeetings/stores/mainStore"),f=e("../CommentsModal"),m=window.envDetails.isConsecutiveMeeting,h=$(".notification-modal"),_=function(){return{isEmailNotification:function(e,t){var n=(e&&e.invite_status||"").toLowerCase(),i=window.meetingInfo&&window.meetingInfo.request&&window.meetingInfo.request.status||"";return i=i.toLowerCase(),!1!==t.enabled&&!("accepted"===n&&"approved"===i)},isDeclineCommentEnabled:function(e){var t=window.meetingInfo&&window.meetingInfo.request,n=t.invite_options,i=t.users.external,o=!1,a=!1;return i=i.map(function(e){return e.uuid}),n&&("yes"===n.decline_comments_enabled&&(o=!0),window.envDetails.isConsecutiveMeeting&&n.show_options_for_external&&e&&-1!==i.indexOf(e)&&(o=a="yes"===n.show_options_for_external)),{enabled:o,showOnlyOthers:a}},cancelMeeting:function(e){var t=e.callback,n=e.cancelAll,i=n!==undefined&&n,o=m?l.currMeetingInProgress:window.meetingInfo&&window.meetingInfo.request,a=(o=o||{}).cancel_options,s=(a=a===undefined?{}:a).cancel_comments_enabled,r=a.predefined_cancel_comments,d=r===undefined?[]:r,c=a.cancel_comments_enabled_cm,u=i&&"yes"===c,_=u?[]:d;u||"yes"===s?f.show({comments:_,callback:t,type:"cancel"}):h.notificationModal({type:"confirmation",title:i18n.t("cancel_meeting_title"),body:i18n.t("cancel_meeting_confirmation"),"class":"blue",done:function(){return t()}})}}}();t.exports=_}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/commonHandlerUtility.js","/app/scripts/Book")},{"../CommentsModal":66,"./ConsecutiveMeetings/stores/mainStore":31,_process:114,buffer:112}],64:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){t.exports=function(){var t=e("common_api"),n=e("./Attendee/handler"),i=e("./MeetingType/handler"),o=e("./Calendar/handler"),a=e("./MeetingInMaking/handler"),s=e("./MeetingView/handler"),r=e("../Sfdc/SfdcAccount/handler"),d=e("../Sfdc/SfdcLeads/handler"),c=e("./OngoingSales/handler"),u=(e("./ExternalRequest/handler"),e("./RequestorMailers/handler")),l=(e("./Expert/handler"),e("../Attachments/handler")),f=e("./SwapRoom/handler"),m=e("./ConsecutiveMeetings/handlers/mainHandler"),h=e("./ConsecutiveMeetings/handlers/currentMeetingHandler"),_=e("./ConsecutiveMeetings/handlers/meetingSubmitHandler"),p=e("./ConsecutiveMeetings/handlers/editHandler"),g=e("./ConsecutiveMeetings/handlers/viewHandler"),v=e("./ConsecutiveMeetings/handlers/meetingActionsHandler"),y=e("../CopyCustomerInfo/handler"),b=e("./ChangeMeetingType/handler"),w=e("../PartialParticipation/handler"),M=e("../commons/block_token"),C=e("./meetingTabSelectionHandler"),S=e("../UserForms/handler"),A=e("./PageNavigation"),x=e("../utils");C.init(),"new"===window.mode&&A.isHistoryEnabled()&&A.init();var D=function(){if(rails_to_html.topic_config&&"true"===String(rails_to_html.topic_config.topic_management_enabled)){var e=$("#js-select-topic-holder");$("#js-selected-topic-text").removeClass("hide"),e.removeClass("hide")}rails_to_html.activity_name&&$(".js-activity-name").html(rails_to_html.activity_name),rails_to_html.event_task_activity&&$(".js-activity-task-name").text(rails_to_html.event_task_activity)};window.envDetails.setBlockToken=M,y.init(e("./Attendee/store").AttendeeStore,e("./ConsecutiveMeetings/stores/mainStore")),l.init(),w.init({path:"view"===mode?"book_meeting_view":"book_meeting"}),isOngoingSales&&c.init(),"view"!==mode?(envDetails.isConsecutiveMeeting?(m.init(),h.init(),_.init(),"edit"===mode&&(p.init(),v.init())):D(),o.init(),"edit"===mode&&(f.init(),b.init()),a.init(),"undefined"!=typeof jiffle?S.init({callback:function(){window.isLeadsMeeting?"new"===mode?t.sfdcHandler.fetchLeadDetails().then(function(){d.init()}):d.init():r.init(),n.init.apply(null,arguments),i.init()},templateName:"add_attendee_form",isNewUser:!0}):(n.init(),i.init()),u.init({mountPoint:$("#proceed_page"),isSFDC:$("#sf-jiffle-now").length,isFromBookMeeting:!0,meetingRequestUuid:meetingInfo.request.uuid,meetingRequestor:meetingInfo.request.requestor})):envDetails.isConsecutiveMeeting?(g.init(),v.init()):(D(),s.init());var k=window.meetingInfo&&window.meetingInfo.request&&window.meetingInfo.request.invite_options;x.updateDeclineComments(k)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/init_book.js","/app/scripts/Book")},{"../Attachments/handler":4,"../CopyCustomerInfo/handler":69,"../PartialParticipation/handler":76,"../Sfdc/SfdcAccount/handler":82,"../Sfdc/SfdcLeads/handler":84,"../UserForms/handler":89,"../commons/block_token":92,"../utils":110,"./Attendee/handler":9,"./Attendee/store":10,"./Calendar/handler":14,"./ChangeMeetingType/handler":17,"./ConsecutiveMeetings/handlers/currentMeetingHandler":21,"./ConsecutiveMeetings/handlers/editHandler":22,"./ConsecutiveMeetings/handlers/mainHandler":23,"./ConsecutiveMeetings/handlers/meetingActionsHandler":24,"./ConsecutiveMeetings/handlers/meetingSubmitHandler":25,"./ConsecutiveMeetings/handlers/viewHandler":26,"./ConsecutiveMeetings/stores/mainStore":31,"./Expert/handler":37,"./ExternalRequest/handler":40,"./MeetingInMaking/handler":46,"./MeetingType/handler":49,"./MeetingView/handler":51,"./OngoingSales/handler":53,"./PageNavigation":55,"./RequestorMailers/handler":58,"./SwapRoom/handler":61,"./meetingTabSelectionHandler":65,_process:114,buffer:112,common_api:"common_api"}],65:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=window.$("#meet-details");function l(e){window.location.hash="targetId_"+window.$(e.target).attr("href").substr(1)}t.exports={init:function(){var e;u.on("shown.bs.tab",l),(e=window.location.hash.replace("targetId_",""))&&u.find('a[href="'+e+'"]').tab("show")}}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Book/meetingTabSelectionHandler.js","/app/scripts/Book")},{_process:114,buffer:112}],66:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=function(){var e=$("#comments_modal"),t=e.find(".js-comments"),n=e.find(".js-others-comments"),i=e.find(".js-action-btn"),o=e.find(".comment-error"),a=e.find(".modal-title"),s=e.find(".note-footer"),r="Other",d=$.noop,c=[];function u(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return e=e.filter(function(e){return e}),[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e),[r]).map(function(e){return{id:e,text:e}})}function l(){var e=t.val();n[e===r?"removeClass":"addClass"]("hide").val(""),o.removeClass("show")}function f(i){i.preventDefault();var a=t.val();if(a===r){var s=function(){var e=n.val();return o[e?"removeClass":"addClass"]("show"),e}();if(!s)return;a=s}d(a),e.modal("hide")}return i.on("click",f),t.on("change",l),{show:function(n){var o=n.comments,r=o===undefined?[]:o,l=n.callback,f=l===undefined?d:l,m=n.type,h=m===undefined?"decline":m;d=f,function(e){c=u(e),t.data("select2")&&t.select2("destroy").html(""),t.select2({minimumResultsForSearch:-1,data:c,width:"100%"});var n=c[0].id;t.val(n).trigger("change")}(r),function(e){var t=i18n.t("comments_title",{type:e}),n=i18n.t("comments_"+e),o=i18n.t("comments_"+e+"_footer");a.text(t),i.text(n),s.html(o)}(h);var _=c[0].id;t.val(_).trigger("change"),e.modal({backdrop:"static"})}}}();t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/CommentsModal/index.js","/app/scripts/CommentsModal")},{_process:114,buffer:112}],67:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){$(document).ready(function(){initI18n(Object.assign({},enLocale.consent,enLocale.opt_in_messages)),$("#accept_consent_form").validate({errorElement:"div",highlight:function(e,t){$(e).parent().addClass("has-error")},success:function(e,t){$(t).parent().removeClass("has-error")},rules:{consent:{required:!0}},messages:{consent:{required:i18n.t("register_user_consent_missing_message")}}}),setupUiI18n()});var l=e("common_api");t.exports=function(e){$('#accept_consent_form input[name="consent"]').siblings("label").html(e.logged_in_consent_message),$("#accept_consent_form").on("submit",function(e){e.preventDefault();var t=$(e.currentTarget);if(t.valid()){var n=l.update({url:l.ENDPOINTS.portal+l.ENDPOINTS.give_consent,data:t.serializeObject()});n.then(function(e){200===e.status&&window.location.reload()}.bind(this)),n[n.fail?"fail":"catch"](function(e){console.log(e)}.bind(this))}})}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Consent/app.js","/app/scripts/Consent")},{_process:114,buffer:112,common_api:"common_api"}],68:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["fetchMeetings","fetchFields","searchMeetings","fetchCopyAttendeeMeetings","fetchMeetingAttendees"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/CopyCustomerInfo/actions.js","/app/scripts/CopyCustomerInfo")},{_process:114,buffer:112}],69:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("./store"),m=e("../Book/Attendee/actions"),h=function(){var e,t,n,i=$(".copy-customer-info"),o=$(".js-meeting-search"),a=$(".import-customer-info"),s="hh:mm A",r="ddd, MMM D, YYYY",d="YYYY-MM-DD HH:mm A",c=$(".notification-modal"),u=$("#copy_customer_info_modal"),h=$("#copy_meeting_list"),p=$("#dynamic_form"),g=!0;var v={onFetchMeetingsSuccess:function(t){n=t,_.each(n,function(e){e.startTime=moment(e.start_time,d).format(s),e.endTime=moment(e.end_time,d).format(s),e.meetingDate=moment(e.start_time,d).format(r)});var n;var i=HandlebarsTemplates["book/copy_meeting_list"]({meetingList:t,showParticipants:f.getCopyAttendeeState()});h.html(i),u.modal({backdrop:"static"}),u.find("form").on("submit",function(){return!1}),e&&$("#meetingCard_"+e).prop("checked",!0)},onFetchFieldsSuccess:function(e){R(),_.isArray(e.data.results)&&p.formRenderer().copyValues(e.data.results)},showNoMeetingNotif:function(){var e=f.getCopyAttendeeState()?i18n.t("no_meetings_to_copy_attendee"):i18n.t("no_meetings_to_copy_body");c.notificationModal({type:"notification","class":"red",title:i18n.t("no_meetings_to_copy_title"),body:e})},showErrorMessage:function(){c.notificationModal({type:"notification","class":"red",title:i18n.t("failure"),body:i18n.t("something_went_wrong")})},onFetchMeetingAttendeesSuccess:function(e){R();var t=_.groupBy(e.data.items,"user_type");t.internal=t.internal||[],t.external=t.external||[],m.copyAttendees(t)},onCopyAttendees:function(e){var n=e.internalCount,i=e.externalCount,o=e.hasCurrUser;if(n||i){if(o){m.updateAreYouAttending("yes"),$("#attend-meeting-yes").prop("checked",!0),$("a","#attendingStatus").html(i18n.t("you_are_attending"));var a=envDetails.currentUser.first_name+" "+envDetails.currentUser.last_name+", ";$("#logged-in-user-label").text(a),$("div.blue-container").slideUp(),$("#attendingStatus").find(".jif-dropright-filled").removeClass("hide").next().addClass("hide")}$("#attendee-label").closest(".header-right").removeClass("hide");var s=_.find(scheduler._events,function(e){return"existing-briefing-meeting"!=e.type});s&&scheduler.deleteEvent(s.id)}!function(e){var n=f.getInternalParticipantsCount(),i=f.getExternalParticipantsCount(),o=e.internalCount,a=e.externalCount,s=o+" out of "+n+" internal attendee(s) have been copied.",r=a+" out of "+i+" external attendee(s) have been copied.";1==t.isInternalAttendeesHidden()&&(e.hasCurrUser&&0!=o||(s=""));(t.isExternalAttendeesHidden()||window.isEBCEvent)&&(r="");var d="";s&&(d+=s+"<br>");r&&(d+=r);c.notificationModal({type:"notification","class":"green",title:i18n.t("success"),body:d})}(e)}};function y(){var e=_.find($("input[type='radio'][name='meetingCard']"),function(e){return $(e).is(":checked")});return $(e).data("uuid")}function b(){if(y())if(f.getCopyAttendeeState())f.resetParticipantsCount(),l.fetchMeetingAttendees(M());else{var e=!1;c.notificationModal({type:"confirmation","class":"blue",body:i18n.t($("#meetingCard_"+y()).data("activity-uuid")===(envDetails.isConsecutiveMeeting?selectedConsecutiveUuid:selectedActivityUuid)?"confirmation_for_import_customer_info":"confirmation_for_import_customer_info_for_cross_meeting_type",{meetingWithLabel:$("#meeting_with").closest(".form-group").find("label").text()}),title:i18n.t("are_you_sure"),done:function(){e=!0},dismiss:function(){e&&l.fetchFields(M()),w()}})}else c.notificationModal({type:"notification","class":"yellow",title:(t=f.getCopyAttendeeState()?i18n.t("copy_attendees"):i18n.t("copy_details"),i18n.t("pls_select_meeting_title",{info:t})),body:function(){var e=f.getCopyAttendeeState()?i18n.t("copy_attendees"):i18n.t("copy_customer_info");return i18n.t("pls_select_meeting_body",{info:e})}(),dismiss:function(){w()}});var t}function w(){$("body").addClass("modal-open")}function M(){var e={};return _.extend(e,D(),k(),{selected_resource_uuid:y()}),f.getCopyAttendeeState()&&(_.extend(e,function(){var e={topic_uuid:""};if(envDetails.topicManagementEnabled&&envDetails.topicUserMappingEnabled)if("undefined"!=typeof topic_uuid)e.topic_uuid=topic_uuid;else if("new"===mode){var t=$("#topic_management").val();"-"===t&&(t=""),e.topic_uuid=t}else e.topic_uuid=meetingInfo.request.topic_uuid;return e}(),C(),{ignore_activity:!0,user_type:"internal"}),envDetails.isConsecutiveMeeting&&_.extend(e,n.getRemainingMeetingsData(),{activity_uuid:selectedActivityUuid})),e}function C(){var e=envDetails.isBookSessionEdit&&envDetails.isBookSessionEdit()?"nomination":"meeting";return{meeting_request:"edit"==mode?window[e+"Info"].request.uuid:""}}function S(){var t=$(this).val();e=y(),l.searchMeetings(x(),t)}function A(){f.setCopyAttendeeState($(this).hasClass("js-copy-attendee")),g=!0,T()}function x(){var e={};return _.extend(e,D(),function(){if(envDetails.isBookSession&&envDetails.isBookSession())return{uuid:nominationInfo.request.uuid};if(envDetails.isConsecutiveMeeting)return{uuid:envDetails.consecutive_meeting_uuid};if(meetingInfo&&meetingInfo.request)return{uuid:meetingInfo.request.uuid}}(),k(),C()),e}function D(){return{activity_uuid:envDetails.isConsecutiveMeeting?selectedConsecutiveUuid:selectedActivityUuid}}function k(){if(envDetails.isBookSession&&envDetails.isBookSession()){var e=_.find($("input[name='sessionCard']"),function(e){return $(e).prop("checked")});return{additional_params:{session_uuid:$(e).data("uuid")}}}return{additional_params:{}}}function T(){f.getCurrentPage()<=f.getTotalPageCount()&&g&&(e=y(),l.fetchMeetings(x(),f.getCurrentPage()))}function E(){h.scrollTop(0,0),o.val(""),e="",g=!1,$("input[type='radio'][name='meetingCard']").prop("checked",!1),f.setCurrentPage(1),f.setTotalPageCount(1),f.resetMeetingList(),f.resetFilter(),f.setCopyAttendeeState(!1)}function I(){var e=f.getCopyAttendeeState()?i18n.t("copy_attendees"):i18n.t("copy_information");u.find(".js-copy-model-header").html(i18n.t("select_meeting_you_want_to_copy",{info:e}))}function R(){u.modal("hide")}return{init:function(e,s){t=e,n=s,"view"===mode||$("#sf-jiffle-now").length||mapping_module?i.addClass("hide"):(f.listen(function(e){var t=v[e.type];t&&t(e.data)}),t&&t.listen(function(e){var t=v[e.type];t&&t(e)}),i.on("click",A),u.on("hide.bs.modal",E),u.on("show.bs.modal",I),o.on("keyup",_.debounce(S,500)),a.on("click",b),h.infiniteScroll({offset:200,callback:T}))}}}();t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/CopyCustomerInfo/handler.js","/app/scripts/CopyCustomerInfo")},{"../Book/Attendee/actions":8,"./actions":68,"./store":71,_process:114,buffer:112}],70:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){t.exports={initPaginationEntities:function(){this.current_page=1,this.total_pages=1,this.fetching=!1,this.per_page_meeting_count=10,this.totalMeetings=0,this.filters={},this.copyAttendee=!1,this.external_participants_count=0,this.internal_participants_count=0},fetchFirstPage:function(){this.setCurrentPage(1),this.resetMeetingList(),this.onFetchMeetings(1)},onSearchMeetings:function(e,t){this.filters.search=t,this.setCurrentPage(1),this.resetMeetingList(),this.onFetchMeetings(e,1)},resetFilter:function(){this.filters={}},getFetchState:function(){return this.fetching},updateFetchState:function(e){this.fetching=e},getCurrentPage:function(){return this.current_page},resetMeetingList:function(){this.meetings=[]},setCurrentPage:function(e){this.current_page=e},getTotalPageCount:function(){return this.total_pages},setTotalPageCount:function(e){this.total_pages=e},updateTotalMeetingCount:function(e){this.totalMeetings=e},setCopyAttendeeState:function(e){this.copyAttendee=e},getCopyAttendeeState:function(e){return this.copyAttendee},setExternalParticipantsCount:function(e){this.external_participants_count=e},getExternalParticipantsCount:function(e){return this.external_participants_count},setInternalParticipantsCount:function(e){this.internal_participants_count=e},getInternalParticipantsCount:function(e){return this.internal_participants_count},resetParticipantsCount:function(){this.setExternalParticipantsCount(0),this.setInternalParticipantsCount(0)}}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/CopyCustomerInfo/paginationStore.js","/app/scripts/CopyCustomerInfo")},{_process:114,buffer:112}],71:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=e("./paginationStore"),h=Reflux.createStore({init:function(){this.listenToMany(l),this.meetings=[],this.initPaginationEntities()},mixins:[m],onFetchMeetings:function(e,t,n){if(0==this.getFetchState()){this.updateFetchState(!0),_.extend(e,{page:t,per_page:n||this.per_page_meeting_count,filters:this.filters});var i=this.getCopyAttendeeState()?f.ENDPOINTS.fetch_meeting_list_copy_attendee:f.ENDPOINTS.fetch_meeting_list_customer_info,o=f.fetch({url:i,data:e});o.then(function(e){this.meetings=this.meetings.concat(e.data.meeting_requests),this.updateFetchState(!1),this.meetings.length||!_.isEmpty(this.filters.search)?(this.setCurrentPage(this.getCurrentPage()+1),this.updateTotalMeetingCount(e.data.total_entries),this.setTotalPageCount(Math.ceil(e.data.total_entries/this.per_page_meeting_count)),this.trigger({type:"onFetchMeetingsSuccess",data:this.meetings})):this.trigger({type:"showNoMeetingNotif",data:e})}.bind(this)),o[o.fail?"fail":"catch"](function(){this.updateFetchState(!1),this.trigger({type:"showErrorMessage"})}.bind(this))}},onFetchFields:function(e){var t=f.fetch({url:f.ENDPOINTS.fetch_customer_info_values,data:e});t.then(function(e){this.trigger({type:"onFetchFieldsSuccess",data:e})}.bind(this)),t[t.fail?"fail":"catch"](function(){this.trigger({type:"showErrorMessage"})}.bind(this))},onFetchMeetingAttendees:function(e){var t=f.fetch({url:f.ENDPOINTS.fetch_meeting_attendee,data:e});t.then(function(e){this.setInternalParticipantsCount(e.data.internal_participant_count),this.setExternalParticipantsCount(e.data.external_participant_count),this.trigger({type:"onFetchMeetingAttendeesSuccess",data:e})}.bind(this)),t[t.fail?"fail":"catch"](function(){this.trigger({type:"showErrorMessage"})}.bind(this))}});t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/CopyCustomerInfo/store.js","/app/scripts/CopyCustomerInfo")},{"./actions":68,"./paginationStore":70,_process:114,buffer:112,common_api:"common_api"}],72:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["listNotes","createNote","updateNote","deleteNote"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Notes/actions.js","/app/scripts/Notes")},{_process:114,buffer:112}],73:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("./store"),m=function(){var e,t=$("#meeting-notes"),n=$(".notification-modal"),i=$("#fetch-more-notes"),o={entityUuid:"",fetchUrl:"",createUrl:"",mountPoint:""},a={listNotes:function(t){var n=(0,HandlebarsTemplates["notes/note-list"])(function(e){return{headerLabel:i18n.t("note_label",{type:i18n.t("add_note")}),buttonLabel:i18n.t("create"),action:"create",notes:e,visibility:[{name:"mms",displayName:"Meeting Managers",value:!0}]}}(t));e.html(n)},SuccessNoteCreation:function(e){n.notificationModal({body:i18n.t("note_create_success"),title:i18n.t("success_header"),type:"notification","class":"green",dismiss:function(){s(),t.animate({scrollTop:0},"fast")}})},SuccessNoteUpdation:function(e){n.notificationModal({body:i18n.t("note_update_success"),title:i18n.t("success_header"),type:"notification","class":"green",dismiss:function(){s(),t.animate({scrollTop:0},"fast")}})},onDeleteSuccess:function(e){n.notificationModal({body:e,title:i18n.t("success_header"),type:"notification","class":"green",dismiss:function(){s()}})},onDeleteFailure:function(){n.notificationModal({body:data.message,title:i18n.t("failure_header"),type:"notification","class":"red",dismiss:function(){s()}})}};function s(){var e=d().fetchUrl;l.listNotes(e,1)}var r=function(){f.getCurrentPage()<=f.getTotalPageCount()&&l.listNotes(d().fetchUrl,f.getCurrentPage())};function d(){return o}function c(){$(this).siblings("ul.note-vis-to").toggle()}function u(t){t.preventDefault(),t.stopPropagation();var n=y("create");v(n.note)&&(e.find("#js-create-note-content").val(""),l.createNote(n))}function m(t){h();var n=$(t.currentTarget).data("uuid"),i=$(t.currentTarget).parents().find("#note_"+n).text(),o=Handlebars.partials["notes/_note_create"]({headerLabel:i18n.t("note_label",{type:i18n.t("edit")}),buttonLabel:i18n.t("update"),action:"update",note_data:i,visibility:f.getNoteVisibilty(n)});f.setCurrentEditableNoteUuid(n),$(t.currentTarget).parents(".jn-c-note-block").replaceWith(o),e.find("#js-note-update-module textarea").focusToEnd()}function h(){var t=f.getNoteUuid();if(t){var n=f.getNoteDetails(t),i=Handlebars.partials["notes/_note"](n);e.find("#js-note-update-module").replaceWith(i)}}function p(t){t.preventDefault(),t.stopPropagation();var n=y("update"),i=f.getNoteUuid(),o=f.getNoteUrl(i).update;_.merge(n,{updateUrl:o}),v(n.note)&&(e.find("#js-update-note-content").val(""),l.updateNote(n))}function g(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget).data("uuid"),i=f.getNoteUrl(t).destroy,o=!1;n.notificationModal({type:"confirmation","class":"blue",title:i18n.t("delete_confirm_heder"),body:i18n.t("delete_confirm_body"),done:function(){o=!0},dismiss:function(){o&&l.deleteNote(i,"onDeleteSuccess","onDeleteFailure")}})}function v(e){return _.trim(e).length>0}function y(t){return{note:e.find("#js-"+t+"-note-content").val(),createUrl:d().createUrl,visibility:function(e){var t=$("#visibleTo"+e).find(".vis-note:checked~label").text();return""==t?[]:[t]}(t)}}return $.fn.focusToEnd=function(){return this.each(function(){var e=$(this).val();$(this).focus().val("").val(e)})},{init:function(t){!function(e){_.merge(o,e)}(t),function(t){e=$(t.mountPoint)}(t),f.listen(function(e){var t=e.action,n=a[t];_.isFunction(n)&&n(e.data)}),e.on("click","#js-create-note",u),e.on("click","#js-edit-note",m),e.on("click",".close-edit-note",h),e.on("click","#js-update-note",p),e.on("click","#js-delete-note",g),e.on("click",".note-visibility",c),$(document).on("appear","#fetch-more-notes",r),$(document).click(function(e){$(e.target).is(":not(.multiselect-close *)")&&$(e.currentTarget).find(".note-vis-to").hide()}),s(),i.appear()}}}();t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Notes/handler.js","/app/scripts/Notes")},{"./actions":72,"./store":74,_process:114,buffer:112}],74:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=Reflux.createStore({init:function(){this.listenToMany(l),this.setNoteUrlsHash={},this.notes=[],this.current_page=1,this.per_page_count=10,this.fetching=!1,this.currentEditableUuid="",this.notesVisibility={}},setNoteData:function(e){_.each(e,function(e){this.setNoteUrl(e),this.setNoteVisibility(e)}.bind(this))},setNoteUrl:function(e){this.setNoteUrlsHash[e.uuid]=e.note_urls},setNoteVisibility:function(e){var t=[];_.each(e.formatted_visibility,function(e){t.push({name:e.name,displayName:e.display_name,value:e.selected})}),this.notesVisibility[e.uuid]=t},getNoteVisibilty:function(e){return this.notesVisibility[e]},setCurrentEditableNoteUuid:function(e){this.currentEditableUuid=e},getNoteUuid:function(){return this.currentEditableUuid},getNoteUrl:function(e){return this.setNoteUrlsHash[e]},resetNotes:function(){this.notes=[],this.setNoteUrlsHash={},this.current_page=1},getNoteDetails:function(e){return _.find(this.notes,function(t){return t.uuid==e})},setCurrentPage:function(e){this.current_page=e},getCurrentPage:function(){return this.current_page},setTotalPageCount:function(e){this.total_pages=e},getTotalPageCount:function(){return this.total_pages},updateFetchState:function(e){this.fetching=e},getFetchState:function(e){return this.fetching},onListNotes:function(e,t){if(0==this.getFetchState()){this.updateFetchState(!0);var n=_.merge({page:t,per_page:this.per_page_count});f.fetch({url:e,data:n}).then(function(e){this.notes=this.notes.concat(e.data),this.setCurrentPage(this.getCurrentPage()+1),this.setTotalPageCount(Math.ceil(e.total_entries/this.per_page_count)),this.setNoteData(this.notes),this.trigger({action:"listNotes",data:this.notes}),this.updateFetchState(!1)}.bind(this))}},onCreateNote:function(e){f.update({url:e.createUrl,data:{note:e.note,visibility:e.visibility}}).then(function(e){this.resetNotes(),this.trigger({action:"SuccessNoteCreation",data:e.data})}.bind(this))},onUpdateNote:function(e){f.update({url:e.updateUrl,data:{note:e.note,visibility:e.visibility}}).then(function(e){this.resetNotes(),this.trigger({action:"SuccessNoteUpdation",data:e.data})}.bind(this))},onDeleteNote:function(e,t,n){var i=f.update({url:e});i.then(function(e){this.resetNotes(),this.trigger({action:t,data:e.message})}.bind(this)),i[i.fail?"fail":"catch"](function(e){this.trigger({action:n,data:e.message})}.bind(this))}});t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Notes/store.js","/app/scripts/Notes")},{"./actions":72,_process:114,buffer:112,common_api:"common_api"}],75:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["setPartialTime","sendPartialTime","checkAvailability"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/PartialParticipation/actions.js","/app/scripts/PartialParticipation")},{_process:114,buffer:112}],76:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,a=undefined;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(d){o=!0,a=d}finally{try{!i&&r["return"]&&r["return"]()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=e("./actions"),m=e("./store"),h=e("../commons/participation_validator"),p=e("../commons/date_format"),g=(e("../Book/MeetingInMaking/store"),function(){var t,n,i,o=$("#participation-start-time"),a=$("#participation-end-time"),s=$("#submit_partial_participation"),r=$("#participation_modal"),d=$(".notification-modal"),c=$(".js-partial-participation-label"),u=$(".edit-btn"),g=".js-participation-form",v={attendeeDetailsPath:null,eventStartDate:null,eventEndDate:null,submitAction:null,meetingUuid:null},y={onSetPartialParticipation:function(e){d.notificationModal({type:"notification",title:i18n.t("participation_updated_title_message"),body:e.message});var t=v.attendeeDetailsPath(),n=_.reduce(e.user_participation,function(e,t,n){return e.uuid=n,e.partial_start_time=p.convertDateTimeServerToTime(t.partial_start_time),e.partial_end_time=p.convertDateTimeServerToTime(t.partial_end_time),e},{}),i=_.find(t,{uuid:n.uuid});i.partial_start_time=n.partial_start_time,i.partial_end_time=n.partial_end_time},onCheckAvailabilityComplete:function(e){var n=o.val(),i=a.val();"available"===e?(r.modal("hide"),f[v.submitAction](t,n,i,v.eventStartDate())):$("#general-error-message").html(i18n.t("attendee_time_unavailable")).removeClass("hide")},onCheckAvailabilityFailed:function(){$("#general-error-message").html(i18n.t("availability_check_failed")).removeClass("show")}};function b(e){w();var n=p.jsDateToDateFormat(v.eventStartDate()),s=n+" "+o.val(),r=n+" "+a.val();i.form()&&f.checkAvailability(t,v.meetingUuid(),s,r)}function w(){i&&i.reset(),$(g+" .error-class").remove(),$("#general-error-message").empty().addClass("hide"),$(".form-group",g).removeClass("has-error")}function M(e){t=$(this).data("uuid"),t=_.isEmpty(t)?window.envDetails.currentUser.uuid:t;var n=_.find(v.attendeeDetailsPath(),{uuid:t}),s=function(e){if(e.partial_start_time&&e.partial_end_time)var t=e.partial_start_time,n=e.partial_end_time;else var t=p.jsDateToTime(v.eventStartDate()),n=p.jsDateToTime(v.eventEndDate());return[t,n]}(n),d=l(s,2),f=d[0],m=d[1];w(),$(g).data("validator",null),i=h(v.eventStartDate(),v.eventEndDate()),o.val(f),a.val(m),c.text(i18n.t("partial_participation_modal_body",{user_name:n.user_name})),r.modal();var y,b=!0===n.edit_partial_participation;y=!b,u.toggleClass("hide",y),$([o.get(0),a.get(0)]).prop("disabled",y)}return{init:function(t){!function(t){switch(v.meetingUuid=function(){return meetingInfo.request.uuid},t.path){case"book_meeting":n=e("../Book/MeetingInMaking/store"),v.attendeeDetailsPath=function(){return n.model.internal},v.eventStartDate=function(){return n.model.event.start_date},v.eventEndDate=function(){if(!function(e,t){var n=meetingInfo.request.meeting_break_settings;if("yes"!==n.meeting_break_enabled)return!1;var i=moment.duration(moment(t).diff(moment(e))).asMinutes(),o=Number(n.meeting_break_meeting_duration);return i>=o}(n.model.event.start_date,n.model.event.end_date))return n.model.event.end_date;var e=Number(meetingInfo.request.meeting_break_settings.meeting_break_duration),t=moment(n.model.event.end_date);return t.subtract(e,"minutes").toDate()},v.submitAction="setPartialTime";break;case"book_meeting_view":v.attendeeDetailsPath=function(){return window.meetingInfo.request.users.internal},v.eventStartDate=function(){return p.convertDateTimeServerToJsDate(meetingInfo.request.start_time)},v.eventEndDate=function(){var e=moment(p.convertDateTimeServerToJsDate(meetingInfo.request.end_time));return e.subtract(meetingInfo.request.meeting_break.meeting_break_duration,"minutes").toDate()},v.submitAction="sendPartialTime"}}(t),$(".selected-attendee-list").on("click",".attendee_participation",M),$(".participation-meeting").on("click",M),s.on("click",b),$(g).on("change",".js-time-input",function(){$("#general-error-message").empty().addClass("hide")}),m.listen(function(e){var t=y[e.type];t&&t(e.data)})}}}());t.exports=g}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/PartialParticipation/handler.js","/app/scripts/PartialParticipation")},{"../Book/MeetingInMaking/store":47,"../commons/date_format":96,"../commons/participation_validator":99,"./actions":75,"./store":77,_process:114,buffer:112}],77:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=e("../commons/date_format"),h=Reflux.createStore({init:function(){this.listenToMany(l)},onSetPartialTime:function(e,t,n){var i={uuid:e,startTime:t,endTime:n};this.trigger({action:"setParticipationTime",data:i})},onCheckAvailability:function(e,t,n,i){if("new"===window.mode)return this.trigger({type:"onCheckAvailabilityComplete",data:"available"});var o=f.fetch({url:f.replaceUrlParams(f.ENDPOINTS.check_attendee_availability,["{uuid}",e]).url,data:{start_time:n,end_time:i,meeting_uuid:t}});o.then(function(e){this.trigger({type:"onCheckAvailabilityComplete",data:e.data.availability})}.bind(this)),o[o.fail?"fail":"catch"](function(e){this.trigger({type:"onCheckAvailabilityFailed",data:e})}.bind(this))},onSendPartialTime:function(e,t,n,i){i=m.jsDateToDateFormat(i);var o={uuid:meetingInfo.request.uuid,user_participation:{}};o.user_participation[e]={partial_start_time:i+" "+t,partial_end_time:i+" "+n},f.update({url:f.ENDPOINTS.set_participation,data:o}).then(function(e){this.trigger({type:"onSetPartialParticipation",data:_.merge(e,o)})}.bind(this))}});t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/PartialParticipation/store.js","/app/scripts/PartialParticipation")},{"../commons/date_format":96,"./actions":75,_process:114,buffer:112,common_api:"common_api"}],78:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=window.Reflux.createActions(["fetchReviews","updateReview"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Reviews/actions.js","/app/scripts/Reviews")},{_process:114,buffer:112}],79:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("./store"),m=function(){var e={mountPoint:"",fetchUrl:"",updateUrl:"",entityUuid:"",entityType:""},t=".jn-c-mm-review-list",n=".js_collapse_btn",i=".jn-c-review-list-block-container",o=".js_limit_view",a=".js_expanded_view",s=".js_icons_list",r=window.$(".notification-modal"),d={1:"upvote",0:"neutral","-1":"downvote"},c=window.HandlebarsTemplates["reviews/review_list"],u=window.HandlebarsTemplates["reviews/review_ea_multiple"],m=window.Handlebars.partials["reviews/_review_edit"],h={fetch:function(e){var t=(r=e.reviewees,window._.map(r,function(e){return g(e)})),n=(s=e.reviewers,window._.map(s,function(e){return function(e){var t=p(e),n=e.review;return t.upvote="hide",t.downvote="hide",t[d[n.vote]]="",t}(e)})),i=(a=e.mm,window._.map(a,function(e){return function(e){var t,n=e.review_summary;return{firstName:e.first_name,lastName:e.last_name,upVoteCount:n.upvote,downVoteCount:n.downvote,commentCount:n.comment,uuid:e.uuid,reviews:(t=e.reviews,window._.map(t,function(e){var t={name:e.name,title:e.title,companyName:e.company_name,comment:e.comment,upvote:"hide",downvote:"hide"};return t[d[e.vote]]="",t}))}}(e)})),o=c({reviewees:t,reviewers:n,isReviewed:n.length>0,mmData:i});var a;var s;var r;y("mountNode").html(o)},updateSuccess:function(e){r.notificationModal({"class":"green",title:window.i18n.t("review_save_title"),body:window.i18n.t("review_save_message")}),S(e)},deleteSuccess:function(e){S(e)}};function p(e){var t=e.review;return{name:e.name,title:e.title,companyName:e.company_name,comment:t.comment}}function g(e){var t=p(e),n=e.review;return t.revieweeUuid=e.uuid,t.reviewUuid=n.uuid||"",t.editable=e.review.can_edit,n.comment||1===n.vote||-1===n.vote?t.isCreate=!1:t.isCreate=!0,t.commented=_.isEmpty(n.comment)?"":"active",t.updatedTime=n.updated_time,t.editable?t[d[n.vote]]="active":(t.upvote="hide",t.downvote="hide",t[d[n.vote]]=""),t}function v(e,t){e.html(m(g(t)))}function y(t){return e[t]}function b(e){e.preventDefault(),window.$(this).toggleClass("active"),window.$(this).siblings(".review-vote").removeClass("active"),window.$(this).parent().siblings(".collapse").collapse("show")}function w(e){window.$(this).parent().siblings(".collapse").collapse("show")}function M(e){return{vote:function(e){var t=e.find(".review-vote.active");return t.is(".review-yes")?1:t.is(".review-no")?-1:0}(e),uuid:e.data("review_uuid"),comment:e.find("textarea").val(),entity_uuid:y("entityUuid"),entity_type:y("entityType"),reviewee_uuid:e.data("reviewee_uuid")}}function C(){var e=window.$(this).parents(".review-item");l.updateReview(y("updateUrl"),M(e),"updateSuccess")}function S(e){e.can_edit=!0;var t=f.getReviewee(e.reviewee_uuid);t&&(t.review=e,v(window.$(k(e.reviewee_uuid)),t))}function A(e){e.preventDefault(),e.stopPropagation();var t=window.$(this);t.siblings(i).collapse("show"),t.find(n).removeClass("hide"),t.find(s).addClass("hide"),t.find(o).addClass("hide"),t.find(a).removeClass("hide")}function x(e){e.stopPropagation(),e.preventDefault();var r=window.$(this).closest(t);r.siblings(i).collapse("hide"),r.find(n).addClass("hide"),r.find(s).removeClass("hide"),r.find(o).removeClass("hide"),r.find(a).addClass("hide")}function D(e){var t=window.$(this).parents(".review-item").data("reviewee_uuid"),n=f.getReviewee(t);window.$(this).parents(".collapse").collapse("hide"),v(window.$(k(t)),n)}function k(e){return"#edit_review_container_"+e}function T(){r.notificationModal({"class":"blue",type:"confirmation",title:window.i18n.t("delete_comment_notify_title"),body:window.i18n.t("delete_comment_notify_message"),done:function(){var e=M(window.$(this).parents(".review-item"));e.comment="",l.updateReview(y("updateUrl"),e,"deleteSuccess")}.bind(this)})}return{init:function(i){i.mountNode=$(i.mountPoint),function(t){window._.merge(e,t)}(i),window.envDetails.isExecutiveAdmin()&&window.envDetails.currentManagedUser.length>1?y("mountNode").html(u()):(l.fetchReviews(e),f.listen(function(e){var t=h[e.type];window._.isFunction(t)&&t(e.data)}),y("mountNode").on("click",".review-vote",b).on("click",".review-comment",w).on("click",".js_review_save",C).on("click",".js_review_cancel",D).on("click",".js_review_delete",T).on("click",t,A).on("click",n,x))}}}();t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Reviews/handler.js","/app/scripts/Reviews")},{"./actions":78,"./store":80,_process:114,buffer:112}],80:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=window.Reflux.createStore({init:function(){this.reviews={},this.listenToMany(l)},onFetchReviews:function(e){f.fetch({url:e.fetchUrl,data:{entity_type:e.entityType,entity_uuid:e.entityUuid}}).done(function(e){this.reviews=e.data,this.trigger({type:"fetch",data:e.data})}.bind(this))},onUpdateReview:function(e,t,n){f.update({url:e,data:t}).done(function(e){this.trigger({type:n,data:e.data})}.bind(this))},getReviewee:function(e){if(!window._.isEmpty(this.reviews)&&"reviewees"in this.reviews)return window._.find(this.reviews.reviewees,{uuid:e})}});t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Reviews/store.js","/app/scripts/Reviews")},{"./actions":78,_process:114,buffer:112,common_api:"common_api"}],81:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["fetchAccount","fetchAccounts","fetchOppoprunity","refreshContactList"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Sfdc/SfdcAccount/actions.js","/app/scripts/Sfdc/SfdcAccount")},{_process:114,buffer:112}],82:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("./store"),m=e("../commonStore"),h=function(){var e=$("#account-opportunity"),t=$(".js-meeting-with"),n=e.find("#select_account"),i=e.find("#select_opportunity"),o=$(".notification-modal"),a={showErrors:r,showdefaultdetails:function(e){c(e.account_id,e.name);var t=0!=e.opportunities.length?e.opportunities[0]:null;t&&t.opportunity_id===f.selectedOpportunity.id?(p(t.opportunity_id,t.name),f.updateOpptySelection(t.opportunity_id,t.name)):p()}};function s(e,t){f.updateAccountSelection(e,t),"undefined"!=typeof jiffle&&l.refreshContactList()}function r(e){e=_.flatten(_.values(e));o.notificationModal({"class":"red",timeout:!0,title:i18n.t("account_oppty_error_title"),body:e.join(", ")})}function d(e,t){c("-1",e),p("-1",t),n.attr("disabled","disabled"),i.attr("disabled","disabled")}function c(e,t,i){var o={type:"account",placeholder:envDetails.sfdcCustomLabels.account_placeholder};e&&t&&(o.initSelection=function(n,i){n.html($("<option/>").val(e).text(t)),i({id:e,text:t})}),$("a","li#meetingWithInfo").text(t);n.select2(g(o));i&&(s(e,t),u(e,t))}function u(e,t){$("#meeting_account_id").val(e),$("#meeting_with").val(t).prop("disabled",window.Boolean(t)),$("#req_page_meeting_with").val(t).prop("disabled",window.Boolean(t))}function h(e){$("#meeting_opportunity_id").val(e)}function p(e,t){var n={type:"opportunity",placeholder:envDetails.sfdcCustomLabels.opportunity_placeholder};e&&t&&(n.initSelection=function(n,i){n.html($("<option/>").val(e).text(t)),i({id:e,text:t})}),i.find("option").remove(),i.select2(g(n))}function g(e){var t={allowClear:!0,minimumInputLength:3,placeholder:e.placeholder};return t.ajax={data:function(e){return{id:"-",name:e.term,account_id:f.selectedAccount.id||"",opportunity_id:f.selectedOpportunity.id||"",originate:envDetails.event.event_system_name,activity_uuid:window.selectedActivityUuid}},delay:256,transport:function(t,n,i){var o;return(o="account"==e.type?f.onFetchAccounts(t.data):f.onFetchOppoprunity(t.data)).then(n),o[o.fail?"fail":"catch"](i),o},processResults:function(t){var n="storeAccountDetails",i="accounts",o="account_id",a=[];"account"!==e.type&&(n="storeOpptyDetails",i="opportunities",o="opportunity_id");var s=t.data&&t.data[i]||[];return f[n](s),s.length&&(a=s.map(function(e){return{id:e[o],text:e.name}})),{results:a}}},e.initSelection&&(t.initSelection=e.initSelection),t}return{init:function(){if("undefined"!=typeof jiffle||envDetails.bookMeetingWithAccOpp){if(window.currentMeetingInfo=envDetails.isBookSession?window.nominationInfo:window.meetingInfo,"undefined"==typeof jiffle&&(window.currentMeetingInfo.request.mode=window.mode),e.removeClass("hide"),t.addClass("hide"),[m,f].forEach(function(e){e.listen(function(e){var t=a[e.type];t&&t(e.data)})}),"edit"===window.currentMeetingInfo.request.mode){var n,o="",_=window.currentMeetingInfo.request.custom_fields;_.meeting_opportunity_id?((n=f.onFetchOppoprunity({opportunity_id:_.meeting_opportunity_id,name:"",originate:envDetails.event.event_system_name})).then(function(e){data=e.data,opportunity=data&&data.opportunities&&data.opportunities.length&&data.opportunities[0]||{},o=opportunity.name,d(opportunity.account&&opportunity.account.name,o)}),n[n.fail?"fail":"catch"](function(e){r(e.responseJSON.errors)})):_.meeting_account_id?((n=f.onFetchAccounts({account_id:_.meeting_account_id,name:"",originate:envDetails.event.event_system_name})).then(function(e){o="No Selection",d(e.data&&e.data.accounts&&e.data.accounts.length&&e.data.accounts[0].name||"",o)}),n[n.fail?"fail":"catch"](function(e){r(e.responseJSON.errors)})):d(o="No Selection",o)}else f.selectedAccount.id?l.fetchAccount():(c(),p());var g,v,y,b,w,M,C,S;e.on("change","#select_account",function(e){var t=$(this).find("option:selected"),n=t.val()||"",i=t.text()||"";p(),h(""),f.updateOpptySelection("",""),$("a","li#meetingWithInfo").text(i),s(n,i),u(n,i)}),e.on("change","#select_opportunity",function(e){var t=$(this).find("option:selected"),n=t.val()||"",i=t.text()||"";if(f.updateOpptySelection(n,i),h(n),t.length&&!f.selectedAccount.id){var o=f.getAccountInfo(t.val())||{};c(o.account.account_id,o.account&&o.account.name,!0)}}),"undefined"!=typeof jiffle&&(g=window.location.search,v=new RegExp("[?&]accid=([^&#]*)").exec(g),y=new RegExp("[?&]oppid=([^&#]*)").exec(g),b=new RegExp("[?&]lead_ids=([^&#]*)").exec(g),w=window.currentMeetingInfo,"edit"===(M=w&&w.request).mode?envDetails.hideOpportunityInAccountsFlow&&!M.custom_fields.meeting_opportunity_id&&$(i).closest(".opportunity").addClass("hide"):v&&envDetails.hideOpportunityInAccountsFlow&&!y?$(i).closest(".opportunity").addClass("hide"):envDetails.hideOpportunityInJNMeetingFlow&&!(v||y||b)&&$(i).closest(".opportunity").addClass("hide")),C=envDetails.sfdcCustomLabels&&envDetails.sfdcCustomLabels.account_label,S=envDetails.sfdcCustomLabels&&envDetails.sfdcCustomLabels.opportunity_label,e.find(".account").find("label").text(C).attr("title",C),e.find(".opportunity").find("label").text(S).attr("title",S),e.tooltip({trigger:"hover",selector:".js_tooltip"})}}}}();t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Sfdc/SfdcAccount/handler.js","/app/scripts/Sfdc/SfdcAccount")},{"../commonStore":85,"./actions":81,"./store":83,_process:114,buffer:112}],83:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};var f=e("./actions"),m=e("common_api"),h=Reflux.createStore({init:function(){this.listenToMany(f),this.selectedAccount={name:"",id:this.urlParam("accid")},this.selectedOpportunity={name:"",id:this.urlParam("oppid")},this.currentAccountList={},this.currentOpptyList={}},getAccountInfo:function(e){return this.currentOpptyList[e]},getOpptyList:function(e){return this.currentAccountList[e]},storeOpptyDetails:function(e){this.currentOpptyList=e.map(function(e){return t={},n=e.opportunity_id,i=e,n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t;var t,n,i}).reduce(function(e,t){return l({},e,t)},{})},storeAccountDetails:function(e){var t={};_.forEach(e,function(e){t[e.id]=e}),this.currentAccountList=t},urlParam:function(e,t){var n=t||window.location.href,i=new RegExp("[?&]"+e+"=([^&#]*)").exec(n);return null==i?"":i[1]||0},updateAccountSelection:function(e,t){var n={id:e,name:t};this.selectedAccount=n,this.trigger({type:"account",data:n})},updateOpptySelection:function(e,t){var n={id:e,name:t};this.selectedOpportunity=n,this.trigger({type:"opportunity",data:n})},onFetchAccount:function(){var e=m.fetch({data:{account_id:this.selectedAccount.id,opportunity_id:this.selectedOpportunity.id},url:m.ENDPOINTS.fetch_account});e.then(function(e){if(1==e.data.accounts.length){var t=e.data.accounts[0];this.updateAccountSelection(t.account_id,t.name),this.trigger({type:"showdefaultdetails",data:t})}}.bind(this)),e[e.fail?"fail":"catch"](function(e){this.trigger({type:"showErrors",data:e.responseJSON.errors})}.bind(this))},onFetchAccounts:function(e){return m.fetch({data:e,prefix:"undefined"==typeof jiffle?"/portal":"",url:m.ENDPOINTS.fetch_account})},onFetchOppoprunity:function(e){return m.fetch({data:e,prefix:"undefined"==typeof jiffle?"/portal":"",url:m.ENDPOINTS.fetch_opportunity})},onRefreshContactList:function(){this.trigger({type:"refreshContactList"})}});t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Sfdc/SfdcAccount/store.js","/app/scripts/Sfdc/SfdcAccount")},{"./actions":81,_process:114,buffer:112,common_api:"common_api"}],84:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("../commonStore"),f=function(){var e=$("#account-opportunity"),t=$(".notification-modal"),n=$("#meeting-request-container"),i=$("#req_page_meeting_with",n),o=$("a","li#meetingWithInfo"),a={showErrors:function(e){var e=_.flatten(_.values(e));t.notificationModal({"class":"red",timeout:!0,title:i18n.t("lead_error_title"),body:e.join(", ")})}};return{init:function(){"undefined"!=typeof jiffle&&(window.currentMeetingInfo=envDetails.isBookSession?window.nominationInfo:window.meetingInfo,e.addClass("hide"),l.listen(function(e){var t=a[e.type];t&&t(e.data)}),"new"===mode&&!unescape(unescape($.urlParam("meeting_with")))&&window.currentMeetingInfo.request.users&&window.currentMeetingInfo.request.users.external.length>0&&function(e){if(1==e.length)i.val(e[0].company_name).trigger("change"),o.text(e[0].company_name);else{var t=[];_.forEach(e,function(e,n){t.push(e.company_name)}),_.uniq(t).length>1?(i.val("").trigger("change"),o.text("")):(i.val(t[0]).trigger("change"),o.text(t[0]))}}(window.currentMeetingInfo.request.users.external))},isLeadsMeeting:function(){var e;return"new"!==mode||_.isEmpty($.urlParam("lead_ids"))&&"leadFlow"!==$.urlParam("source")||(e=!0),_.isEmpty(meetingInfo.request.custom_fields.meeting_lead_id)||(e=!0),e||!1}}}();t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Sfdc/SfdcLeads/handler.js","/app/scripts/Sfdc/SfdcLeads")},{"../commonStore":85,_process:114,buffer:112}],85:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("common_api"),f=e("./commons"),m=e("./SfdcAccount/store"),h=Reflux.createStore({init:function(){},onSyncAttendeeToSfdc:function(e,t){var n={meeting_source:window.isLeadsMeeting?"Lead":"Account",customFields:f.getExtAttSfdcCustomFields(e.custom_fields),account_id:"edit"===window.currentMeetingInfo.request.mode?window.currentMeetingInfo.request.custom_fields.meeting_account_id:m.selectedAccount.id},i="edit"===window.currentMeetingInfo.request.mode?window.currentMeetingInfo.request.custom_fields.meeting_opportunity_id:m.selectedOpportunity.id;envDetails.syncContactsToSfdcOpportunity&&i&&(n.opportunity_id=i);var o=l.update({url:l.ENDPOINTS.sync_att_to_sfdc,data:_.assign({user:e},n)});o.then(function(e){t(e)}.bind(this)),o[o.fail?"fail":"catch"](function(e){this.trigger({type:"showErrors",data:e.responseJSON.errors.error}),t(e)}.bind(this))}});t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Sfdc/commonStore.js","/app/scripts/Sfdc")},{"./SfdcAccount/store":83,"./commons":86,_process:114,buffer:112,common_api:"common_api"}],86:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},l=function(){function e(e,n){var i="";return window.isLeadsMeeting&&(n||(n=t(e)),_.each(n,function(e){if(e.Id)return i=e.Id,!1})),i}function t(e){var t=_.cloneDeep(e.external);return e.waitlist&&e.waitlist instanceof Array&&(t=t.concat(_.cloneDeep(e.waitlist))),t}return{addMeetingRequestParams:function(n,i){if("undefined"!=typeof jiffle){var o=t(i);n.account_id="new"===mode?i.account.acc.id:window.currentMeetingInfo.request.custom_fields.meeting_account_id,n.opportunity_id="new"===mode?i.account.oppty.id:window.currentMeetingInfo.request.custom_fields.meeting_opportunity_id,n.lead_id="new"===mode?e(i,o):window.currentMeetingInfo.request.custom_fields.meeting_lead_id}},getValidLeadId:e,syncExtAttendeeToSFDC:function(e,t){return"undefined"!=typeof jiffle&&(t?e.sync_contact:!(!envDetails.showJifflenowExternalAttendees||e.id)&&(window.isLeadsMeeting?envDetails.syncLeadsToSfdc:envDetails.syncContactsToSfdc))},getExtAttSfdcCustomFields:function(e){var t={};return _.forEach(envDetails.extatt_custom_field_mappings,function(n,i){t[i]=e[n]||""}),t},getAttListToSyncInJN:function(e){if("undefined"==typeof jiffle)return[];var n=[];return _.forEach(t(e),function(e){var t=u({},e),i=t.consent_given,o=i===undefined?"false":i,a=t.consent_details,s=a===undefined?"":a,r={title:e.title||"-",uuid:e.uuid,first_name:e.first_name,last_name:e.last_name,email:e.email,contact_no:e.contact_no||"-",company_name:e.company_name,custom_fields:e.custom_fields,sfdc_info:{},consent:o,consent_details:s};r.sfdc_info[window.isLeadsMeeting?"sfdc_lead_id":"sfdc_contact_id"]=e.Id,n.push(r)}),n}}}();t.exports=l}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/Sfdc/commons.js","/app/scripts/Sfdc")},{_process:114,buffer:112}],87:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["fetchUserFormRule","fetchProfileCustomForm"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/UserForms/actions.js","/app/scripts/UserForms")},{_process:114,buffer:112}],88:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=(Handlebars.registerHelper("isTrue",function(e,t){return e&&e.toBoolean()?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("isFalse",function(e,t){return e&&e.toBoolean()?t.inverse(this):t.fn(this)}),Handlebars.registerHelper("ifObject",function(e,t){return"object"===(void 0===e?"undefined":u(e))?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("compare_text",function(e,t,n){return e===t?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("alias_users",function(e){return e&&e.email&&e.email.length>0?new Handlebars.SafeString(e.email.join(",")):""}),!0)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/UserForms/handlebar_methods.js","/app/scripts/UserForms")},{_process:114,buffer:112}],89:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("./store"),m=(e("./handlebar_methods"),function(){var e=null,t=["internal"],n="add_user_form",i={},o={fetchUserFormFields:function(t){r(t.standardFields,a),r(t.customFields,s),"function"==typeof e&&e({formRenderers:i,sfdcDefaults:t.sfdcDefaults||{}})}};function a(e,t){var i={};e[t].forEach(function(e){i[e.field_name]=e});var o=HandlebarsTemplates["user_forms/"+n];$("#"+t+"PrimaryFields").html(o({formLabels:i,userDetails:envDetails.user||{}}))}function s(e,t){var n=e[t+"_custom_form"],o=$("#"+t+"AdditionalFormFields").formRenderer({fieldCollection:n});o.init(),i[t]=o}function r(e,n){t.forEach(function(t){n(e,t)})}return{init:function(i){t="string"==typeof i.type?[i.type]:["internal","external"],i.isNewUser,e=i.callback,n=i.templateName,f.listen(function(e){var t=o[e.type];"function"==typeof t&&t(e)}),l.fetchUserFormRule("fetchUserFormFields")}}}());t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/UserForms/handler.js","/app/scripts/UserForms")},{"./actions":87,"./handlebar_methods":88,"./store":91,_process:114,buffer:112}],90:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("common_api"),f={processSfdcFields:function(e,t){var n=t.customFields,i=t.standardFields,o=_.cloneDeep(n.external_custom_form),a=_.cloneDeep(i.external),s=[];[].push.apply(s,a),[].push.apply(s,o),envDetails.extatt_custom_field_mappings=this.getSFDCFieldMappings(o);var r=l.fetch({url:l.ENDPOINTS.fetch_external_user_form_fields,data:this.getSFDCRequestObj(s)});r.then(function(t){var s=this.processMappingMatrix(t,o);i.external=a,n.external_custom_form=o,this.trigger({type:e,standardFields:i,customFields:n,sfdcDefaults:s})}.bind(this)),r[r.fail?"fail":"catch"](function(t){this.trigger({type:e,standardFields:i,customFields:n})}.bind(this))},processMappingMatrix:function(e,t){var n={};return _.forEach(t,function(t){var i=e.mapped_fields[t.field_name];if(i){var o=i.value;"textfield"===t.type&&(o=""===i.value?t.values:i.value),t.values=i.prefill,n[t.field_name]=o}}),n},getSFDCRequestObj:function(e){var t={mapped_fields:{}};return _.forEach(e,function(e){e.integration_field&&e.integration_field.uuid&&(t.mapped_fields[e.field_name]={value:"",prefill:"",integration_field_uuid:e.integration_field.uuid})}),t},getSFDCFieldMappings:function(e){var t={};return _.forEach(e,function(e){e.integration_field&&e.integration_field.uuid&&(t[e.integration_field.uuid]=e.field_name)}),t}};t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/UserForms/sfdc_store.js","/app/scripts/UserForms")},{_process:114,buffer:112,common_api:"common_api"}],91:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=e("./sfdc_store"),h=Reflux.createStore({init:function(){this.listenToMany(l)},mixins:[m],onFetchUserFormRule:function(e){var t=f.fetch({url:f.ENDPOINTS.fetch_user_form_rules,prefix:f.ENDPOINTS.portal});t.then(function(t){var n={internal:[],external:[]};if(t.data instanceof Array){var i=_.groupBy(t.data,"type");n.internal=this.processData(i.InternalUserFormField),n.external=this.processData(i.ExternalUserFormField)}this.onFetchProfileCustomForm(e,n)}.bind(this)),t[t.fail?"fail":"catch"](function(t){this.onFetchProfileCustomForm(e,{internal:[],external:[]})}.bind(this))},processData:function(e){var t=[];return e instanceof Array&&(t=e.map(function(e){return e.field_info.field_name=e.field_name,e.field_info})),t},onFetchProfileCustomForm:function(e,t){var n=f.fetch({url:f.ENDPOINTS.fetch_portal_custom_form,prefix:f.ENDPOINTS.portal});n.then(function(n){var i=_.groupBy(n.data,"type"),o=_.groupBy(i.UserForm,"name"),a={};_.forEach(o,function(e,t){a[t]=_.first(e).fields}),"undefined"!=typeof jiffle?this.processSfdcFields(e,{standardFields:t,customFields:a}):this.trigger({type:e,standardFields:t,customFields:a})}.bind(this)),n[n.fail?"fail":"catch"](function(n){this.trigger({type:e,standardFields:t,customFields:{internal_custom_form:[],external_custom_form:[]}})}.bind(this))}});t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/UserForms/store.js","/app/scripts/UserForms")},{"./actions":87,"./sfdc_store":90,_process:114,buffer:112,common_api:"common_api"}],92:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){var e=!window.envDetails.enableRoomInterimBlock||"view"===window.mode||window.mappingEnabled||window.envDetails.isConsecutiveMeeting?undefined:(new Date).getTime();return function(t){var n;return null===(n=t)||"function"==typeof n||Array.isArray(n)||"object"!==(void 0===n?"undefined":u(n))||(t.block_token=e),t}}();t.exports=l}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/block_token.js","/app/scripts/commons")},{_process:114,buffer:112}],93:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u,l,f,m,h,_=(u=$("#legend_expand"),l=$("#legend_view"),f=$("#legend_close"),m=function(){u.removeClass("hide"),l.addClass("hide")},h=function(){u.addClass("hide"),l.removeClass("hide")},{init:function(){l.on("click",m),f.on("click",h)}});t.exports=_}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/book/Calendar/handler.js","/app/scripts/commons/book/Calendar")},{_process:114,buffer:112}],94:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=window.ReactMessage||$(".notification-modal"),l={internal:$("#internalAttendeeCount"),external:$("#externalAttendeeCount")},f=function(e,t){!function(e,t){l[e].text(t)}(e,t),l[e][t>0?"removeClass":"addClass"]("hide")};function m(){var e=$("#req_page_meeting_with");!e.val()&&e.focus().click()}t.exports={setAttendeeCount:function(e){var t=e.internalCount,n=e.externalCount;f("internal",t),f("external",n)},init:function(){f("internal",0),f("external",0)},showMandatoryFieldsMsg:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:i18n.t("mandatory_feilds_required");u.notificationModal({"class":"red",timeout:!0,body:e,dismiss:m})},focusInMeetingWith:m,validateMeetingWith:function(){$("form#details-form").validate().element($(this))}}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/book/MeetingInMaking/handler.js","/app/scripts/commons/book/MeetingInMaking")},{_process:114,buffer:112}],95:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=$(".js-calendar-dropleft"),f=$(".js-calendar-dropright"),m=e("moment");var h=function(e,t){return m(e).add(t,"days")._d},_=function(e,t){return m(e).subtract(t,"days")._d},p=function(e,t){return m(e).diff(t,"days")};function g(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4,n=scheduler.getState().date,i=h(n,t);i<=e&&(h(i,t-1)>e&&(i=_(e,t-1)),scheduler.setCurrentView(i)),l.removeClass("disabled"),y(e,t)}function v(e,t,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:4,o=scheduler.getState().date,a=void 0,s=h(o,i-1).getTime()===t.getTime();(a=_(o,s?n:i))>=e&&scheduler.setCurrentView(a),f.removeClass("disabled"),b(e,i)}function y(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4;h(scheduler.getState().date,t)>e&&f.addClass("disabled")}function b(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4;_(scheduler.getState().date,t)<e&&l.addClass("disabled")}t.exports={setWeekStart:function(){scheduler.date.week_start=function(e){return e}},hideNonEventDays:function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:4;scheduler.ignore_week=function(i){var o=scheduler.getState().date;return m(i).diff(o,"days")+1>n||i<e||i>t}},overrideLimitSpan:function(){scheduler._render_marked_timespan=function(e,t,n){var i=[],o=scheduler.config,a=this._min_date,s=this._max_date,r=!1;if(!o.display_marked_timespans)return i;if(!n&&0!==n){if(e.days<7)n=e.days;else{var d=new Date(e.days);if(r=+d,!(+s>+d&&+a<=+d))return i;n=d.getDay()}var c=a.getDay();c>n?n=7-(c-n):n-=c}var u=e.zones,l=scheduler._get_css_classes_by_config(e);if(scheduler._table_view&&"month"==scheduler._mode){var f=[],m=[];if(t)f.push(t),m.push(n);else{m=r?[r]:scheduler._get_dates_by_index(n);for(var h=0;h<m.length;h++)f.push(this._scales[m[h]])}for(h=0;h<f.length;h++){t=f[h],n=m[h];var _=Math.floor((this._correct_shift(n,1)-a.valueOf())/(864e5*this._cols.length)),p=this.locate_holder_day(n,!1)%this._cols.length;if(!this._ignores[p]){var g=scheduler._get_block_by_config(e),v=Math.max(t.offsetHeight-1,0),y=Math.max(t.offsetWidth-1,0),b=this._colsS[p],w=this._colsS.heights[_]+(this._colsS.height?this.xy.month_scale_height+2:2)-1;g.className=l,g.style.top=w+"px",g.style.lineHeight=g.style.height=v+"px";for(var M=0;M<u.length;M+=2){var C=u[h];if((D=u[h+1])<=C)return[];(k=g.cloneNode(!0)).style.left=b+Math.round(C/1440*y)+"px",k.style.width=Math.round((D-C)/1440*y)+"px",t.appendChild(k),i.push(k)}}}}else{var S=n;if(this._ignores[this.locate_holder_day(n,!1)])return i;if(this._props&&this._props[this._mode]&&e.sections&&e.sections[this._mode]){var A=this._props[this._mode];S=A.order[e.sections[this._mode]];var x=A.order[e.sections[this._mode]];A.days>1?S=S*(A.size||A.options.length)+x:(S=x,A.size&&S>A.position+A.size&&(S=0))}for(t=t||scheduler.locate_holder(S),h=0;h<u.length;h+=2){var D,k;if(C=Math.max(u[h],60*o.first_hour),(D=Math.min(u[h+1],60*o.last_hour))<=C){if(h+2<u.length)continue;return[]}(k=scheduler._get_block_by_config(e)).className=l;var T=24*this.config.hour_size_px+1;k.style.top=Math.round((60*C*1e3-36e5*this.config.first_hour)*this.config.hour_size_px/36e5)%T+"px";var E=Math.max(Math.round(60*(D-C)*1e3*this.config.hour_size_px/36e5)%T,1);k.style.lineHeight=Math.min(E,40)+"px",k.style.height=E+"px",t.appendChild(k),i.push(k)}}return i}.bind(scheduler)},setupSchedulerTemplates:function(e){var t=scheduler.date.date_to_str("%g%a");scheduler.templates.hour_scale=function(e){var n="";if(e.getHours()+e.getMinutes()/60<scheduler.config.last_hour-.5)for(var i=0;i<1;i++)n+="<div style='height:21px;line-height:21px;'>"+t(e)+"</div>",e=scheduler.date.add(e,60,"minute");return n},scheduler.templates.day_scale_date=scheduler.date.date_to_str(scheduler.config.day_date),scheduler.templates.event_class=function(e,t,n){return""},scheduler.templates.tooltip_text=function(e,t,n){return""},scheduler.renderEvent=e.renderEvent,scheduler.templates.event_text=e.event_text,scheduler.templates.event_header=e.event_header},calendarleftSlideHandler:v,calendarRightSlideHandler:g,disableCalendarLeftNavIcon:b,disableCalendarRightNavIcon:y,setupCalendarSlideListeners:function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:4;b(e,n),y(t,n);var i=(m(t).diff(e,"days")+1)%n||n;$(".js-calendar-dropright").on("click",function(e){g(t,n)}),$(".js-calendar-dropleft").on("click",function(o){v(e,t,i,n)})},configureCalendarForWeekView:function(e){scheduler.config.check_limits=!0,scheduler.config.collision_limit=1,scheduler.config.start_on_monday=!1,scheduler.config.now_date=new Date(1970,1,1),scheduler.config.day_date="%D, %M %j",scheduler.config.limit_start=scheduler.date.add(e.startDate,-1,"day"),scheduler.config.limit_end=scheduler.date.add(e.endDate,1,"day"),scheduler.config.limit_view=!0,scheduler.config.multi_day=!1,scheduler.config.mark_now=!1,scheduler.config.details_on_create=e.details_on_create||!1,scheduler.xy.min_event_height=e.min_event_height||40,scheduler.config.hour_size_px=60/(e.step||30)*22,scheduler.config.icons_select=e.icons_select||["icon_delete"],scheduler.config.icons_edit=e.icons_edit||["icon_delete"],scheduler.config.time_step=e.time_step||15,scheduler.config.event_duration=e.event_duration||15,scheduler.config.drag_move=e.drag_move||!1,scheduler.xy.nav_height=0,scheduler.config.xml_date="%Y-%m-%d %H:%i",scheduler.config.dblclick_create=!1,scheduler.config.edit_on_create=!1},getWeekStart:function(e){e=m(e);var t=m(scheduler.config.limit_start).add(1,"days").toDate(),n=m.duration(e.diff(t)).asDays();return m(new Date(t)).add(Math.floor(n/7),"week").toDate()},setupCalendarslotInfo:e("./slotInfoHelper"),paintDoubleBookingslots:function(e,t){scheduler.addMarkedTimespan({days:e,zones:t,css:"status-light-green"})},paintInitialBlocks:function(e,t){scheduler.addMarkedTimespan({css:"initial-block",type:"dhx_time_block",days:e,zones:t})},paintResourceBlocks:function(e,t){scheduler.addMarkedTimespan({css:"resource-block",type:"dhx_time_block",days:e,zones:t})},diffenceOfDatesLessThanMaxDays:function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:4;return e=m(e),t=m(t),m.duration(t.diff(e)).asDays()<n},getWeekStartForEdit:function(e,t,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:4,o=Math.floor(p(n,e)/i),a=h(e,o*i);return t=m(t),p(t,a)<=i-1&&(a=_(t,i-1)),a},setWeekStartForJFX:function(e,t){var n;n=scheduler.date.getISOWeek(e)===scheduler.date.getISOWeek(scheduler.date.add(t,1,"day"))?0:e.getDay(),scheduler.date.week_start=function(e){var t=e.getDay();return n&&(t?t-=n:t=n),scheduler.date.date_part(scheduler.date.add(e,-1*t,"day"))}},enableNavigationArrows:function(){l.add(f).removeClass("disabled")},makeCalendarReadOnly:function(){var e=scheduler.addEventNow;scheduler.addEventNow=function(){this.config.readonly||e.apply(this,arguments)}}}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/calendar_helpers.js","/app/scripts/commons")},{"./slotInfoHelper":102,_process:114,buffer:112,moment:116}],96:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=function(){var e="YYYY-MM-DD hh:mm A",t="hh:mm A",n="YYYY-MM-DD",i="DD-MM-YYYY hh:mm A",o="DD-MM-YYYY HH:mm";return{convertDateTimeToTime:function(n){return moment(n,e).format(t)},jsDateToDateFormat:function(e){return moment(e).format(n)},jsDateToDateTimeFormat:function(t){return moment(t).format(e)},convertDateTimeServerToTime:function(e){return moment(e,i).format(t)},convertDateTimeServerToJsDate:function(e){return moment(e,i)._d},jsDateToTime:function(e){return moment(e).format(t)},convertDateTimeToJsDate:function(t){return moment(t,e)._d},convertTimeZoneToUtc:function(t){return moment(moment(t).utc().format(e),e)._d},convertServerDateTimeToDate:function(e){return moment(e,o).format(n)}}}();t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/date_format.js","/app/scripts/commons")},{_process:114,buffer:112}],97:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("moment"),f=$(".js-set-time-form"),m=f.find('[name="start_time"]'),h=f.find('[name="end_time"]'),_=f.find("#error_block"),p={isSSEvent:!1,validationCallback:null},g=$(".js-clear-cal-event");function v(e){Object.assign(p,e)}var y=function(){f.addClass("hide"),f.data("event","")},b=function(){f.removeClass("hide")},w=function(){var e=f.data("event");e&&!D()&&S(e,scheduler.getEvent(e))},M=function(e){$(e.target).is(":not(.js-set-time-form *)")&&w()};function C(e,t){b();var n=scheduler.getEvent(e),i=window.envDetails.isAbstractOnlyEditableMode;return i&&i()||!window.envDetails.can_edit_time?(S(e,n,!0),!0):(n&&"existing-briefing-meeting"!==n.type&&S(e,n),!0)}function S(e,t){E(t,arguments.length>2&&arguments[2]!==undefined&&arguments[2]),f.data("event",e),A()}function A(){I(""),f.find(".help-block").remove(),f.find(".section-caltime-bx").removeClass("has-error")}var x=function(e){var t="";if(e<60){t=e+" "+(e>1?"minutes":"minute")}else{var n=Math.floor(e/60),i=e%60,o=n>1?"hours":"hour";t=0===i?n+" "+o:n+" "+o+" and "+i+" "+(i>1?"minutes":"minute")}return t},D=function(){return f.valid()&&!1===f.hasClass("has-error")};function k(e){if(!m.prop("readonly")&&(I(""),D())){var t=f.data("event"),n=scheduler.getEvent(t),i=n.start_date,o=n.end_date,a=i.toDateString()+" "+m.val(),s=o.toDateString()+" "+h.val(),r=new Date(a),d=new Date(s),c=60*r.getHours()+r.getMinutes(),u=60*d.getHours()+d.getMinutes();if(c>u)return void I(i18n.t("start_time_greater_than_end"));var l=u-c;if(!p.isSSEvent&&(l<scheduler.config.minimum_duration||l>scheduler.config.maximum_duration))return void I(i18n.t("slot_size_invalid",{min_duration:x(scheduler.config.minimum_duration),max_duration:x(scheduler.config.maximum_duration),silentMsg:"meeting"}));if(!window.isEBCEvent){var _=scheduler.config.time_step;if(0!==l%_)return void I(i18n.t("time_should_increament_of_step",{timeStep:x(_)}))}if("function"==typeof p.validationCallback)p.validationCallback({id:n.id,start_date:r,end_date:d},!0,T,"granular_edit");else{if(n.start_date=r,n.end_date=d,scheduler.checkInMarkedTimespan(n,"dhx_time_block"))return void I(i18n.t("slot_unavailable"));scheduler.updateEvent(t),scheduler.callEvent("onEventChanged",[t,n])}}}function T(e,t,n){if(e)if(scheduler.checkInMarkedTimespan(n,"dhx_time_block"))I(i18n.t("slot_unavailable"));else{var i=scheduler.getEvent(n.id);i.start_date=n.start_date,i.end_date=n.end_date,scheduler.updateEvent(n.id),scheduler.callEvent("onEventChanged",[i.id,i])}else I(t)}function E(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1];m.val(l(e.start_date).format("h:mm A")).prop("readonly",t),h.val(l(e.end_date).format("h:mm A")).prop("readonly",t)}function I(e){_.text(e),_.parent()[e?"addClass":"removeClass"]("has-error")}function R(){var e=f.data("event");scheduler.deleteEvent(e)}t.exports={init:function(e){v(e),$.validator.setDefaults({highlight:function(e){$(e).parent().addClass("has-error")},unhighlight:function(e){$(e).parent().removeClass("has-error")}}),$.validator.addMethod("time12",function(e,t){return!!e.match(/^(0?[1-9]|1[012])(:[0-5]\d) [APap][Mm]$/)},"Invalid time format"),f.validate({rules:{end_time:{time12:!0},start_time:{time12:!0}}}),scheduler.attachEvent("onClick",C),scheduler.attachEvent("onEventAdded",C),scheduler.attachEvent("onEventChanged",C),scheduler.attachEvent("onBeforeEventDelete",function(e,t){return""+e==""+f.data("event")&&y(),!0}),f.on("keyup","input",k),$(document).on("click",M),g.on("click",R),y()},setTimeFields:E,resetTimeFields:function(){m.val(""),h.val("")},hideTimeForm:y,convertMinutesToReadable:x,isFormValid:D,clearTimeErrorField:A,setTimeFieldsWithMeetingTime:w}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/granular_edit.js","/app/scripts/commons")},{_process:114,buffer:112,moment:116}],98:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=(Handlebars.registerHelper("math",function(e,t,n,i){return{"+":(e=+e||0)+(n=+n||0),"-":e-n,"*":e*n,"/":e/n,"%":e%n}[t]}),Handlebars.registerHelper("compare_text",function(e,t,n){return e===t?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("date_format",function(e,t){return moment(new Date(e.replace(/-/g,"/"))).format("ddd DD, MMM YYYY")}),Handlebars.registerHelper("time",function(e,t){return moment(new Date(e.replace(/-/g,"/"))).tz(envDetails.time_zone).format("hh:mm A")}),Handlebars.registerHelper("time_conversion_with_location",function(e,t){var n=envDetails.event?envDetails.current_location.time_zone_converted:envDetails.time_zone;return n?moment(e).tz(n).format("hh:mm A"):""}),Handlebars.registerHelper("time_format",function(e,t){var n=scheduler.date.str_to_date("%Y-%m-%d %h:%i %A");return moment(n(e)).format("hh:mm A")}),Handlebars.registerHelper("ifObject",function(e,t){return"object"===(void 0===e?"undefined":u(e))?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("isFalse",function(e,t){return e&&e.toBoolean()||_.isUndefined(e)?t.inverse(this):t.fn(this)}),Handlebars.registerHelper("check_multiselects",function(e,t){return"multiselect_dropdown"==e?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("nestedAnd",function(){var e=_.values(arguments),t=_.last(arguments),n=e.length-1,i=e.slice(0,n);return _.isEqual(_.times(n,_.constant(!0)),i)?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("nestedOr",function(){var e=_.values(arguments),t=_.last(arguments),n=e.length-1,i=e.slice(0,n);return _.contains(i,!0)?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("showMoreActions",function(){var e=arguments[0],t=arguments[1]||arguments[2]||arguments[3]&&arguments[4]||arguments[5]||arguments[6];t=e&&t;var n=_.last(arguments);return t?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("replaceString",function(e,t,n){var i=new RegExp(t,"g");return e.replace(i,n)}),void Handlebars.registerHelper("hashValue",function(e,t,n){return n[e[t]?"fn":"inverse"](this)}))}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/handlebarHelpers/math.js","/app/scripts/commons/handlebarHelpers")},{_process:114,buffer:112}],99:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./date_format");$.validator.addMethod("timeformat",function(e,t){return(e=(e||"").trim())&&/^((1[0-2]|0?[0-9]):([0-5][0-9]) ([AaPp][Mm]))$/.test(e)},i18n.t("invalid_time_format")),$.validator.addMethod("timeBetween",function(e,t,n){e=(e||"").trim();var i=l.jsDateToDateFormat(n.startTime),o=moment(i+" "+e,"YYYY-MM-DD hh:mm A"),a=moment(n.startTime,"hh:mm A"),s=moment(n.endTime,"hh:mm A");return o.isSameOrAfter(a)&&o.isSameOrBefore(s)},i18n.t("select_time_between_meeting_time")),$.validator.addMethod("timeEqual",function(e,t,n){return(e=(e||"").trim())!==($(n.otherInput).val()||"")},i18n.t("start_end_time_cannot_be_same")),$.validator.addMethod("validTime",function(e,t,n){e=(e||"").trim();var i=$(n.thatInput).val()||"",o=moment(i,"hh:mm A");return moment(e,"hh:mm A")["is"+n.mode](o)},i18n.t("start_after_end_time"));t.exports=function(e,t){return $(".js-participation-form").validate({focusCleanup:!0,errorClass:"help-block error-class",rules:{"participation-start-time":{required:!0,timeformat:"[name='participation-start-time']",timeBetween:{startTime:e,endTime:t},timeEqual:{otherInput:"#participation-end-time"}},"participation-end-time":{required:!0,timeformat:"[name='participation-end-time']",timeBetween:{startTime:e,endTime:t},timeEqual:{otherInput:"#participation-start-time"},validTime:{thatInput:"#participation-start-time",mode:"After"}}}})}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/participation_validator.js","/app/scripts/commons")},{"./date_format":96,_process:114,buffer:112}],100:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u;function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=(l(u={system_configurations:"/configurations/system_configuration",fetch_survey_template:"/configure/consolidated_survey_mail_settings",update_survey_template:"/configure/consolidated_survey_mail_setting",fetch_meeting_list_customer_info:"/importable_customer_info/list",fetch_customer_info_values:"/importable_customer_info",fetch_archived_event_meeting_analytics:"/archived_events/analytics",fetch_archived_events_list:"/event_list_by_type/archived",fetch_archived_reports:"/archived_events/all_reports",get_booth_tour_details:"/booth_tour/list",file_upload_url:"/attachment/{type}",remove_uploaded_file_url:"/attachment/{uuid}",update_endorsement_config:"/configure/endorsement",ext_domain_validation:"/domains/valid",list_briefings_agenda:"/briefing/list_briefings#/list_agenda",users:"/users",fetch_unmapped_topic_entity:"/get_meetings_with_unmapped_topic_entity",meeting_host_count:"/get_meetings_with_meeting_host",fetch_user_details:"/users/{{uuid}}",user_export:"/user/export",activate_user:"/users/UUID/active",reinvite_user:"/users/resend_invite",export_summary_report:"/guided_tour/surveys",upload_user_csv:"/user/import",calendar_user_availability:"/calendar/users",event_info:"/event_info",event_configurations:"/event/{event_uuid}/configurations",user_make_available:"/calendar/make_available",user_make_unavailable:"/calendar/make_unavailable",user_block:"/calendar/block",user_unblock:"/calendar/unblock",block_update:"/calendar/edit_block",user_calendar_export:"/calendar/users/export",company_fetch:"/company",register_user:"/register",alert_fetch:"/alerts",alert_details_fetch:"/alerts/meeting_meta",dismiss_alert:"/alerts/dismiss",notification_fetch:"/notifications",dismiss_notification:"/notifications/dismiss",set_participation:"/meeting_request/set_participation",fetch_topics:"/topics",update_user_profile:"/user/{{uuid}}",fetch_meetings_analytics:"/analytics/meetings",fetch_invitees_analytics:"/analytics/invitees",fetch_customers_analytics:"/analytics/customers",fetch_roles_analytics:"/analytics/roles",users_events:"/users_events",reinvite_users:"/users/resend_invite",remove_from_event:"/users/UUID/inactive",users_events_filters:"/users_events_filters",meeting_request_path:"/meeting_request/new",meeting_request_view_path:"/meeting_request/{uuid}/view",meeting_request_export:"/meeting_request/export",roles_fetch:"/roles",role_create:"/role/create",role_update:"/role/update",role_get_privileges:"/role/{:uuid}/get_privileges",role_set_privileges:"/role/{:uuid}/set_privileges",role_enable:"/role/{:uuid}/enable",role_disable:"/role/{:uuid}/disable",meeting_get_config:"/configure/{:uuid}/meeting_type",meeting_set_config:"/configure/{:uuid}/meeting_type_update",meeting_set_setting:"/setting/activity_update",meeting_get_settings:"/setting/activity",meeting_types:"/meeting_types",ui_set_setting:"/setting/ui_update",ui_get_settings:"/setting/ui",get_announcements:"/setting/announcement",set_announcements:"/setting/announcement_update",availability_fetch:"/meeting_type/availabilities",availability_update:"/configure/update_initial_availabilities",all_meeting_types:"/meeting_types/index"},"event_info","/events"),l(u,"event_details","/event_info"),l(u,"rooms_list","/rooms/list"),l(u,"rooms_export","/room/export"),l(u,"room_create","/room/create"),l(u,"room_update","/room/update"),l(u,"meetings_list","/meeting_requests"),l(u,"facilities_list","/facilities"),l(u,"meeting_availability","/meeting_request/calendar"),l(u,"internal_attendees","/users/internal"),l(u,"external_attendees","/users/external"),l(u,"lead_details","/lead_details"),l(u,"validate_leads","/validate_leads"),l(u,"availability_update","/configure/update_initial_availabilities"),l(u,"calendar_availability","/meeting_request/calendar"),l(u,"meeting_create","/meeting_request/create"),l(u,"meeting_fetch","/meeting_request/{{uuid}}/show"),l(u,"user_create","/user/create"),l(u,"sync_att_to_sfdc","/sync_att_to_sfdc"),l(u,"validate_room_capacity","/room/validate"),l(u,"user_update","/users/{{uuid}}/update"),l(u,"update_mail_template","/mail_template/update"),l(u,"mail_template_type_get","/mail_actions"),l(u,"mail_template_type_entities_get","/mail_action/get_associated_entities"),l(u,"accept_meeting","/meeting_request/{uuid}/accept_meeting"),l(u,"decline_meeting","/meeting_request/{uuid}/decline_meeting"),l(u,"reschedule_meeting","/meeting_request/reschedule"),l(u,"events_info","/events"),l(u,"event_config","/event/configurations"),l(u,"room_availability","/calendar/rooms"),l(u,"room_calendar_export","/calendar/rooms/export"),l(u,"room_unblock","/calendar/unblock"),l(u,"room_make_available","/calendar/make_available"),l(u,"room_make_unavailable","/calendar/make_unavailable"),l(u,"block_update","/calendar/edit_block"),l(u,"meeting_drag","/calendar/relocate"),l(u,"meeting_request_path","/meeting_request/new"),l(u,"meeting_request_edit_path","/meeting_request/{uuid}/edit"),l(u,"upload_room_csv","/room/import"),l(u,"save_form","/custom_form/update"),l(u,"fetch_form","/custom_form/get_fields"),l(u,"alert_fetch","/alerts"),l(u,"alert_details_fetch","/alerts/meeting_meta"),l(u,"dismiss_alert","/alerts/dismiss"),l(u,"dismiss_alert","/alerts/dismiss"),l(u,"notification_fetch","/notifications"),l(u,"dismiss_notification","/notifications/dismiss"),l(u,"fetch_meetings_analytics","/analytics/meetings"),l(u,"fetch_invitees_analytics","/analytics/invitees"),l(u,"fetch_customers_analytics","/analytics/customers"),l(u,"fetch_roles_analytics","/analytics/roles"),l(u,"fetch_rooms_analytics","/analytics/rooms"),l(u,"fetch_booking_analytics","/analytics/booking"),l(u,"fetch_meeting_filters","/reports/meeting_filters"),l(u,"fetch_meeting_data_for_reports","/users/meetings"),l(u,"standard_report_export_url","/users/meetings.pdf?user_uuid={{uuid}}"),l(u,"fetch_users_for_reports","/reports/users_list"),l(u,"fetch_meeting_reports","/meetings"),l(u,"fetch_meeting_reports_header","/headers"),l(u,"activate_event","/event/activate"),l(u,"fetch_activity_list","/activities"),l(u,"cancel_meeting","/meeting_request/{meeting_uuid}/cancel_meeting"),l(u,"time_zone_url","/time_zone"),l(u,"fetch_minimum_timeslot","/setting/minimum_timeslot"),l(u,"update_minimum_timeslot","/setting/minimum_timeslot_update"),l(u,"demand_report_export","/meeting_request/ondemand"),l(u,"mapped_events","/mappable_events"),l(u,"get_nav_header","/events_meetings_menu"),l(u,"fetch_account","/fetch_account"),l(u,"fetch_opportunity","/fetch_opportunity"),l(u,"fetch_meeting_info","/meeting_request/new.json"),l(u,"fetch_edit_meeting_info","/meeting_request/{UUID}/edit.json"),l(u,"fetch_view_meeting_info","/meeting_request/{UUID}/view.json"),l(u,"fetch_edit_nomination_info","/nomination/{UUID}/edit.json"),l(u,"fetch_view_nomination_info","/nomination/{UUID}/view.json"),l(u,"room_activities","/activities_rooms"),l(u,"event_env_details","/event_info"),l(u,"fetch_requestors","/fetch_requestors"),l(u,"domain_validate","/portal/domains/validate"),l(u,"fetch_sf_custom_fields","SFDC"),l(u,"double_booked_resources","/meeting_request/double_booked_resources"),l(u,"meetings_list_filters","/meeting_request/meeting_filters"),l(u,"get_meeting_options","/meeting_filters/filter_options"),l(u,"get_checkin_options","/checkin_filters/filter_options"),l(u,"get_report_options","/reports_filters/filter_options"),l(u,"user_info","/portal/user_info"),l(u,"bulk_approve_meetings","meeting_request/approve_meetings"),l(u,"activity_details","/activities/{uuid}"),l(u,"expert_users","/mapping/experts"),l(u,"expert_users","/mapping/experts"),l(u,"apex_jnmeetings","/apex/JNMeetings"),l(u,"apex_jnsessions","/apex/JNSessions"),l(u,"jn_book_meeting","/apex/JNBookMeeting"),l(u,"jn_view_book_meeting","/apex/JNViewMeeting"),l(u,"jn_view_nomination","/apex/JNNominationView"),l(u,"jn_book_nomination","/apex/JNNominations"),l(u,"apex_jnlistagenda","/apex/JNBriefings"),l(u,"sessions_list","/sessions"),l(u,"fetch_user_form_rules","/user_form_fields"),l(u,"save_profile_preferences","/user_form_fields/update"),l(u,"fetch_portal_custom_form","/forms"),l(u,"save_portal_custom_form","/form/update"),l(u,"portal","/portal"),l(u,"consecutive_meetings_edit_path","/consecutive_meetings/{uuid}/edit"),l(u,"consecutive_meetings_view_path","/consecutive_meetings/{uuid}/view"),l(u,"consecutive_meetings_details","/consecutive_meetings/{uuid}/edit_consecutive_meeting"),l(u,"bulk_endorse_users","/users/enable_endorse_users"),l(u,"fetch_external_user_form_fields","/fetch_sfdc_contacts_fields"),l(u,"get_swappable_room_list","/swap_room/list"),l(u,"swap_room_submit","/swap_room/swap"),l(u,"fetch_consecutive_meeting_notification_settings","/configure/consecutive_meeting/notification_settings"),l(u,"fetch_consecutive_meeting_form_settings","/configure/consecutive_meeting/form_settings"),l(u,"create_consecutive_meetings","/consecutive_meetings"),l(u,"meeting_types_of_consecutive_sub_meetings","/consecutive_meetings/meeting_types"),l(u,"on_behalf_actions","/meeting_request/on_behalf_actions"),l(u,"briefing_centre","/bc"),l(u,"briefing_details","/briefing/{briefing_uuid}"),l(u,"briefing_centre_long_day","/bcs/get_long_day"),l(u,"fetch_valid_mapping_Times","/mappings_valid_start_times"),l(u,"meeting_history","/meeting_request/{uuid}/history"),l(u,"fetch_activities","/user_meeting_types/list"),l(u,"tracks_list","/tracks"),l(u,"fetch_track_topics","/tracks/{{uuid}}/topics"),l(u,"can_attend_session","/can_attend_session"),l(u,"create_group_nomination","/group_nomination/create"),l(u,"fetch_contacts","/fetch_contacts"),l(u,"resources_session_availability","/group_nomination/can_attend"),l(u,"session_nominations","/group_nominations"),l(u,"check_attendee_availability",{url:"/api/v1/users/{uuid}/availability"}),l(u,"give_consent","/consent.json"),l(u,"room_block","/api/v1/room/interim_block"),l(u,"custom_labels","/custom_labels_configurations"),l(u,"fetch_resource_data","/api/v1/resource_data/fetch"),l(u,"time_zone_city_search","/google/cities"),l(u,"get_city_time_zone","/google/timezone"),l(u,"partial_meeting_update","/meeting_request/partial_update"),l(u,"custom_field_options","/custom_form/{UUID}/search"),u);t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/sfdc/api_endpoints.js","/app/scripts/commons/sfdc")},{_process:114,buffer:112}],101:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},f={users_events:{params:function(e){return{accountId:$.urlParam("accid"),opportunityId:$.urlParam("oppid"),leadIds:$.urlParam("lead_ids")?unescape($.urlParam("lead_ids")).split(","):[]}},callback:function(e){return _.forEach(e.data.events,function(e){e.event_url=unescape(e.event_url),e.action.url=unescape(e.action.url),e.action.tracks_and_sessions_url=unescape(e.action.tracks_and_sessions_url)}),e.data.ebc_events&&e.data.ebc_events.length&&_.forEach(e.data.ebc_events,function(e){e.event_url=unescape(e.event_url),e.locations&&e.locations.length&&_.forEach(e.locations,function(e){e.action.url=unescape(e.action.url)})}),e},sfdcMethod:"getEventList"},add_user_to_event:{params:function(e){return{accountId:$.urlParam("accid"),opportunityId:$.urlParam("oppid"),leadIds:$.urlParam("lead_ids")?unescape($.urlParam("lead_ids")).split(","):[],queryStr:JSON.stringify({api_params:e.data})}},callback:function(e){return _.forEach(e.data.events,function(e){var t=_.first(e);t.event_url=unescape(t.event_url),t.action.url=unescape(t.action.url),t.locations&&t.locations.length&&_.forEach(t.locations,function(e){e.action.url=unescape(e.action.url)})}),e},sfdcMethod:"addYourself"},get_nav_header:{params:function(e){return{accountId:$.urlParam("accid"),eventName:$.urlParam("eventName"),opportunityId:$.urlParam("oppid"),leadIds:$.urlParam("lead_ids")?unescape($.urlParam("lead_ids")).split(","):[],current_location_uuid:$.urlParam("current_location_uuid")}},callback:function(e){return _.forEach(e.data.links,function(e){e.url=unescape(e.url)}),e},sfdcMethod:"getMenuList"},fetch_account:{params:function(e){return{accountId:e.data.id?"":e.data.account_id,opportunityId:e.data.opportunity_id||"",accountName:h(e.data.name)}},callback:function(e){return m(e)},sfdcMethod:"getSFAccounts"},fetch_opportunity:{params:function(e){return{opportunityId:e.data.id?"":e.data.opportunity_id,accountId:e.data.account_id,opportunityName:h(e.data.name)}},callback:function(e){return m(e)},sfdcMethod:"getSFOpportunities"},fetch_meeting_info:{params:v,sfdcMethod:"callJNMethod"},fetch_edit_meeting_info:{params:v,sfdcMethod:"callJNMethod"},fetch_view_meeting_info:{params:v,sfdcMethod:"callJNMethod"},fetch_edit_nomination_info:{params:y,sfdcMethod:"callJNMethod"},fetch_view_nomination_info:{params:y,sfdcMethod:"callJNMethod"},lead_details:{params:function(e){var t=e.data,n=[];t.leadIds&&(n=t.leadIds);var i={leadIds:n,listSize:t.per_page,pgNo:t.page,custom_fields:envDetails.extatt_custom_field_mappings,selectedAttendees:t.selectedAttendees};return t.search?i.queryStr=h(t.search):i.queryStr=t.search||"",i},callback:function(e){e="string"==typeof e?JSON.parse(_.unescape(e)):JSON.parse(_.unescape(JSON.stringify(e)));return _.forEach(e.data.items,function(t,n){meetingInfo.externalAttendees[t.email]?b(e,t,n):(t.uuid="dummy_"+Math.random().toString(36).substring(2),t.statuses={verified:!1,active:!0,approved:null,sso_enabled:!1},meetingInfo.externalAttendees[t.email]=_.cloneDeep(t))}),e},sfdcMethod:"getSFDCLeads"},validate_leads:{params:function(e){return{leadIds:e.data.leadIds,isLeadDetail:$.urlParam("isLeadDetail")}},sfdcMethod:"validateLeads"},fetch_contacts:{params:function(e){var t=e.data,n={accountId:(u=t.account_id)||"",listSize:t.per_page,pgNo:t.page,custom_fields:envDetails.extatt_custom_field_mappings,selectedAttendees:t.selectedAttendees,contactIds:t.contactIds};return t.search?n.queryStr=h(t.search):n.queryStr=t.search||"",n},callback:function(e){meetingInfo.account_id!==u&&(meetingInfo.externalAttendees={},meetingInfo.account_id=u);e="string"==typeof e?JSON.parse(_.unescape(e)):JSON.parse(_.unescape(JSON.stringify(e)));return _.forEach(e.data.items,function(t,n){meetingInfo.externalAttendees[t.email]?b(e,t,n):(t.uuid="dummy_"+Math.random().toString(36).substring(2),t.statuses={verified:!1,active:!0,approved:null,sso_enabled:!1},meetingInfo.externalAttendees[t.email]=_.cloneDeep(t))}),e},sfdcMethod:"getSFDCContacts"},calendar_availability:{params:function(e){return{eventName:$.urlParam("eventName"),queryStr:JSON.stringify({api_params:e.data})}},sfdcMethod:"getCalendar"},fetch_sf_custom_fields:{sfdcMethod:"parseCustFields",params:function(e){return{queryStr:JSON.stringify(e.data)}}},fetch_external_user_form_fields:{sfdcMethod:"getConVals",params:function(e){return{queryStr:JSON.stringify(e.data)}}},meetings_list:{sfdcMethod:"getMeetingListdb"},meeting_create:{params:g,sfdcMethod:"createMeeting"},create_group_nomination:{params:g,sfdcMethod:"createMeeting"},reschedule_meeting:{params:g,sfdcMethod:"createMeeting"},partial_meeting_update:{params:g,sfdcMethod:"createMeeting"},user_create:{sfdcMethod:"createAttendee"},sync_att_to_sfdc:{params:function(e){var t=e.data;return{accountId:t.account_id||"",custom_fields:t.customFields,meetingSource:t.meeting_source,opportunityId:t.opportunity_id||""}},sfdcMethod:"syncAttToSFDC"}};function m(e){return"string"!=typeof e&&(e=JSON.stringify(e)),e=e.replace(/%5C/g,"%5C%5C").replace(/%22/g,"%5C%22").replace(/\+/g," "),e=_.unescape(unescape(e)),JSON.parse(e)}function h(e){return escape((e||"").replace(/['"!%^_\[\]]/g,"\\$&"))}function p(e,t){var n="",i=e.includes("/domains/validate")?"":$.urlParam("eventName");return t===undefined||$.isEmptyObject(t)||(n=$.param({api_params:t})),{eventName:i,url:e,queryStr:n}}function g(e){var t={eventName:$.urlParam("eventName"),meetingType:window.masterMeetingType.name.toLowerCase(),queryStr:JSON.stringify({api_params:e.data})},n=e.data.meeting_request;return n&&(t.accountId=n.account_id||"",t.opportunityId=n.opportunity_id||"",t.leadId=n.lead_id||"",t.meetingSource=_.isEmpty(n.lead_id)?"":"Lead"),t}function v(e){return p(e.url.replace("{UUID}",$.urlParam("meeting")),e.data)}function y(e){return p(e.url.replace("{UUID}",$.urlParam("nomination")),e.data)}function b(e,t,n){var i=meetingInfo.externalAttendees[t.email],o=i.uuid,a=i.statuses;meetingInfo.externalAttendees[t.email]=l({},i,t,{uuid:o,statuses:l({},a)}),e.data.items[n]=_.cloneDeep(meetingInfo.externalAttendees[t.email])}t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/sfdc/method_endpoints.js","/app/scripts/commons/sfdc")},{_process:114,buffer:112}],102:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=$("#scheduler_here"),f={},m=e("./utils"),h={element:null,clicked:!1},p=0;function g(e){$(".unavailable-popup").length&&p!==e.target.scrollTop&&f.notifyReact(),p=e.target.scrollTop}function v(e){e.element&&!1===e.clicked&&scheduler.unmarkTimespan(e.element)}t.exports=function(e){var t=function(e){var t=scheduler.attachEvent("onMouseMove",function(t,n){var i,o,a=e.meetingTypeStore.getActivitySettings();if(a&&m.isDefined(a.show_summary)&&a.show_summary.toBoolean()&&window.canViewConflictedSummary){var s=scheduler.getActionData(n).date;if(function(e){return e.target.className.indexOf("resource-block")>-1}(n)){v(h);var r=function(e,t){var n=function(e){var t=moment(e);return 60*t.hours()+t.minutes()}(e),i=function(e,t){for(var n=0;n<=e.length-2;n+=2)if(t>=e[n]&&t<=e[n+1])return[e[n],e[n+1]];return[]}(t.getResourceBlocks(e),n),o=i[0],a=i[1];if(a-o<60)return[o,a];var s=Math.floor((n-o)/60),r=o+60*s,d=r+60;return d>a&&(r=(d=a)-60),[r,d]}(s,e.calendarStore);h.element=(i=s,o=r,scheduler.markTimespan({css:"resource-block-highlight",days:i,zones:o})),h.clicked=!1;var d=function(e,t,n,i){var o=$(e.currentTarget).offset(),a=e.pageX-o.left-t,s=e.pageY-o.top;return(a>n/2?"right":"left")+" "+(s>i/2?"top":"bottom")}(n,n.offsetX,n.currentTarget.clientWidth,n.currentTarget.clientHeight);window.renderUnavailablePopup(h.element,function(e,t,n,i){var o=n.model,a=[];_.forEach(o.external,function(e,t){a.push(e.uuid)}),_.forEach(o.internal,function(e,t){a.push(e.uuid)});var s=i&&i.getTimeZoneId(),r=window.isOngoingSales&&s?s:window.envDetails.event.time_zone;return{user_uuid:a,end_time:t[1],start_time:t[0],date:moment(e).format("DD-MM-YYYY"),room_uuid:o.room.uuid?o.room.uuid:"",time_zone:r,activity_uuid:selectedActivityUuid}}(s,r,e.dataStore,e.onGoingSalesStore),f,d)}else!1===function(e){return"trigger-pointer"===e.target.className}(n)&&v(h)}});return l.on("mouseleave",function(e){v(h)}),t}(e);return f={subscribers:[],subscribe:function(e){this.subscribers.push(e)},notifyReact:function(){this.subscribers.forEach(function(e){e()})},notifyCloseEvent:function(e){scheduler.unmarkTimespan(e)},notifyOpenEvent:function(){h.clicked=!0}},l.find(".dhx_cal_data").on("scroll",_.throttle(g,500)),{PubSubManager:f,event:t}}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/slotInfoHelper.js","/app/scripts/commons")},{"./utils":106,_process:114,buffer:112}],103:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["getCityTimeZone"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/timeZoneHelper/actions.js","/app/scripts/commons/timeZoneHelper")},{_process:114,buffer:112}],104:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("common_api"),f=function(){var e=/\((.{3}[+|-]\d{2}[:]\d{2})\)/,t=void 0,n=void 0,i=void 0,o=void 0,a=void 0,s=void 0,r=void 0,d=window.envDetails,c={getCityTimeZoneSuccess:function(e){var t=e.time_zone_id;b(e.time_zone_name),M(t),y(t)},getCityTimeZoneFailure:function(e){}};function u(){return $(t.selector)}function f(){return!!u().length}function m(){var e,t,n;M(moment.tz.guess()),e=(new Date).toString(),w(n=function(e){return e.substring(0,6).concat(":").concat(e.substring(6,8))}(n=e.match(/.{3}[+|-]\d{4}/)[0])),S(n),C(t=e.match(/\((.*)\)/)[1]),g(t)}function h(){return!!(Array.isArray(window.mapping_enabled_activities)?window.mapping_enabled_activities:[]).filter(function(e){return e.uuid===window.selectedActivityUuid}).length}function p(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0];u().prop("disabled",e)}function g(e){var t=u(),n={width:"100%",allowClear:!1,placeholder:i18n.t("change_time_zone"),multiple:!1,minimumInputLength:3};n.ajax={delay:700,data:function(e){return(e.term||"").trim()},processResults:function(e){var t=[];return e&&e.data&&_.isArray(e.data)&&(t=e.data.map(function(e){var t=[];return e.city&&t.push(e.city),e.state&&t.push(e.state),e.country&&t.push(e.country),{id:JSON.stringify(e.lat_long),text:t.join(", ")}})),t.length||(t=d.railsTimeZoneList.slice()).unshift({id:i18n.t("city_not_found"),text:i18n.t("city_not_found"),disabled:!0}),{results:t}},transport:function(e,t,n){var i={search:e.data,token:d.token},o=l.fetch({url:l.ENDPOINTS.time_zone_city_search,data:i});return o.then(function(e){return t(e)}),o[o.fail?"fail":"catch"](function(e){return t()}),o}},t.html(new window.Option("","")),e&&t.append(new window.Option(e,e)),t.select2(n).val(e).trigger("change"),t.on("change",v)}function v(){var t=$(this),n=t.val().trim(),o=t.find("option:selected").text();try{n=JSON.parse(n),C(o),i.getCityTimeZone(n,"getCityTimeZoneSuccess","getCityTimeZoneFailure")}catch(a){M(n),b(o),function(t){var n=(i=t,i&&i.replace(i.match(e)[0],""));var i;o=n,$(r).text(o),C(n);var o}(o),y(n)}}function y(e){"function"==typeof a&&a(e)}function b(t){var n=function(t){return t&&t.match(e)[1]}(t);w(n),S(n)}function w(e){s?function(e){if($("#timeZoneInfo").remove(),e){var t=(a=(o=e).match(/[+|-]/)[0],s=o.indexOf(a),r=o.substring(0,s).trim(),d=o.substring(s+1,o.length).trim(),{gmtStr:r,sign:a,timeStr:d}),n=HandlebarsTemplates["external_widget/time_zone_info"],i=n(t);$(i).insertAfter('[data-id="external_widget_time_zone_city"]')}var o,a,s,r,d}(e):function(e){n.text(e).removeClass("hide")}(e)}function M(e){o.setTimeZoneId(e)}function C(e){o.setTimeZoneCity(e)}function S(e){o.setTimeZoneDisplayName(e)}return{init:function(e){!function(e){t=e.timeZoneCityField,i=e.Actions,o=e.Store,a=e.timeZoneChangeCallback,s=e.isExternalWidget,n=e.displayTimeZoneField,r=e.timeZoneCityContainer}(e),o.listen(function(e){var t=c[e.type];"function"==typeof t&&t(e.data)})},disableTimeZoneField:function(){var e;!0===f()&&(p(),(e=u()).select2&&e.select2("val",null),e.off("change",v))},setTimeZoneField:function(){var e,t,n,i;!0===f()&&(s?(p(!1),m()):(e=meetingInfo.request)&&e.meeting_time_zone?function(e){var t,n=e.meeting_time_zone,i=e.meeting_time_zone_city,a=e.meeting_time_zone_offset;t={timeZoneId:n,timeZoneCity:i,timeZoneDisplayName:a},o.setTimeZone(t),g(i),w(a),h()&&p()}(e):!0===h()?(t=d.event,n=t.time_zone,i=t.time_zone_display_name,M(n),C(i),g(i),p()):m())},setTimeZoneDisplayNameOnUI:w}}();t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/timeZoneHelper/handler.js","/app/scripts/commons/timeZoneHelper")},{_process:114,buffer:112,common_api:"common_api"}],105:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("common_api"),f={setStoreVariables:function(){this.timeZone={timeZoneId:"",timeZoneCity:"",timeZoneDisplayName:""}},onGetCityTimeZone:function(e,t,n){var i=this,o={location:e,token:window.envDetails.token},a=l.fetch({url:l.ENDPOINTS.get_city_time_zone,data:o});a.then(function(e){i.trigger({type:t,data:e.data})}),a[a.fail?"fail":"catch"](function(e){i.trigger({type:n,data:e})})},setTimeZoneId:function(e){this.timeZone.timeZoneId=e},getTimeZoneId:function(){return this.timeZone.timeZoneId},setTimeZoneCity:function(e){this.timeZone.timeZoneCity=e},getTimeZoneCity:function(){return this.timeZone.timeZoneCity},setTimeZoneDisplayName:function(e){this.timeZone.timeZoneDisplayName=e},getTimeZoneDisplayName:function(){return this.timeZone.timeZoneDisplayName},setTimeZone:function(e){Object.assign(this.timeZone,e)},getTimeZone:function(){return this.timeZone},getTimeZoneToBeShownOnProceedPage:function(){var e=this.getTimeZoneCity(),t=e&&e.split(",")[0];return t?this.getTimeZoneDisplayName()+" "+t:""+this.getTimeZoneDisplayName()},getTimeZoneFromMeetingInfo:function(){var e=meetingInfo.request.meeting_time_zone_city,t=e&&e.split(",")[0],n=meetingInfo.request.meeting_time_zone_offset;return t?n+" "+t:""+n}};t.exports=f}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/timeZoneHelper/store.js","/app/scripts/commons/timeZoneHelper")},{_process:114,buffer:112,common_api:"common_api"}],106:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,a=undefined;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(d){o=!0,a=d}finally{try{!i&&r["return"]&&r["return"]()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h={isJmmOrAbove:function(){var e=window.envDetails;return e.isMeetingManager()||e.isCSM()||e.isJuniorMM()},isUndefined:function(e){return e===undefined},isNull:function(e){return null===e},isDefined:function(e){return!this.isUndefined(e)&&!this.isNull(e)},isMmOrAbove:function(){var e=window.envDetails;return e.isMeetingManager()||e.isCSM()},camelize:_,extractFormAttributes:function(e){if(!e)return;return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.elements||[])).map(function(e){if("submit"!==e.type&&""!==e.name)return"checkbox"===e.type?m({},e.name,e.checked):"radio"===e.type?e.checked?m({},e.name,e.value):{}:m({},e.name,e.value)}).reduce(function(e,t){return f({},e,t)},{})}};function _(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],n=void 0===e?"undefined":l(e);return"boolean"===n?e:"number"===n?e:t&&"string"===n?e:"string"===n?function(){return(arguments.length>0&&arguments[0]!==undefined?arguments[0]:"").replace(/[_.-](\w|$)/g,function(e,t){return t.toUpperCase()})}(e):function(e){return e?"[object Array]"===Object.prototype.toString.call(e)?function(){return(arguments.length>0&&arguments[0]!==undefined?arguments[0]:[]).map(function(e){return _(e,!0)})}(e):Object.entries(e).map(function(e){var t=u(e,2),n=t[0],i=t[1];return m({},_(n),_(i,!0))}).reduce(function(e,t){return f({},e,t)},{}):e}(e)}t.exports=h}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/utils.js","/app/scripts/commons")},{_process:114,buffer:112}],107:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=Reflux.createActions(["getHistory","resetHistory"]);t.exports=u}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/history/actions.js","/app/scripts/history")},{_process:114,buffer:112}],108:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("./store");e("../commons/handlebarHelpers/math");var m=function(){var e,t,n,i={fetchUrl:"",perPage:20,mountPoint:"#history-view",loadMoreHistory:".load_more_history",showUpdateText:".all_updates"},o="",a={getHistory:function(i){var a;o.length>0?(n.text("Showing Search Results"),a="history/search"):(n.text("Showing all Updates"),a="history/list");var s=(0,HandlebarsTemplates[a])(i);e.html(s),$(e).data("page",i.current_page),$(e).data("total_pages",i.total_pages),i.current_page>=i.total_pages&&t.addClass("hide")}};function s(){o=$(this).val(),l.resetHistory(),t.removeClass("hide"),c(1)}function r(){var e=this.parentElement;$(e).find(".history_section_show").addClass("hide"),$(e).find(".info_section").addClass("show"),$(e).find(".history_section_hide").removeClass("hide")}function d(){var e=this.parentElement;$(e).find(".history_section_hide").addClass("hide"),$(e).find(".info_section").removeClass("show"),$(e).find(".history_section_show").removeClass("hide")}function c(e){e=e||1;var t=u().fetchUrl,n=u().perPage;l.getHistory({url:t,page:e,perPage:n,searchText:o,prefix:i.prefix})}function u(){return i}return{init:function(o){!function(e){_.merge(i,e)}(o),e=$(i.mountPoint),t=$(i.loadMoreHistory),n=$(i.showUpdateText),f.listen(function(e){var t=e.action,n=a[t];_.isFunction(n)&&n(e.data)}),c(1),e.on("click",".history_section_show",r),e.on("click",".history_section_hide",d),$(".history-search-box").on("keyup",_.debounce(s,369)),$(".history-search-box").on("keypress",function(e){if(13==e.keyCode)return!1}),$(document.body).on("appear",".load_more_history",function(t,n){var i,o;i=$(e).data("page")||1,o=$(e).data("total_pages")||0,i!==o&&c(i+1)}),t.appear()}}}();t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/history/handler.js","/app/scripts/history")},{"../commons/handlebarHelpers/math":98,"./actions":107,"./store":109,_process:114,buffer:112}],109:[function(e,t,n){(function(n,i,o,a,s,r,d,c,u){var l=e("./actions"),f=e("common_api"),m=Reflux.createStore({init:function(){this.listenToMany(l),this.history={},this.fetchingHistory=!1,this.pagination={page:1,totalPages:1e3}},getUniqueHistory:function(e,t){return _.sortBy(_.values(_.extend(_.indexBy(e,"id"),_.indexBy(t,"id"))),function(e){return e.created_at}).reverse()},updateHistory:function(e){for(var t in e)this.history.hasOwnProperty(t)?this.history[t]=this.getUniqueHistory(this.history[t],e[t]):this.history[t]=e[t]},onResetHistory:function(){this.pagination={page:1,totalPages:1e3},this.history={}},onGetHistory:function(e){if(0==this.fetchingHistory){this.fetchingHistory=!0;var t={url:e.url,data:{page:e.page||1,search:e.searchText,per_page:e.perPage}};e.prefix&&_.assign(t,{prefix:e.prefix}),f.fetch(t).then(function(t){this.fetchingHistory=!1,this.pagination.page=e.page||1,this.pagination.totalPages=t.data.total_pages,this.updateHistory(t.data.audit_messages),this.trigger({action:"getHistory",data:{history:this.history,total_pages:t.data.total_pages,current_page:this.pagination.page}})}.bind(this))}}});t.exports=m}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/history/store.js","/app/scripts/history")},{"./actions":107,_process:114,buffer:112,common_api:"common_api"}],110:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=[],l=[];function f(e){var t=e.flag,n=e.comments,i=n===undefined?[]:n;return"yes"===t&&(i=i.filter(function(e){return e})),i}t.exports={putSearchQueryParam:function(e,t,n){e=e||"";var i=new RegExp("([?&])"+t+"=([^&$]*)").exec(e);return i?e.replace(i[0],""+i[1]+t+"="+n):e.concat(e?"&":"?",t,"=",n)},getDeclineComments:function(){return u},getCancelComments:function(){return l},updateDeclineComments:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.decline_comments_enabled,n=e.predefined_decline_comments;u=f({flag:t,comments:n})},updateCancelComments:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.cancel_comments_enabled,n=e.predefined_cancel_comments;l=f({flag:t,comments:n})}}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/utils/index.js","/app/scripts/utils")},{_process:114,buffer:112}],111:[function(e,t,n){(function(e,t,i,o,a,s,r,d,c){var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";var t="undefined"!=typeof Uint8Array?Uint8Array:Array,n="+".charCodeAt(0),i="/".charCodeAt(0),o="0".charCodeAt(0),a="a".charCodeAt(0),s="A".charCodeAt(0),r="-".charCodeAt(0),d="_".charCodeAt(0);function c(e){var t=e.charCodeAt(0);return t===n||t===r?62:t===i||t===d?63:t<o?-1:t<o+10?t-o+26+26:t<s+26?t-s:t<a+26?t-a+26:void 0}e.toByteArray=function(e){var n,i,o,a,s,r;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var d=e.length;s="="===e.charAt(d-2)?2:"="===e.charAt(d-1)?1:0,r=new t(3*e.length/4-s),o=s>0?e.length-4:e.length;var u=0;function l(e){r[u++]=e}for(n=0,i=0;n<o;n+=4,i+=3)l((16711680&(a=c(e.charAt(n))<<18|c(e.charAt(n+1))<<12|c(e.charAt(n+2))<<6|c(e.charAt(n+3))))>>16),l((65280&a)>>8),l(255&a);return 2===s?l(255&(a=c(e.charAt(n))<<2|c(e.charAt(n+1))>>4)):1===s&&(l((a=c(e.charAt(n))<<10|c(e.charAt(n+1))<<4|c(e.charAt(n+2))>>2)>>8&255),l(255&a)),r},e.fromByteArray=function(e){var t,n,i,o,a=e.length%3,s="";function r(e){return u.charAt(e)}for(t=0,i=e.length-a;t<i;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],s+=r((o=n)>>18&63)+r(o>>12&63)+r(o>>6&63)+r(63&o);switch(a){case 1:s+=r((n=e[e.length-1])>>2),s+=r(n<<4&63),s+="==";break;case 2:s+=r((n=(e[e.length-2]<<8)+e[e.length-1])>>10),s+=r(n>>4&63),s+=r(n<<2&63),s+="="}return s}}(void 0===n?this.base64js={}:n)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/browserify/node_modules/base64-js/lib/b64.js","/node_modules/browserify/node_modules/base64-js/lib")},{_process:114,buffer:112}],112:[function(e,t,n){(function(t,i,o,a,s,r,d,c,u){"use strict";var l=e("base64-js"),f=e("ieee754"),m=e("isarray");n.Buffer=o,n.SlowBuffer=function V(e,t){if(!(this instanceof V))return new V(e,t);var n=new o(e,t);delete n.parent;return n},n.INSPECT_MAX_BYTES=50,o.poolSize=8192;var h={};function _(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e){return this instanceof o?(o.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=undefined),"number"==typeof e?function(e,t){if(e=g(e,t<0?0:0|v(t)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;n++)e[n]=0;return e}(this,e):"string"==typeof e?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");var i=0|y(t,n);return(e=g(e,i)).write(t,n),e}(this,e,arguments.length>1?arguments[1]:"utf8"):function(e,t){if(o.isBuffer(t))return function(e,t){var n=0|v(t.length);return e=g(e,n),t.copy(e,0,0,n),e}(e,t);if(m(t))return function(e,t){var n=0|v(t.length);e=g(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}(e,t);if(null==t)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(t.buffer instanceof ArrayBuffer)return p(e,t);if(t instanceof ArrayBuffer)return function(e,t){o.TYPED_ARRAY_SUPPORT?(t.byteLength,e=o._augment(new Uint8Array(t))):e=p(e,new Uint8Array(t));return e}(e,t)}return t.length?function(e,t){var n=0|v(t.length);e=g(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}(e,t):function(e,t){var n,i=0;"Buffer"===t.type&&m(t.data)&&(n=t.data,i=0|v(n.length)),e=g(e,i);for(var o=0;o<i;o+=1)e[o]=255&n[o];return e}(e,t)}(this,e)):arguments.length>1?new o(e,arguments[1]):new o(e)}function p(e,t){var n=0|v(t.length);e=g(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function g(e,t){return o.TYPED_ARRAY_SUPPORT?(e=o._augment(new Uint8Array(t))).__proto__=o.prototype:(e.length=t,e._isBuffer=!0),0!==t&&t<=o.poolSize>>>1&&(e.parent=h),e}function v(e){if(e>=_())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+_().toString(16)+" bytes");return 0|e}function y(e,t){"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(e).length;default:if(i)return Y(e).length;t=(""+t).toLowerCase(),i=!0}}function b(e,t,n,i){n=Number(n)||0;var o=e.length-n;i?(i=Number(i))>o&&(i=o):i=o;var a=t.length;if(a%2!=0)throw new Error("Invalid hex string");i>a/2&&(i=a/2);for(var s=0;s<i;s++){var r=parseInt(t.substr(2*s,2),16);if(isNaN(r))throw new Error("Invalid hex string");e[n+s]=r}return s}function w(e,t,n,i){return J(Y(t,e.length-n),e,n,i)}function M(e,t,n,i){return J(function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function C(e,t,n,i){return M(e,t,n,i)}function S(e,t,n,i){return J(L(t),e,n,i)}function A(e,t,n,i){return J(function(e,t){for(var n,i,o,a=[],s=0;s<e.length&&!((t-=2)<0);s++)n=e.charCodeAt(s),i=n>>8,o=n%256,a.push(o),a.push(i);return a}(t,e.length-n),e,n,i)}function x(e,t,n){return 0===t&&n===e.length?l.fromByteArray(e):l.fromByteArray(e.slice(t,n))}function D(e,t,n){n=Math.min(e.length,n);for(var i=[],o=t;o<n;){var a,s,r,d,c=e[o],u=null,l=c>239?4:c>223?3:c>191?2:1;if(o+l<=n)switch(l){case 1:c<128&&(u=c);break;case 2:128==(192&(a=e[o+1]))&&(d=(31&c)<<6|63&a)>127&&(u=d);break;case 3:a=e[o+1],s=e[o+2],128==(192&a)&&128==(192&s)&&(d=(15&c)<<12|(63&a)<<6|63&s)>2047&&(d<55296||d>57343)&&(u=d);break;case 4:a=e[o+1],s=e[o+2],r=e[o+3],128==(192&a)&&128==(192&s)&&128==(192&r)&&(d=(15&c)<<18|(63&a)<<12|(63&s)<<6|63&r)>65535&&d<1114112&&(u=d)}null===u?(u=65533,l=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),o+=l}return function(e){var t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=k));return n}(i)}o.TYPED_ARRAY_SUPPORT=i.TYPED_ARRAY_SUPPORT!==undefined?i.TYPED_ARRAY_SUPPORT:function(){function e(){}try{var t=new Uint8Array(1);return t.foo=function(){return 42},t.constructor=e,42===t.foo()&&t.constructor===e&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(n){return!1}}(),o.TYPED_ARRAY_SUPPORT?(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array):(o.prototype.length=undefined,o.prototype.parent=undefined),o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,a=0,s=Math.min(n,i);a<s&&e[a]===t[a];)++a;return a!==s&&(n=e[a],i=t[a]),n<i?-1:i<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!m(e))throw new TypeError("list argument must be an Array of Buffers.");if(0===e.length)return new o(0);var n;if(t===undefined)for(t=0,n=0;n<e.length;n++)t+=e[n].length;var i=new o(t),a=0;for(n=0;n<e.length;n++){var s=e[n];s.copy(i,a),a+=s.length}return i},o.byteLength=y,o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?D(this,0,e):function(e,t,n){var i=!1;if(t|=0,n=n===undefined||n===Infinity?this.length:0|n,e||(e="utf8"),t<0&&(t=0),n>this.length&&(n=this.length),n<=t)return"";for(;;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return D(this,t,n);case"ascii":return T(this,t,n);case"binary":return E(this,t,n);case"base64":return x(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?0:o.compare(this,e)},o.prototype.indexOf=function(e,t){if(t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t>>=0,0===this.length)return-1;if(t>=this.length)return-1;if(t<0&&(t=Math.max(this.length+t,0)),"string"==typeof e)return 0===e.length?-1:String.prototype.indexOf.call(this,e,t);if(o.isBuffer(e))return n(this,e,t);if("number"==typeof e)return o.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,e,t):n(this,[e],t);function n(e,t,n){for(var i=-1,o=0;n+o<e.length;o++)if(e[n+o]===t[-1===i?0:o-i]){if(-1===i&&(i=o),o-i+1===t.length)return n+i}else i=-1;return-1}throw new TypeError("val must be string, number or Buffer")},o.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},o.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},o.prototype.write=function(e,t,n,i){if(t===undefined)i="utf8",n=this.length,t=0;else if(n===undefined&&"string"==typeof t)i=t,n=this.length,t=0;else if(isFinite(t))t|=0,isFinite(n)?(n|=0,i===undefined&&(i="utf8")):(i=n,n=undefined);else{var o=i;i=t,t=0|n,n=o}var a=this.length-t;if((n===undefined||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return M(this,e,t,n);case"binary":return C(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function T(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;o++)i+=String.fromCharCode(127&e[o]);return i}function E(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;o++)i+=String.fromCharCode(e[o]);return i}function I(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var o="",a=t;a<n;a++)o+=H(e[a]);return o}function R(e,t,n){for(var i=e.slice(t,n),o="",a=0;a<i.length;a+=2)o+=String.fromCharCode(i[a]+256*i[a+1]);return o}function $(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,n,i,a,s){if(!o.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(t>a||t<s)throw new RangeError("value is out of bounds");if(n+i>e.length)throw new RangeError("index out of range")}function P(e,t,n,i){t<0&&(t=65535+t+1);for(var o=0,a=Math.min(e.length-n,2);o<a;o++)e[n+o]=(t&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function q(e,t,n,i){t<0&&(t=4294967295+t+1);for(var o=0,a=Math.min(e.length-n,4);o<a;o++)e[n+o]=t>>>8*(i?o:3-o)&255}function N(e,t,n,i,o,a){if(t>o||t<a)throw new RangeError("value is out of bounds");if(n+i>e.length)throw new RangeError("index out of range");if(n<0)throw new RangeError("index out of range")}function B(e,t,n,i,o){return o||N(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),f.write(e,t,n,i,23,4),n+4}function U(e,t,n,i,o){return o||N(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),f.write(e,t,n,i,52,8),n+8}o.prototype.slice=function(e,t){var n,i=this.length;if(e=~~e,t=t===undefined?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),o.TYPED_ARRAY_SUPPORT)n=o._augment(this.subarray(e,t));else{var a=t-e;n=new o(a,undefined);for(var s=0;s<a;s++)n[s]=this[s+e]}return n.length&&(n.parent=this.parent||this),n},o.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||$(e,t,this.length);for(var i=this[e],o=1,a=0;++a<t&&(o*=256);)i+=this[e+a]*o;return i},o.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||$(e,t,this.length);for(var i=this[e+--t],o=1;t>0&&(o*=256);)i+=this[e+--t]*o;return i},o.prototype.readUInt8=function(e,t){return t||$(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||$(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||$(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||$(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||$(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||$(e,t,this.length);for(var i=this[e],o=1,a=0;++a<t&&(o*=256);)i+=this[e+a]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},o.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||$(e,t,this.length);for(var i=t,o=1,a=this[e+--i];i>0&&(o*=256);)a+=this[e+--i]*o;return a>=(o*=128)&&(a-=Math.pow(2,8*t)),a},o.prototype.readInt8=function(e,t){return t||$(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||$(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){t||$(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return t||$(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||$(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||$(e,4,this.length),f.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||$(e,4,this.length),f.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||$(e,8,this.length),f.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||$(e,8,this.length),f.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||O(this,e,t,n,Math.pow(2,8*n),0);var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=e/o&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||O(this,e,t,n,Math.pow(2,8*n),0);var o=n-1,a=1;for(this[t+o]=255&e;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):q(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):q(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);O(this,e,t,n,o-1,-o)}var a=0,s=1,r=e<0?1:0;for(this[t]=255&e;++a<n&&(s*=256);)this[t+a]=(e/s>>0)-r&255;return t+n},o.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);O(this,e,t,n,o-1,-o)}var a=n-1,s=1,r=e<0?1:0;for(this[t+a]=255&e;--a>=0&&(s*=256);)this[t+a]=(e/s>>0)-r&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):q(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):q(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var a,s=i-n;if(this===e&&n<t&&t<i)for(a=s-1;a>=0;a--)e[a+t]=this[a+n];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(a=0;a<s;a++)e[a+t]=this[a+n];else e._set(this.subarray(n,n+s),t);return s},o.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),n<t)throw new RangeError("end < start");if(n!==t&&0!==this.length){if(t<0||t>=this.length)throw new RangeError("start out of bounds");if(n<0||n>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof e)for(i=t;i<n;i++)this[i]=e;else{var o=Y(e.toString()),a=o.length;for(i=t;i<n;i++)this[i]=o[i%a]}return this}},o.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(o.TYPED_ARRAY_SUPPORT)return new o(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var F=o.prototype;o._augment=function(e){return e.constructor=o,e._isBuffer=!0,e._set=e.set,e.get=F.get,e.set=F.set,e.write=F.write,e.toString=F.toString,e.toLocaleString=F.toString,e.toJSON=F.toJSON,e.equals=F.equals,e.compare=F.compare,e.indexOf=F.indexOf,e.copy=F.copy,e.slice=F.slice,e.readUIntLE=F.readUIntLE,e.readUIntBE=F.readUIntBE,e.readUInt8=F.readUInt8,e.readUInt16LE=F.readUInt16LE,e.readUInt16BE=F.readUInt16BE,e.readUInt32LE=F.readUInt32LE,e.readUInt32BE=F.readUInt32BE,e.readIntLE=F.readIntLE,e.readIntBE=F.readIntBE,e.readInt8=F.readInt8,e.readInt16LE=F.readInt16LE,e.readInt16BE=F.readInt16BE,e.readInt32LE=F.readInt32LE,e.readInt32BE=F.readInt32BE,e.readFloatLE=F.readFloatLE,e.readFloatBE=F.readFloatBE,e.readDoubleLE=F.readDoubleLE,e.readDoubleBE=F.readDoubleBE,e.writeUInt8=F.writeUInt8,e.writeUIntLE=F.writeUIntLE,e.writeUIntBE=F.writeUIntBE,e.writeUInt16LE=F.writeUInt16LE,e.writeUInt16BE=F.writeUInt16BE,e.writeUInt32LE=F.writeUInt32LE,e.writeUInt32BE=F.writeUInt32BE,e.writeIntLE=F.writeIntLE,e.writeIntBE=F.writeIntBE,e.writeInt8=F.writeInt8,e.writeInt16LE=F.writeInt16LE,e.writeInt16BE=F.writeInt16BE,e.writeInt32LE=F.writeInt32LE,e.writeInt32BE=F.writeInt32BE,e.writeFloatLE=F.writeFloatLE,e.writeFloatBE=F.writeFloatBE,e.writeDoubleLE=F.writeDoubleLE,e.writeDoubleBE=F.writeDoubleBE,e.fill=F.fill,e.inspect=F.inspect,e.toArrayBuffer=F.toArrayBuffer,e};var j=/[^+\/0-9A-Za-z-_]/g;function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function Y(e,t){var n;t=t||Infinity;for(var i=e.length,o=null,a=[],s=0;s<i;s++){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&a.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&a.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function L(e){return l.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function J(e,t,n,i){for(var o=0;o<i&&!(o+n>=t.length||o>=e.length);o++)t[o+n]=e[o];return o}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/browserify/node_modules/buffer/index.js","/node_modules/browserify/node_modules/buffer")},{_process:114,"base64-js":111,buffer:112,ieee754:115,isarray:113}],113:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==u.call(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/browserify/node_modules/buffer/node_modules/isarray/index.js","/node_modules/browserify/node_modules/buffer/node_modules/isarray")},{_process:114,buffer:112}],114:[function(e,t,n){(function(e,n,i,o,a,s,r,d,c){var u=[],l=!1;function f(){if(!l){var e;l=!0;for(var t=u.length;t;){e=u,u=[];for(var n=-1;++n<t;)e[n]();t=u.length}l=!1}}function m(){}(e=t.exports={}).nextTick=function(e){u.push(e),l||setTimeout(f,0)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=m,e.addListener=m,e.once=m,e.off=m,e.removeListener=m,e.removeAllListeners=m,e.emit=m,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/browserify/node_modules/process/browser.js","/node_modules/browserify/node_modules/process")},{_process:114,buffer:112}],115:[function(e,t,n){(function(e,t,i,o,a,s,r,d,c){n.read=function(e,t,n,i,o){var a,s,r=8*o-i-1,d=(1<<r)-1,c=d>>1,u=-7,l=n?o-1:0,f=n?-1:1,m=e[t+l];for(l+=f,a=m&(1<<-u)-1,m>>=-u,u+=r;u>0;a=256*a+e[t+l],l+=f,u-=8);for(s=a&(1<<-u)-1,a>>=-u,u+=i;u>0;s=256*s+e[t+l],l+=f,u-=8);if(0===a)a=1-c;else{if(a===d)return s?NaN:(m?-1:1)*Infinity;s+=Math.pow(2,i),a-=c}return(m?-1:1)*s*Math.pow(2,a-i)},n.write=function(e,t,n,i,o,a){var s,r,d,c=8*a-o-1,u=(1<<c)-1,l=u>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,m=i?0:a-1,h=i?1:-1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===Infinity?(r=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-s))<1&&(s--,d*=2),(t+=s+l>=1?f/d:f*Math.pow(2,1-l))*d>=2&&(s++,d/=2),s+l>=u?(r=0,s=u):s+l>=1?(r=(t*d-1)*Math.pow(2,o),s+=l):(r=t*Math.pow(2,l-1)*Math.pow(2,o),s=0));o>=8;e[n+m]=255&r,m+=h,r/=256,o-=8);for(s=s<<o|r,c+=o;c>0;e[n+m]=255&s,m+=h,s/=256,c-=8);e[n+m-h]|=128*_}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{_process:114,buffer:112}],116:[function(e,t,n){(function(i,o,a,s,r,d,c,u,l){!function(e,i){"object"==typeof n&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):e.moment=i()}(this,function(){"use strict";var n,i;function o(){return n.apply(null,arguments)}function a(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function r(e){return void 0===e}function d(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function c(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function u(e,t){var n,i=[];for(n=0;n<e.length;++n)i.push(t(e[n],n));return i}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function f(e,t){for(var n in t)l(t,n)&&(e[n]=t[n]);return l(t,"toString")&&(e.toString=t.toString),l(t,"valueOf")&&(e.valueOf=t.valueOf),e}function m(e,t,n,i){return Tt(e,t,n,i,!0).utc()}function h(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function _(e){if(null==e._isValid){var t=h(e),n=i.call(t.parsedDateParts,function(e){return null!=e}),o=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(o=o&&0===t.charsLeftOver&&0===t.unusedTokens.length&&t.bigHour===undefined),null!=Object.isFrozen&&Object.isFrozen(e))return o;e._isValid=o}return e._isValid}function p(e){var t=m(NaN);return null!=e?f(h(t),e):h(t).userInvalidated=!0,t}i=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,i=0;i<n;i++)if(i in t&&e.call(this,t[i],i,t))return!0;return!1};var g=o.momentProperties=[];function v(e,t){var n,i,o;if(r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),r(t._i)||(e._i=t._i),r(t._f)||(e._f=t._f),r(t._l)||(e._l=t._l),r(t._strict)||(e._strict=t._strict),r(t._tzm)||(e._tzm=t._tzm),r(t._isUTC)||(e._isUTC=t._isUTC),r(t._offset)||(e._offset=t._offset),r(t._pf)||(e._pf=h(t)),r(t._locale)||(e._locale=t._locale),g.length>0)for(n=0;n<g.length;n++)r(o=t[i=g[n]])||(e[i]=o);return e}var y=!1;function b(e){v(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===y&&(y=!0,o.updateOffset(this),y=!1)}function w(e){return e instanceof b||null!=e&&null!=e._isAMomentObject}function M(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function C(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=M(t)),n}function S(e,t,n){var i,o=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),s=0;for(i=0;i<o;i++)(n&&e[i]!==t[i]||!n&&C(e[i])!==C(t[i]))&&s++;return s+a}function A(e){!1===o.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function x(e,t){var n=!0;return f(function(){if(null!=o.deprecationHandler&&o.deprecationHandler(null,e),n){for(var i,a=[],s=0;s<arguments.length;s++){if(i="","object"==typeof arguments[s]){for(var r in i+="\n["+s+"] ",arguments[0])i+=r+": "+arguments[0][r]+", ";i=i.slice(0,-2)}else i=arguments[s];a.push(i)}A(e+"\nArguments: "+Array.prototype.slice.call(a).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)},t)}var D,k={};function T(e,t){null!=o.deprecationHandler&&o.deprecationHandler(e,t),k[e]||(A(t),k[e]=!0)}function E(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function I(e,t){var n,i=f({},e);for(n in t)l(t,n)&&(s(e[n])&&s(t[n])?(i[n]={},f(i[n],e[n]),f(i[n],t[n])):null!=t[n]?i[n]=t[n]:delete i[n]);for(n in e)l(e,n)&&!l(t,n)&&s(e[n])&&(i[n]=f({},i[n]));return i}function R(e){null!=e&&this.set(e)}o.suppressDeprecationWarnings=!1,o.deprecationHandler=null,D=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)l(e,t)&&n.push(t);return n};var $={};function O(e,t){var n=e.toLowerCase();$[n]=$[n+"s"]=$[t]=e}function P(e){return"string"==typeof e?$[e]||$[e.toLowerCase()]:undefined}function q(e){var t,n,i={};for(n in e)l(e,n)&&(t=P(n))&&(i[t]=e[n]);return i}var N={};function B(e,t){N[e]=t}function U(e,t,n){var i=""+Math.abs(e),o=t-i.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+i}var F=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,j=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,H={},Y={};function L(e,t,n,i){var o=i;"string"==typeof i&&(o=function(){return this[i]()}),e&&(Y[e]=o),t&&(Y[t[0]]=function(){return U(o.apply(this,arguments),t[1],t[2])}),n&&(Y[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function J(e,t){return e.isValid()?(t=V(t,e.localeData()),H[t]=H[t]||function(e){var t,n,i,o=e.match(F);for(t=0,n=o.length;t<n;t++)Y[o[t]]?o[t]=Y[o[t]]:o[t]=(i=o[t]).match(/\[[\s\S]/)?i.replace(/^\[|\]$/g,""):i.replace(/\\/g,"");return function(t){var i,a="";for(i=0;i<n;i++)a+=E(o[i])?o[i].call(t,e):o[i];return a}}(t),H[t](e)):e.localeData().invalidDate()}function V(e,t){var n=5;function i(e){return t.longDateFormat(e)||e}for(j.lastIndex=0;n>=0&&j.test(e);)e=e.replace(j,i),j.lastIndex=0,n-=1;return e}var W=/\d/,z=/\d\d/,Z=/\d{3}/,G=/\d{4}/,Q=/[+-]?\d{6}/,K=/\d\d?/,X=/\d\d\d\d?/,ee=/\d\d\d\d\d\d?/,te=/\d{1,3}/,ne=/\d{1,4}/,ie=/[+-]?\d{1,6}/,oe=/\d+/,ae=/[+-]?\d+/,se=/Z|[+-]\d\d:?\d\d/gi,re=/Z|[+-]\d\d(?::?\d\d)?/gi,de=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ce={};function ue(e,t,n){ce[e]=E(t)?t:function(e,i){return e&&n?n:t}}function le(e,t){return l(ce,e)?ce[e](t._strict,t._locale):new RegExp(fe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,o){return t||n||i||o})))}function fe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var me={};function he(e,t){var n,i=t;for("string"==typeof e&&(e=[e]),d(t)&&(i=function(e,n){n[t]=C(e)}),n=0;n<e.length;n++)me[e[n]]=i}function _e(e,t){he(e,function(e,n,i,o){i._w=i._w||{},t(e,i._w,i,o)})}function pe(e,t,n){null!=t&&l(me,e)&&me[e](t,n._a,n,e)}var ge=0,ve=1,ye=2,be=3,we=4,Me=5,Ce=6,Se=7,Ae=8;function xe(e){return De(e)?366:365}function De(e){return e%4==0&&e%100!=0||e%400==0}L("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),L(0,["YY",2],0,function(){return this.year()%100}),L(0,["YYYY",4],0,"year"),L(0,["YYYYY",5],0,"year"),L(0,["YYYYYY",6,!0],0,"year"),O("year","y"),B("year",1),ue("Y",ae),ue("YY",K,z),ue("YYYY",ne,G),ue("YYYYY",ie,Q),ue("YYYYYY",ie,Q),he(["YYYYY","YYYYYY"],ge),he("YYYY",function(e,t){t[ge]=2===e.length?o.parseTwoDigitYear(e):C(e)}),he("YY",function(e,t){t[ge]=o.parseTwoDigitYear(e)}),he("Y",function(e,t){t[ge]=parseInt(e,10)}),o.parseTwoDigitYear=function(e){return C(e)+(C(e)>68?1900:2e3)};var ke,Te=Ee("FullYear",!0);function Ee(e,t){return function(n){return null!=n?(Re(this,e,n),o.updateOffset(this,t),this):Ie(this,e)}}function Ie(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Re(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&De(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),$e(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function $e(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,i=(t%(n=12)+n)%n;return e+=(t-i)/12,1===i?De(e)?29:28:31-i%7%2}ke=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},L("M",["MM",2],"Mo",function(){return this.month()+1}),L("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),L("MMMM",0,0,function(e){return this.localeData().months(this,e)}),O("month","M"),B("month",8),ue("M",K),ue("MM",K,z),ue("MMM",function(e,t){return t.monthsShortRegex(e)}),ue("MMMM",function(e,t){return t.monthsRegex(e)}),he(["M","MM"],function(e,t){t[ve]=C(e)-1}),he(["MMM","MMMM"],function(e,t,n,i){var o=n._locale.monthsParse(e,i,n._strict);null!=o?t[ve]=o:h(n).invalidMonth=e});var Oe=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Pe="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var qe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Ne(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=C(t);else if(!d(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),$e(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Be(e){return null!=e?(Ne(this,e),o.updateOffset(this,!0),this):Ie(this,"Month")}var Ue=de;var Fe=de;function je(){function e(e,t){return t.length-e.length}var t,n,i=[],o=[],a=[];for(t=0;t<12;t++)n=m([2e3,t]),i.push(this.monthsShort(n,"")),o.push(this.months(n,"")),a.push(this.months(n,"")),a.push(this.monthsShort(n,""));for(i.sort(e),o.sort(e),a.sort(e),t=0;t<12;t++)i[t]=fe(i[t]),o[t]=fe(o[t]);for(t=0;t<24;t++)a[t]=fe(a[t]);this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function He(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Ye(e,t,n){var i=7+t-n;return-((7+He(e,0,i).getUTCDay()-t)%7)+i-1}function Le(e,t,n,i,o){var a,s,r=1+7*(t-1)+(7+n-i)%7+Ye(e,i,o);return r<=0?s=xe(a=e-1)+r:r>xe(e)?(a=e+1,s=r-xe(e)):(a=e,s=r),{year:a,dayOfYear:s}}function Je(e,t,n){var i,o,a=Ye(e.year(),t,n),s=Math.floor((e.dayOfYear()-a-1)/7)+1;return s<1?i=s+Ve(o=e.year()-1,t,n):s>Ve(e.year(),t,n)?(i=s-Ve(e.year(),t,n),o=e.year()+1):(o=e.year(),i=s),{week:i,year:o}}function Ve(e,t,n){var i=Ye(e,t,n),o=Ye(e+1,t,n);return(xe(e)-i+o)/7}L("w",["ww",2],"wo","week"),L("W",["WW",2],"Wo","isoWeek"),O("week","w"),O("isoWeek","W"),B("week",5),B("isoWeek",5),ue("w",K),ue("ww",K,z),ue("W",K),ue("WW",K,z),_e(["w","ww","W","WW"],function(e,t,n,i){t[i.substr(0,1)]=C(e)});L("d",0,"do","day"),L("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),L("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),L("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),L("e",0,0,"weekday"),L("E",0,0,"isoWeekday"),O("day","d"),O("weekday","e"),O("isoWeekday","E"),B("day",11),B("weekday",11),B("isoWeekday",11),ue("d",K),ue("e",K),ue("E",K),ue("dd",function(e,t){return t.weekdaysMinRegex(e)}),ue("ddd",function(e,t){return t.weekdaysShortRegex(e)}),ue("dddd",function(e,t){return t.weekdaysRegex(e)}),_e(["dd","ddd","dddd"],function(e,t,n,i){var o=n._locale.weekdaysParse(e,i,n._strict);null!=o?t.d=o:h(n).invalidWeekday=e}),_e(["d","e","E"],function(e,t,n,i){t[i]=C(e)});var We="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var ze="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var Ze="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var Ge=de;var Qe=de;var Ke=de;function Xe(){function e(e,t){return t.length-e.length}var t,n,i,o,a,s=[],r=[],d=[],c=[];for(t=0;t<7;t++)n=m([2e3,1]).day(t),i=this.weekdaysMin(n,""),o=this.weekdaysShort(n,""),a=this.weekdays(n,""),s.push(i),r.push(o),d.push(a),c.push(i),c.push(o),c.push(a);for(s.sort(e),r.sort(e),d.sort(e),c.sort(e),t=0;t<7;t++)r[t]=fe(r[t]),d[t]=fe(d[t]),c[t]=fe(c[t]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+d.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function et(){return this.hours()%12||12}function tt(e,t){L(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function nt(e,t){return t._meridiemParse}L("H",["HH",2],0,"hour"),L("h",["hh",2],0,et),L("k",["kk",2],0,function(){return this.hours()||24}),L("hmm",0,0,function(){return""+et.apply(this)+U(this.minutes(),2)}),L("hmmss",0,0,function(){return""+et.apply(this)+U(this.minutes(),2)+U(this.seconds(),2)}),L("Hmm",0,0,function(){return""+this.hours()+U(this.minutes(),2)}),L("Hmmss",0,0,function(){return""+this.hours()+U(this.minutes(),2)+U(this.seconds(),2)}),tt("a",!0),tt("A",!1),O("hour","h"),B("hour",13),ue("a",nt),ue("A",nt),ue("H",K),ue("h",K),ue("k",K),ue("HH",K,z),ue("hh",K,z),ue("kk",K,z),ue("hmm",X),ue("hmmss",ee),ue("Hmm",X),ue("Hmmss",ee),he(["H","HH"],be),he(["k","kk"],function(e,t,n){var i=C(e);t[be]=24===i?0:i}),he(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),he(["h","hh"],function(e,t,n){t[be]=C(e),h(n).bigHour=!0}),he("hmm",function(e,t,n){var i=e.length-2;t[be]=C(e.substr(0,i)),t[we]=C(e.substr(i)),h(n).bigHour=!0}),he("hmmss",function(e,t,n){var i=e.length-4,o=e.length-2;t[be]=C(e.substr(0,i)),t[we]=C(e.substr(i,2)),t[Me]=C(e.substr(o)),h(n).bigHour=!0}),he("Hmm",function(e,t,n){var i=e.length-2;t[be]=C(e.substr(0,i)),t[we]=C(e.substr(i))}),he("Hmmss",function(e,t,n){var i=e.length-4,o=e.length-2;t[be]=C(e.substr(0,i)),t[we]=C(e.substr(i,2)),t[Me]=C(e.substr(o))});var it,ot=Ee("Hours",!0),at={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Pe,monthsShort:qe,week:{dow:0,doy:6},weekdays:We,weekdaysMin:Ze,weekdaysShort:ze,meridiemParse:/[ap]\.?m?\.?/i},st={},rt={};function dt(e){return e?e.toLowerCase().replace("_","-"):e}function ct(n){var i=null;if(!st[n]&&void 0!==t&&t&&t.exports)try{i=it._abbr,e("./locale/"+n),ut(i)}catch(o){}return st[n]}function ut(e,t){var n;return e&&((n=r(t)?ft(e):lt(e,t))?it=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),it._abbr}function lt(e,t){if(null!==t){var n,i=at;if(t.abbr=e,null!=st[e])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=st[e]._config;else if(null!=t.parentLocale)if(null!=st[t.parentLocale])i=st[t.parentLocale]._config;else{if(null==(n=ct(t.parentLocale)))return rt[t.parentLocale]||(rt[t.parentLocale]=[]),rt[t.parentLocale].push({name:e,config:t}),null;i=n._config}return st[e]=new R(I(i,t)),rt[e]&&rt[e].forEach(function(e){lt(e.name,e.config)}),ut(e),st[e]}return delete st[e],null}function ft(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return it;if(!a(e)){if(t=ct(e))return t;e=[e]}return function(e){for(var t,n,i,o,a=0;a<e.length;){for(t=(o=dt(e[a]).split("-")).length,n=(n=dt(e[a+1]))?n.split("-"):null;t>0;){if(i=ct(o.slice(0,t).join("-")))return i;if(n&&n.length>=t&&S(o,n,!0)>=t-1)break;t--}a++}return it}(e)}function mt(e){var t,n=e._a;return n&&-2===h(e).overflow&&(t=n[ve]<0||n[ve]>11?ve:n[ye]<1||n[ye]>$e(n[ge],n[ve])?ye:n[be]<0||n[be]>24||24===n[be]&&(0!==n[we]||0!==n[Me]||0!==n[Ce])?be:n[we]<0||n[we]>59?we:n[Me]<0||n[Me]>59?Me:n[Ce]<0||n[Ce]>999?Ce:-1,h(e)._overflowDayOfYear&&(t<ge||t>ye)&&(t=ye),h(e)._overflowWeeks&&-1===t&&(t=Se),h(e)._overflowWeekday&&-1===t&&(t=Ae),h(e).overflow=t),e}function ht(e,t,n){return null!=e?e:null!=t?t:n}function _t(e){var t,n,i,a,s,r=[];if(!e._d){for(i=function(e){var t=new Date(o.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[ye]&&null==e._a[ve]&&function(e){var t,n,i,o,a,s,r,d;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)a=1,s=4,n=ht(t.GG,e._a[ge],Je(Et(),1,4).year),i=ht(t.W,1),((o=ht(t.E,1))<1||o>7)&&(d=!0);else{a=e._locale._week.dow,s=e._locale._week.doy;var c=Je(Et(),a,s);n=ht(t.gg,e._a[ge],c.year),i=ht(t.w,c.week),null!=t.d?((o=t.d)<0||o>6)&&(d=!0):null!=t.e?(o=t.e+a,(t.e<0||t.e>6)&&(d=!0)):o=a}i<1||i>Ve(n,a,s)?h(e)._overflowWeeks=!0:null!=d?h(e)._overflowWeekday=!0:(r=Le(n,i,o,a,s),e._a[ge]=r.year,e._dayOfYear=r.dayOfYear)}(e),null!=e._dayOfYear&&(s=ht(e._a[ge],i[ge]),(e._dayOfYear>xe(s)||0===e._dayOfYear)&&(h(e)._overflowDayOfYear=!0),n=He(s,0,e._dayOfYear),e._a[ve]=n.getUTCMonth(),e._a[ye]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=r[t]=i[t];for(;t<7;t++)e._a[t]=r[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[be]&&0===e._a[we]&&0===e._a[Me]&&0===e._a[Ce]&&(e._nextDay=!0,e._a[be]=0),e._d=(e._useUTC?He:function(e,t,n,i,o,a,s){var r=new Date(e,t,n,i,o,a,s);return e<100&&e>=0&&isFinite(r.getFullYear())&&r.setFullYear(e),r}).apply(null,r),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[be]=24),e._w&&"undefined"!=typeof e._w.d&&e._w.d!==a&&(h(e).weekdayMismatch=!0)}}var pt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,vt=/Z|[+-]\d\d(?::?\d\d)?/,yt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],bt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],wt=/^\/?Date\((\-?\d+)/i;function Mt(e){var t,n,i,o,a,s,r=e._i,d=pt.exec(r)||gt.exec(r);if(d){for(h(e).iso=!0,t=0,n=yt.length;t<n;t++)if(yt[t][1].exec(d[1])){o=yt[t][0],i=!1!==yt[t][2];break}if(null==o)return void(e._isValid=!1);if(d[3]){for(t=0,n=bt.length;t<n;t++)if(bt[t][1].exec(d[3])){a=(d[2]||" ")+bt[t][0];break}if(null==a)return void(e._isValid=!1)}if(!i&&null!=a)return void(e._isValid=!1);if(d[4]){if(!vt.exec(d[4]))return void(e._isValid=!1);s="Z"}e._f=o+(a||"")+(s||""),Dt(e)}else e._isValid=!1}var Ct=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function St(e,t,n,i,o,a){var s=[function(e){var t=parseInt(e,10);if(t<=49)return 2e3+t;if(t<=999)return 1900+t;return t}(e),qe.indexOf(t),parseInt(n,10),parseInt(i,10),parseInt(o,10)];return a&&s.push(parseInt(a,10)),s}var At={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function xt(e){var t=Ct.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(t){var n=St(t[4],t[3],t[2],t[5],t[6],t[7]);if(!function(e,t,n){return!e||ze.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(h(n).weekdayMismatch=!0,n._isValid=!1,!1)}(t[1],n,e))return;e._a=n,e._tzm=function(e,t,n){if(e)return At[e];if(t)return 0;var i=parseInt(n,10),o=i%100;return(i-o)/100*60+o}(t[8],t[9],t[10]),e._d=He.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),h(e).rfc2822=!0}else e._isValid=!1}function Dt(e){if(e._f!==o.ISO_8601)if(e._f!==o.RFC_2822){e._a=[],h(e).empty=!0;var t,n,i,a,s,r=""+e._i,d=r.length,c=0;for(i=V(e._f,e._locale).match(F)||[],t=0;t<i.length;t++)a=i[t],(n=(r.match(le(a,e))||[])[0])&&((s=r.substr(0,r.indexOf(n))).length>0&&h(e).unusedInput.push(s),r=r.slice(r.indexOf(n)+n.length),c+=n.length),Y[a]?(n?h(e).empty=!1:h(e).unusedTokens.push(a),pe(a,n,e)):e._strict&&!n&&h(e).unusedTokens.push(a);h(e).charsLeftOver=d-c,r.length>0&&h(e).unusedInput.push(r),e._a[be]<=12&&!0===h(e).bigHour&&e._a[be]>0&&(h(e).bigHour=undefined),h(e).parsedDateParts=e._a.slice(0),h(e).meridiem=e._meridiem,e._a[be]=function(e,t,n){var i;if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((i=e.isPM(n))&&t<12&&(t+=12),i||12!==t||(t=0),t):t}(e._locale,e._a[be],e._meridiem),_t(e),mt(e)}else xt(e);else Mt(e)}function kt(e){var t=e._i,n=e._f;return e._locale=e._locale||ft(e._l),null===t||n===undefined&&""===t?p({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),w(t)?new b(mt(t)):(c(t)?e._d=t:a(n)?function(e){var t,n,i,o,a;if(0===e._f.length)return h(e).invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<e._f.length;o++)a=0,t=v({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],Dt(t),_(t)&&(a+=h(t).charsLeftOver,a+=10*h(t).unusedTokens.length,h(t).score=a,(null==i||a<i)&&(i=a,n=t));f(e,n||t)}(e):n?Dt(e):function(e){var t=e._i;r(t)?e._d=new Date(o.now()):c(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=wt.exec(e._i);null===t?(Mt(e),!1===e._isValid&&(delete e._isValid,xt(e),!1===e._isValid&&(delete e._isValid,o.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):a(t)?(e._a=u(t.slice(0),function(e){return parseInt(e,10)}),_t(e)):s(t)?function(e){if(!e._d){var t=q(e._i);e._a=u([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),_t(e)}}(e):d(t)?e._d=new Date(t):o.createFromInputFallback(e)}(e),_(e)||(e._d=null),e))}function Tt(e,t,n,i,o){var r,d={};return!0!==n&&!1!==n||(i=n,n=undefined),(s(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||a(e)&&0===e.length)&&(e=undefined),d._isAMomentObject=!0,d._useUTC=d._isUTC=o,d._l=n,d._i=e,d._f=t,d._strict=i,(r=new b(mt(kt(d))))._nextDay&&(r.add(1,"d"),r._nextDay=undefined),r}function Et(e,t,n,i){return Tt(e,t,n,i,!1)}o.createFromInputFallback=x("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),o.ISO_8601=function(){},o.RFC_2822=function(){};var It=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Et.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:p()}),Rt=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Et.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:p()});function $t(e,t){var n,i;if(1===t.length&&a(t[0])&&(t=t[0]),!t.length)return Et();for(n=t[0],i=1;i<t.length;++i)t[i].isValid()&&!t[i][e](n)||(n=t[i]);return n}var Ot=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Pt(e){var t=q(e),n=t.year||0,i=t.quarter||0,o=t.month||0,a=t.week||0,s=t.day||0,r=t.hour||0,d=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===ke.call(Ot,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,i=0;i<Ot.length;++i)if(e[Ot[i]]){if(n)return!1;parseFloat(e[Ot[i]])!==C(e[Ot[i]])&&(n=!0)}return!0}(t),this._milliseconds=+u+1e3*c+6e4*d+1e3*r*60*60,this._days=+s+7*a,this._months=+o+3*i+12*n,this._data={},this._locale=ft(),this._bubble()}function qt(e){return e instanceof Pt}function Nt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Bt(e,t){L(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+U(~~(e/60),2)+t+U(~~e%60,2)})}Bt("Z",":"),Bt("ZZ",""),ue("Z",re),ue("ZZ",re),he(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Ft(re,e)});var Ut=/([\+\-]|\d\d)/gi;function Ft(e,t){var n=(t||"").match(e);if(null===n)return null;var i=((n[n.length-1]||[])+"").match(Ut)||["-",0,0],o=60*i[1]+C(i[2]);return 0===o?0:"+"===i[0]?o:-o}function jt(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(w(e)||c(e)?e.valueOf():Et(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),o.updateOffset(n,!1),n):Et(e).local()}function Ht(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Yt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}o.updateOffset=function(){};var Lt=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Jt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Vt(e,t){var n,i,o,a=e,s=null;return qt(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:d(e)?(a={},t?a[t]=e:a.milliseconds=e):(s=Lt.exec(e))?(n="-"===s[1]?-1:1,a={y:0,d:C(s[ye])*n,h:C(s[be])*n,m:C(s[we])*n,s:C(s[Me])*n,ms:C(Nt(1e3*s[Ce]))*n}):(s=Jt.exec(e))?(n="-"===s[1]?-1:(s[1],1),a={y:Wt(s[2],n),M:Wt(s[3],n),w:Wt(s[4],n),d:Wt(s[5],n),h:Wt(s[6],n),m:Wt(s[7],n),s:Wt(s[8],n)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(o=function(e,t){var n;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=jt(t,e),e.isBefore(t)?n=zt(e,t):((n=zt(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(Et(a.from),Et(a.to)),(a={}).ms=o.milliseconds,a.M=o.months),i=new Pt(a),qt(e)&&l(e,"_locale")&&(i._locale=e._locale),i}function Wt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function zt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Zt(e,t){return function(n,i){var o;return null===i||isNaN(+i)||(T(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),Gt(this,Vt(n="string"==typeof n?+n:n,i),e),this}}function Gt(e,t,n,i){var a=t._milliseconds,s=Nt(t._days),r=Nt(t._months);e.isValid()&&(i=null==i||i,r&&Ne(e,Ie(e,"Month")+r*n),s&&Re(e,"Date",Ie(e,"Date")+s*n),a&&e._d.setTime(e._d.valueOf()+a*n),i&&o.updateOffset(e,s||r))}Vt.fn=Pt.prototype,Vt.invalid=function(){return Vt(NaN)};var Qt=Zt(1,"add"),Kt=Zt(-1,"subtract");function Xt(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(n,"months");return-(n+(t-i<0?(t-i)/(i-e.clone().add(n-1,"months")):(t-i)/(e.clone().add(n+1,"months")-i)))||0}function en(e){var t;return e===undefined?this._locale._abbr:(null!=(t=ft(e))&&(this._locale=t),this)}o.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",o.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var tn=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===undefined?this.localeData():this.locale(e)});function nn(){return this._locale}function on(e,t){L(0,[e,e.length],0,t)}function an(e,t,n,i,o){var a;return null==e?Je(this,i,o).year:(t>(a=Ve(e,i,o))&&(t=a),function(e,t,n,i,o){var a=Le(e,t,n,i,o),s=He(a.year,0,a.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}.call(this,e,t,n,i,o))}L(0,["gg",2],0,function(){return this.weekYear()%100}),L(0,["GG",2],0,function(){return this.isoWeekYear()%100}),on("gggg","weekYear"),on("ggggg","weekYear"),on("GGGG","isoWeekYear"),on("GGGGG","isoWeekYear"),O("weekYear","gg"),O("isoWeekYear","GG"),B("weekYear",1),B("isoWeekYear",1),ue("G",ae),ue("g",ae),ue("GG",K,z),ue("gg",K,z),ue("GGGG",ne,G),ue("gggg",ne,G),ue("GGGGG",ie,Q),ue("ggggg",ie,Q),_e(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,i){t[i.substr(0,2)]=C(e)}),_e(["gg","GG"],function(e,t,n,i){t[i]=o.parseTwoDigitYear(e)}),L("Q",0,"Qo","quarter"),O("quarter","Q"),B("quarter",7),ue("Q",W),he("Q",function(e,t){t[ve]=3*(C(e)-1)}),L("D",["DD",2],"Do","date"),O("date","D"),B("date",9),ue("D",K),ue("DD",K,z),ue("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),he(["D","DD"],ye),he("Do",function(e,t){t[ye]=C(e.match(K)[0])});var sn=Ee("Date",!0);L("DDD",["DDDD",3],"DDDo","dayOfYear"),O("dayOfYear","DDD"),B("dayOfYear",4),ue("DDD",te),ue("DDDD",Z),he(["DDD","DDDD"],function(e,t,n){n._dayOfYear=C(e)}),L("m",["mm",2],0,"minute"),O("minute","m"),B("minute",14),ue("m",K),ue("mm",K,z),he(["m","mm"],we);var rn=Ee("Minutes",!1);L("s",["ss",2],0,"second"),O("second","s"),B("second",15),ue("s",K),ue("ss",K,z),he(["s","ss"],Me);var dn,cn=Ee("Seconds",!1);for(L("S",0,0,function(){return~~(this.millisecond()/100)}),L(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),L(0,["SSS",3],0,"millisecond"),L(0,["SSSS",4],0,function(){return 10*this.millisecond()}),L(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),L(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),L(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),L(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),L(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),O("millisecond","ms"),B("millisecond",16),ue("S",te,W),ue("SS",te,z),ue("SSS",te,Z),dn="SSSS";dn.length<=9;dn+="S")ue(dn,oe);function un(e,t){t[Ce]=C(1e3*("0."+e))}for(dn="S";dn.length<=9;dn+="S")he(dn,un);var ln=Ee("Milliseconds",!1);L("z",0,0,"zoneAbbr"),L("zz",0,0,"zoneName");var fn=b.prototype;function mn(e){return e}fn.add=Qt,fn.calendar=function(e,t){var n=e||Et(),i=jt(n,this).startOf("day"),a=o.calendarFormat(this,i)||"sameElse",s=t&&(E(t[a])?t[a].call(this,n):t[a]);return this.format(s||this.localeData().calendar(a,this,Et(n)))},fn.clone=function(){return new b(this)},fn.diff=function(e,t,n){var i,o,a;if(!this.isValid())return NaN;if(!(i=jt(e,this)).isValid())return NaN;switch(o=6e4*(i.utcOffset()-this.utcOffset()),t=P(t)){case"year":a=Xt(this,i)/12;break;case"month":a=Xt(this,i);break;case"quarter":a=Xt(this,i)/3;break;case"second":a=(this-i)/1e3;break;case"minute":a=(this-i)/6e4;break;case"hour":a=(this-i)/36e5;break;case"day":a=(this-i-o)/864e5;break;case"week":a=(this-i-o)/6048e5;break;default:a=this-i}return n?a:M(a)},fn.endOf=function(e){return(e=P(e))===undefined||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))},fn.format=function(e){e||(e=this.isUtc()?o.defaultFormatUtc:o.defaultFormat);var t=J(this,e);return this.localeData().postformat(t)},fn.from=function(e,t){return this.isValid()&&(w(e)&&e.isValid()||Et(e).isValid())?Vt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},fn.fromNow=function(e){return this.from(Et(),e)},fn.to=function(e,t){return this.isValid()&&(w(e)&&e.isValid()||Et(e).isValid())?Vt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},fn.toNow=function(e){return this.to(Et(),e)},fn.get=function(e){return E(this[e=P(e)])?this[e]():this},fn.invalidAt=function(){return h(this).overflow},fn.isAfter=function(e,t){var n=w(e)?e:Et(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=P(r(t)?"millisecond":t))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},fn.isBefore=function(e,t){var n=w(e)?e:Et(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=P(r(t)?"millisecond":t))?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},fn.isBetween=function(e,t,n,i){return("("===(i=i||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===i[1]?this.isBefore(t,n):!this.isAfter(t,n))},fn.isSame=function(e,t){var n,i=w(e)?e:Et(e);return!(!this.isValid()||!i.isValid())&&("millisecond"===(t=P(t||"millisecond"))?this.valueOf()===i.valueOf():(n=i.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},fn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},fn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},fn.isValid=function(){return _(this)},fn.lang=tn,fn.locale=en,fn.localeData=nn,fn.max=Rt,fn.min=It,fn.parsingFlags=function(){return f({},h(this))},fn.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:N[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=q(e)),i=0;i<n.length;i++)this[n[i].unit](e[n[i].unit]);else if(E(this[e=P(e)]))return this[e](t);return this},fn.startOf=function(e){switch(e=P(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},fn.subtract=Kt,fn.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},fn.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},fn.toDate=function(){return new Date(this.valueOf())},fn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?J(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):E(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",J(n,"Z")):J(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},fn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o=t+'[")]';return this.format(n+i+"-MM-DD[T]HH:mm:ss.SSS"+o)},fn.toJSON=function(){return this.isValid()?this.toISOString():null},fn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},fn.unix=function(){return Math.floor(this.valueOf()/1e3)},fn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},fn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},fn.year=Te,fn.isLeapYear=function(){return De(this.year())},fn.weekYear=function(e){return an.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},fn.isoWeekYear=function(e){return an.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},fn.quarter=fn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},fn.month=Be,fn.daysInMonth=function(){return $e(this.year(),this.month())},fn.week=fn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},fn.isoWeek=fn.isoWeeks=function(e){var t=Je(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},fn.weeksInYear=function(){var e=this.localeData()._week;return Ve(this.year(),e.dow,e.doy)},fn.isoWeeksInYear=function(){return Ve(this.year(),1,4)},fn.date=sn,fn.day=fn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},fn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},fn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},fn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},fn.hour=fn.hours=ot,fn.minute=fn.minutes=rn,fn.second=fn.seconds=cn,fn.millisecond=fn.milliseconds=ln,fn.utcOffset=function(e,t,n){var i,a=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Ft(re,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=Ht(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),a!==e&&(!t||this._changeInProgress?Gt(this,Vt(e-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,o.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?a:Ht(this)},fn.utc=function(e){return this.utcOffset(0,e)},fn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ht(this),"m")),this},fn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ft(se,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},fn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Et(e).utcOffset():0,(this.utcOffset()-e)%60==0)},fn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},fn.isLocal=function(){return!!this.isValid()&&!this._isUTC},fn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},fn.isUtc=Yt,fn.isUTC=Yt,fn.zoneAbbr=function(){return this._isUTC?"UTC":""},fn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},fn.dates=x("dates accessor is deprecated. Use date instead.",sn),fn.months=x("months accessor is deprecated. Use month instead",Be),fn.years=x("years accessor is deprecated. Use year instead",Te),fn.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),fn.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!r(this._isDSTShifted))return this._isDSTShifted;var e={};if(v(e,this),(e=kt(e))._a){var t=e._isUTC?m(e._a):Et(e._a);this._isDSTShifted=this.isValid()&&S(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var hn=R.prototype;function _n(e,t,n,i){var o=ft(),a=m().set(i,t);return o[n](a,e)}function pn(e,t,n){if(d(e)&&(t=e,e=undefined),e=e||"",null!=t)return _n(e,t,n,"month");var i,o=[];for(i=0;i<12;i++)o[i]=_n(e,i,n,"month");return o}function gn(e,t,n,i){"boolean"==typeof e?(d(t)&&(n=t,t=undefined),t=t||""):(n=t=e,e=!1,d(t)&&(n=t,t=undefined),t=t||"");var o,a=ft(),s=e?a._week.dow:0;if(null!=n)return _n(t,(n+s)%7,i,"day");var r=[];for(o=0;o<7;o++)r[o]=_n(t,(o+s)%7,i,"day");return r}hn.calendar=function(e,t,n){var i=this._calendar[e]||this._calendar.sameElse;return E(i)?i.call(t,n):i},hn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},hn.invalidDate=function(){return this._invalidDate},hn.ordinal=function(e){return this._ordinal.replace("%d",e)},hn.preparse=mn,hn.postformat=mn,hn.relativeTime=function(e,t,n,i){var o=this._relativeTime[n];return E(o)?o(e,t,n,i):o.replace(/%d/i,e)},hn.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return E(n)?n(t):n.replace(/%s/i,t)},hn.set=function(e){var t,n;for(n in e)E(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},hn.months=function(e,t){return e?a(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Oe).test(t)?"format":"standalone"][e.month()]:a(this._months)?this._months:this._months.standalone},hn.monthsShort=function(e,t){return e?a(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Oe.test(t)?"format":"standalone"][e.month()]:a(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},hn.monthsParse=function(e,t,n){var i,o,a;if(this._monthsParseExact)return function(e,t,n){var i,o,a,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)a=m([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(a,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(o=ke.call(this._shortMonthsParse,s))?o:null:-1!==(o=ke.call(this._longMonthsParse,s))?o:null:"MMM"===t?-1!==(o=ke.call(this._shortMonthsParse,s))?o:-1!==(o=ke.call(this._longMonthsParse,s))?o:null:-1!==(o=ke.call(this._longMonthsParse,s))?o:-1!==(o=ke.call(this._shortMonthsParse,s))?o:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(o=m([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(a="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[i]=new RegExp(a.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}},hn.monthsRegex=function(e){return this._monthsParseExact?(l(this,"_monthsRegex")||je.call(this),e?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=Fe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},hn.monthsShortRegex=function(e){return this._monthsParseExact?(l(this,"_monthsRegex")||je.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=Ue),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},hn.week=function(e){return Je(e,this._week.dow,this._week.doy).week},hn.firstDayOfYear=function(){return this._week.doy},hn.firstDayOfWeek=function(){return this._week.dow},hn.weekdays=function(e,t){return e?a(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:a(this._weekdays)?this._weekdays:this._weekdays.standalone},hn.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},hn.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},hn.weekdaysParse=function(e,t,n){var i,o,a;if(this._weekdaysParseExact)return function(e,t,n){var i,o,a,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)a=m([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(a,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(o=ke.call(this._weekdaysParse,s))?o:null:"ddd"===t?-1!==(o=ke.call(this._shortWeekdaysParse,s))?o:null:-1!==(o=ke.call(this._minWeekdaysParse,s))?o:null:"dddd"===t?-1!==(o=ke.call(this._weekdaysParse,s))?o:-1!==(o=ke.call(this._shortWeekdaysParse,s))?o:-1!==(o=ke.call(this._minWeekdaysParse,s))?o:null:"ddd"===t?-1!==(o=ke.call(this._shortWeekdaysParse,s))?o:-1!==(o=ke.call(this._weekdaysParse,s))?o:-1!==(o=ke.call(this._minWeekdaysParse,s))?o:null:-1!==(o=ke.call(this._minWeekdaysParse,s))?o:-1!==(o=ke.call(this._weekdaysParse,s))?o:-1!==(o=ke.call(this._shortWeekdaysParse,s))?o:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(o=m([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(a="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[i]=new RegExp(a.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[i].test(e))return i;if(n&&"ddd"===t&&this._shortWeekdaysParse[i].test(e))return i;if(n&&"dd"===t&&this._minWeekdaysParse[i].test(e))return i;if(!n&&this._weekdaysParse[i].test(e))return i}},hn.weekdaysRegex=function(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Xe.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=Ge),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},hn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Xe.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Qe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},hn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Xe.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ke),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},hn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},hn.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},ut("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===C(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),o.lang=x("moment.lang is deprecated. Use moment.locale instead.",ut),o.langData=x("moment.langData is deprecated. Use moment.localeData instead.",ft);var vn=Math.abs;function yn(e,t,n,i){var o=Vt(t,n);return e._milliseconds+=i*o._milliseconds,e._days+=i*o._days,e._months+=i*o._months,e._bubble()}function bn(e){return e<0?Math.floor(e):Math.ceil(e)}function wn(e){return 4800*e/146097}function Mn(e){return 146097*e/4800}function Cn(e){return function(){return this.as(e)}}var Sn=Cn("ms"),An=Cn("s"),xn=Cn("m"),Dn=Cn("h"),kn=Cn("d"),Tn=Cn("w"),En=Cn("M"),In=Cn("y");function Rn(e){return function(){return this.isValid()?this._data[e]:NaN}}var $n=Rn("milliseconds"),On=Rn("seconds"),Pn=Rn("minutes"),qn=Rn("hours"),Nn=Rn("days"),Bn=Rn("months"),Un=Rn("years");var Fn=Math.round,jn={ss:44,s:45,m:45,h:22,d:26,M:11};var Hn=Math.abs;function Yn(e){return(e>0)-(e<0)||+e}function Ln(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Hn(this._milliseconds)/1e3,i=Hn(this._days),o=Hn(this._months);t=M((e=M(n/60))/60),n%=60,e%=60;var a=M(o/12),s=o%=12,r=i,d=t,c=e,u=n?n.toFixed(3).replace(/\.?0+$/,""):"",l=this.asSeconds();if(!l)return"P0D";var f=l<0?"-":"",m=Yn(this._months)!==Yn(l)?"-":"",h=Yn(this._days)!==Yn(l)?"-":"",_=Yn(this._milliseconds)!==Yn(l)?"-":"";return f+"P"+(a?m+a+"Y":"")+(s?m+s+"M":"")+(r?h+r+"D":"")+(d||c||u?"T":"")+(d?_+d+"H":"")+(c?_+c+"M":"")+(u?_+u+"S":"")}var Jn=Pt.prototype;return Jn.isValid=function(){return this._isValid},Jn.abs=function(){var e=this._data;return this._milliseconds=vn(this._milliseconds),this._days=vn(this._days),this._months=vn(this._months),e.milliseconds=vn(e.milliseconds),e.seconds=vn(e.seconds),e.minutes=vn(e.minutes),e.hours=vn(e.hours),e.months=vn(e.months),e.years=vn(e.years),this},Jn.add=function(e,t){return yn(this,e,t,1)},Jn.subtract=function(e,t){return yn(this,e,t,-1)},Jn.as=function(e){if(!this.isValid())return NaN;var t,n,i=this._milliseconds;if("month"===(e=P(e))||"year"===e)return t=this._days+i/864e5,n=this._months+wn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(Mn(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}},Jn.asMilliseconds=Sn,Jn.asSeconds=An,Jn.asMinutes=xn,Jn.asHours=Dn,Jn.asDays=kn,Jn.asWeeks=Tn,Jn.asMonths=En,Jn.asYears=In,Jn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*C(this._months/12):NaN},Jn._bubble=function(){var e,t,n,i,o,a=this._milliseconds,s=this._days,r=this._months,d=this._data;return a>=0&&s>=0&&r>=0||a<=0&&s<=0&&r<=0||(a+=864e5*bn(Mn(r)+s),s=0,r=0),d.milliseconds=a%1e3,e=M(a/1e3),d.seconds=e%60,t=M(e/60),d.minutes=t%60,n=M(t/60),d.hours=n%24,r+=o=M(wn(s+=M(n/24))),s-=bn(Mn(o)),i=M(r/12),r%=12,d.days=s,d.months=r,d.years=i,this},Jn.clone=function(){return Vt(this)},Jn.get=function(e){return e=P(e),this.isValid()?this[e+"s"]():NaN},Jn.milliseconds=$n,Jn.seconds=On,Jn.minutes=Pn,Jn.hours=qn,Jn.days=Nn,Jn.weeks=function(){return M(this.days()/7)},Jn.months=Bn,Jn.years=Un,Jn.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=function(e,t,n){var i=Vt(e).abs(),o=Fn(i.as("s")),a=Fn(i.as("m")),s=Fn(i.as("h")),r=Fn(i.as("d")),d=Fn(i.as("M")),c=Fn(i.as("y")),u=o<=jn.ss&&["s",o]||o<jn.s&&["ss",o]||a<=1&&["m"]||a<jn.m&&["mm",a]||s<=1&&["h"]||s<jn.h&&["hh",s]||r<=1&&["d"]||r<jn.d&&["dd",r]||d<=1&&["M"]||d<jn.M&&["MM",d]||c<=1&&["y"]||["yy",c];return u[2]=t,u[3]=+e>0,u[4]=n,function(e,t,n,i,o){return o.relativeTime(t||1,!!n,e,i)}.apply(null,u)}(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},Jn.toISOString=Ln,Jn.toString=Ln,Jn.toJSON=Ln,Jn.locale=en,Jn.localeData=nn,Jn.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ln),Jn.lang=tn,L("X",0,0,"unix"),L("x",0,0,"valueOf"),ue("x",ae),ue("X",/[+-]?\d+(\.\d{1,3})?/),he("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),he("x",function(e,t,n){n._d=new Date(C(e))}),o.version="2.22.2",n=Et,o.fn=fn,o.min=function(){return $t("isBefore",[].slice.call(arguments,0))},o.max=function(){return $t("isAfter",[].slice.call(arguments,0))},o.now=function(){return Date.now?Date.now():+new Date},o.utc=m,o.unix=function(e){return Et(1e3*e)},o.months=function(e,t){return pn(e,t,"months")},o.isDate=c,o.locale=ut,o.invalid=p,o.duration=Vt,o.isMoment=w,o.weekdays=function(e,t,n){return gn(e,t,n,"weekdays")},o.parseZone=function(){return Et.apply(null,arguments).parseZone()},o.localeData=ft,o.isDuration=qt,o.monthsShort=function(e,t){return pn(e,t,"monthsShort")},o.weekdaysMin=function(e,t,n){return gn(e,t,n,"weekdaysMin")},o.defineLocale=lt,o.updateLocale=function(e,t){if(null!=t){var n,i,o=at;null!=(i=ct(e))&&(o=i._config),(n=new R(t=I(o,t))).parentLocale=st[e],st[e]=n,ut(e)}else null!=st[e]&&(null!=st[e].parentLocale?st[e]=st[e].parentLocale:null!=st[e]&&delete st[e]);return st[e]},o.locales=function(){return D(st)},o.weekdaysShort=function(e,t,n){return gn(e,t,n,"weekdaysShort")},o.normalizeUnits=P,o.relativeTimeRounding=function(e){return e===undefined?Fn:"function"==typeof e&&(Fn=e,!0)},o.relativeTimeThreshold=function(e,t){return jn[e]!==undefined&&(t===undefined?jn[e]:(jn[e]=t,"s"===e&&(jn.ss=t-1),!0))},o.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},o.prototype=fn,o.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},o})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/moment/moment.js","/node_modules/moment")},{_process:114,buffer:112}],common_api:[function(e,t,n){(function(n,o,a,s,r,d,c,u,l){var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=e("./api_endpoints"),p=e("./method_endpoints"),g=0,v=null;"undefined"==typeof jiffle?(window.jiffle={},"undefined"!=typeof JNBookMeeting?(jiffle.JNBookMeeting=JNBookMeeting,jiffleSFObj="JNBookMeeting"):"undefined"!=typeof JNEventMeetingList&&(jiffle.JNEventMeetingList=JNEventMeetingList,jiffleSFObj="JNEventMeetingList")):jiffle.hasOwnProperty("JNEventMeetingList")?jiffleSFObj="JNEventMeetingList":jiffle.hasOwnProperty("JNBookMeeting")&&(jiffleSFObj="JNBookMeeting"),$(document).ready(function(){$("#cover").fadeIn(),v=$.urlParam("current_location_uuid"),$(window).on("load",function(){$("#cover").fadeIn()}),$.urlParam=function(e,t){var n=t||window.location.href,i=new RegExp("[?&]"+e+"=([^&#]*)").exec(n);return null==i?"":i[1]||0};var e=y.fetch({url:y.ENDPOINTS.get_nav_header});e.then(function(e){var t=HandlebarsTemplates["sfdc/nav-header"]({headerLinks:e.data.links});$("#sfdc_navbar_set").remove(),!$(".navbar-set-wrapper").length&&$("#sf-jiffle-now").prepend(t)}),e["catch"](function(e){this.showError(e)}.bind(this))});var y={ENDPOINTS:h,update:function(e){e.data&&e.data.constructor===FormData?e.data.append("current_location_uuid",envDetails.current_location_uuid||v):_.merge(e,{data:{current_location_uuid:envDetails.current_location_uuid||v}});var t=new Promise(function(t,n){g++,/^https?/.test(e.url)?e.sfdc_method?y.parseUrlMethod(e,t,n):($("#cover").fadeIn(),y.makeJNCall("doJNPost",JSON.stringify(e),t,n)):y.parseUrlMethod(e,t,n)});return t.then(function(e,t){--g||$("#cover").fadeOut()}.bind(this)),t[t.fail?"fail":"catch"](function(e){--g||$("#cover").fadeOut()}.bind(this)),t},replaceUrlParams:function(){var e=_.cloneDeep(arguments[0]);for("object"!==(void 0===e?"undefined":m(e))&&(e={url:e}),i=1;i<arguments.length;i++)e.url=e.url.replace(arguments[i][0],arguments[i][1]);return e},fetch:function(e){_.merge(e,{data:{current_location_uuid:envDetails.current_location_uuid||v}});var t=new Promise(function(t,n){g++,$("#cover").fadeIn(),e.url&&e.url.includes("/domains/validate")&&(e.url="/portal/domains/validate"),y.parseUrlMethod(e,t,n)});return t.then(function(e){0===--g&&window.setTimeout(function(){0===g&&$("#cover").fadeOut()},500)}.bind(this)),t[t.fail?"fail":"catch"](function(e){0===--g&&$("#cover").fadeOut()}.bind(this)),t},parseUrlMethod:function(e,t,n){var i="";$.isEmptyObject(e.data)||(i="SFDC"===e.url||"/fetch_sfdc_contacts_fields"===e.url?e.data:$.param({api_params:e.data}),"/user/create"!==e.url&&"/group_nomination/can_attend"!==e.url&&"/sync_att_to_sfdc"!==e.url&&"/portal/consent.json"!==e.url||(i=JSON.stringify({api_params:e.data}))),e.prefix&&(e.url=e.prefix+e.url);var o={queryStr:i,url:e.url,eventName:e.url.includes("/portal")?"":$.urlParam("eventName")},a=_.invert(y.ENDPOINTS)[e.url]||e.sfdc_method,s=p[a]||{},r=s.sfdcMethod||"callJNMethod",d=s.params?s.params(e):{},c=_.assign(o,d),u=s.callback;y.makeJNCall(r,c,t,n,u)},makeJNCall:function(e,t,n,i,o){jiffle[jiffleSFObj][e](t,function(e,t){y.handleSessionExpiry(t);var a={responseJSON:{}};"string"!=typeof e&&(e=JSON.stringify(e));var s=JSON.parse(_.unescape(e));200===t.statusCode?(void 0!==o&&s.data&&(s=o(s)),s.status||s.success?200===s.status||s.success?n(s):(a.responseJSON=s,i(a)):s.error&&!_.isEmpty(s.error)?(a.responseJSON=s,i(a)):n(s)):(a.responseJSON=s,i(s))})},hasSessionExpired:function(e){return"exception"===e.type&&e.message&&-1!=e.message.indexOf("Logged in?")},handleSessionExpiry:function(e){var t=function(){return window.location.reload()};y.hasSessionExpired(e)&&(setTimeout(t,3e3),$(".notification-modal").notificationModal({"class":"red",title:"Information",body:"You have been logged out",dismiss:t}))},sfdcHandler:{meetingInit:function(e){var t=y.fetch({url:y.ENDPOINTS.event_env_details});t.then(function(t){window.envDetails={},envDetails.event=t.data.event,envDetails.currentMeetingUuid=t.data.new_meeting_uuid,envDetails.canShowAttachmentsField=!1,envDetails.currentUser=t.data.current_user,envDetails.current_location=t.data.current_location,envDetails.current_location_uuid=t.data.current_location_uuid||v,envDetails.isCSM=function(){return t.data.isCSM},envDetails.isMeetingManager=function(){return t.data.isMeetingManager},envDetails.isEBCEvent=function(){return t.data.isEBCEvent},envDetails.isJuniorMM=function(){return t.data.isJuniorMM},envDetails.isQueueManager=function(){return t.data.isQueueManager},envDetails.isActivityManager=function(){return t.data.isActivityManager},envDetails.isExecutiveAdmin=function(){return t.data.isExecutiveAdmin},window.isEBCEvent=t.data.isEBCEvent,window.event_home_page=!1,this.displayEventName(),this.fetchMeetingActivities(e)}.bind(this)),t["catch"](function(e){this.showError(e)}.bind(this))},fetchMeetingActivities:function(e){var t="";$.urlParam("accid")?t="accFlow":$.urlParam("lead_ids")&&(t="leadFlow"),y.fetch({url:y.ENDPOINTS.fetch_activities,data:{source:t}}).then(function(t){window.activties_attributes=t.data.meeting_types,"function"==typeof e&&e()})},bookMeetingInit:function(e,t){meetingInfo={account_id:"",requestors:[],externalAttendees:{},selectedRequestor:"",domain_validate_url:"",request:{mode:"new",meeting_with:"",custom_fields:{},showCancel:!1}},envDetails={companyName:"",currentManagedUser:"",currentUser:{first_name:"",last_name:""}};var n=y.fetch({url:e.url,data:{activity_uuid:$.urlParam("activity_uuid"),topic_uuid:$.urlParam("topic_uuid")}});n.then(function(n){var i=n;i.hasOwnProperty("data")&&(i=i.data),n.data.current_user.consent_given?($("#sf-jiffle-now").removeClass("hide"),meetingInfo.requestors=i.requestors,meetingInfo.selected_requestor=i.selected_requestor,meetingInfo.domainValidateUrl=i.domain_validate_url,meetingInfo.request=$.extend(meetingInfo.request,i.meeting||i.nomination),meetingInfo.request.topic_management=n.data.topic,window.actions_on_behalf=i.actions_on_behalf,window.isEBCEvent=n.data.isEBCEvent||!1,window.isOngoingSales=n.data.isOngoingSales||!1,window.selectedActivityUuid=$.urlParam("activity_uuid")||n.data.selectedActivityUuid,envDetails.currentMeetingUuid=n.data.new_meeting_uuid,envDetails.canShowAttachmentsField=!1,"edit"===e.mode?(meetingInfo.request.mode=i.mode,meetingInfo.request.showCancel=i.show_cancel_meeting,meetingInfo.request.end_time=moment(meetingInfo.request.end_time).utc().format("DD-MM-YYYY HH:mm"),meetingInfo.request.start_time=moment(meetingInfo.request.start_time).utc().format("DD-MM-YYYY HH:mm"),envDetails.currentMeetingUuid=meetingInfo.request.uuid):"view"===e.mode&&(meetingInfo.request.mode="view",envDetails.currentMeetingUuid=meetingInfo.request.uuid,meetingInfo.request.end_time=moment(meetingInfo.request.end_time).utc().format("DD-MM-YYYY HH:mm"),meetingInfo.request.start_time=moment(meetingInfo.request.start_time).utc().format("DD-MM-YYYY HH:mm")),envDetails.currentManagedUser=i.current_managed_user,envDetails.currentUser=i.current_user,envDetails.role_uuid=i.role_uuid,envDetails.companyName=i.event.company_display_name,envDetails.event=i.event,envDetails.current_location=i.current_location,envDetails.current_location_uuid=i.current_location_uuid||v,envDetails.enable_meeting_host=i.enable_meeting_host,envDetails.meeting_host_label=i.meeting_host_label,envDetails.assign_requestors_as_meeting_host_by_default=i.assign_requestors_as_meeting_host_by_default,envDetails.assign_mapped_user_as_meeting_host_by_default=i.assign_mapped_user_as_meeting_host_by_default,envDetails.isExecutiveAdmin=function(){return i.isExecutiveAdmin},envDetails.isMeetingManager=function(){return i.isMeetingManager},envDetails.isQueueManager=function(){return i.isQueueManager},envDetails.isCSM=function(){return i.isCSM},envDetails.isJuniorMM=function(){return i.isJuniorMM},rails_to_html={activity_name:n.data.selectedActivityName||"",topic_config:{topic_management_enabled:i.topic_management_enabled||!1}},briefing_uuid=i.briefing_uuid||undefined,mappingEnabled=i.mappingEnabled||!1,envDetails.syncContactsToSfdc=i.syncContactsToSfdc||!1,envDetails.syncContactsToSfdcOpportunity=i.syncContactsToSfdcOpportunity||!1,envDetails.syncLeadsToSfdc=i.syncLeadsToSfdc||!1,envDetails.hideOpportunityInAccountsFlow=i.hideOpportunityInAccountsFlow||!1,envDetails.hideOpportunityInJNMeetingFlow=i.hideOpportunityInJNMeetingFlow||!1,envDetails.showJifflenowExternalAttendees=i.showAllExternalAttendees||i.showRegisteredExternalAttendees||!1,envDetails.topicManagementEnabled=i.topic_management_enabled||!1,envDetails.topicRoomMappingEnabled=i.topic_room_mapping_enabled||!1,envDetails.topicUserMappingEnabled=i.topic_user_mapping_enabled||!1,envDetails.topicActivitiesMappingEnabled=i.topic_activities_mapping_enabled||!1,envDetails.allowUserToAddNewExternalAttendee=i.allowUserToAddNewExternalAttendee||!1,envDetails.allowRequestorToAddInternalAttendee=i.allowRequestorToAddInternalAttendee||!1,envDetails.canUserChangeSelfAttendance=i.can_user_change_self_attendance||!1,envDetails.briefingAndMeetingRequestorSame=i.briefingAndMeetingRequestorSame,envDetails.capture_consent=i.capture_consent,envDetails.consent_mandatory=i.consent_mandatory,envDetails.add_user_consent_message=i.add_user_consent_message,envDetails.can_edit_time=i.can_edit_briefing_meeting_time,bam_uuid=i.bam_uuid,window.masterMeetingType=i.meeting_type_master,window.bookSession=i.book_session,window.TRACK_AND_SESSION=i.TRACK_AND_SESSION,window.nominationInfo=meetingInfo,window.mapping_module=!1,window.selectedActivityName=n.data.selectedActivityName,envDetails.sfdcCustomLabels=n.data.sfdc_custom_labels,this.displayEventName(),this.displayConsentCheck(i),this.mergeExternalAttendeesInfoFromSF().then(function(){return t()})):this.showConsentForm(n.data)}.bind(this)),n["catch"](function(e){this.showError(e)}.bind(this))},displayConsentCheck:function(){var e=$(".js-termsandcondition");envDetails.capture_consent&&e.removeClass("hide"),envDetails.consent_mandatory&&e.addClass("required"),envDetails.add_user_consent_message&&e.find("label.add_user_consent_message").html(envDetails.add_user_consent_message)},displayEventName:function(){$(".js-event-display-name").text(envDetails.event.name)},fetchLeadDetails:function(){var e=unescape($.urlParam("lead_ids")).split(","),t=this.fetchLeadsDetailsFromSF(e);return t.then(function(e){meetingInfo.request.users={internal:[],external:e.data.items}}),t},EventInit:function(e){var t=y.fetch({url:y.ENDPOINTS.user_info});t.then(function(t){t.data.current_user.consent_given?($("#sf-jiffle-now").removeClass("hide"),window.envDetails={},window.isEBCEvent=t.data.isEBCEvent||!1,envDetails.currentUser=t.data.current_user,envDetails.isCSM=function(){return t.data.isCSM},envDetails.isMeetingManager=function(){return t.data.isMeetingManager},envDetails.isAccountManager=function(){return t.data.isAccountManager},_.isEmpty($.urlParam("lead_ids"))&&"leadFlow"!==$.urlParam("source")?e():this.validateLeads(e)):this.showConsentForm(t.data)}.bind(this)),t["catch"](function(e){this.showError(e)}.bind(this))},validateLeads:function(e){y.fetch({url:y.ENDPOINTS.validate_leads,data:{leadIds:unescape($.urlParam("lead_ids")).split(",")}}).then(function(t){t.data.is_valid?e():$(".notification-modal").notificationModal({"class":"red",title:"Information",body:t.data.message,dismiss:function(){commons.redirectPage(t.data.redirect_url)}})})},showConsentForm:function(t){$("#sf-jiffle-consent").removeClass("hide"),e("../../Consent/app")(t)},showError:function(e){var t=[];t=e.responseJSON.error&&"string"==typeof e.responseJSON.error?[e.responseJSON.error]:_.flatten(_.values(e.responseJSON.errors)),$(".notification-modal").notificationModal({"class":"red",timeout:!0,title:"Information",body:t.join(", ")}),$("#cover").fadeOut()},mergeExternalAttendeesInfoFromSF:function(){var e=this,t=window.meetingInfo.request,n=t.users||{};return new Promise(function(i,o){n.external&&n.external.length?_.isEmpty(t.custom_fields&&t.custom_fields.meeting_lead_id)?e.mergeContacts().then(function(){return i()}):e.mergeLeads().then(function(){return i()}):i()})},mergeContacts:function(){var e=this,t=this.getContactIds(),n=window.meetingInfo.request;return new Promise(function(i,o){t.length?e.fetchContactsDetailsFromSF({contactIds:t,accountID:n.custom_fields&&n.custom_fields.meeting_account_id}).then(function(t){return e.mergeExtAttWithInfoFromSF(t.data.items)}).then(function(){return i()}):i()})},mergeLeads:function(){var e=this,t=this.getLeadIds();return new Promise(function(n,i){t.length?e.fetchLeadsDetailsFromSF(t).then(function(t){return e.mergeExtAttWithInfoFromSF(t.data.items)}).then(function(){return n()}):n()})},fetchLeadsDetailsFromSF:function(e){return y.fetch({url:y.ENDPOINTS.lead_details,data:{leadIds:e}})},fetchContactsDetailsFromSF:function(e){var t=e.contactIds,n=e.accountID;return y.fetch({url:y.ENDPOINTS.fetch_contacts,data:{contactIds:t,account_id:n}})},mergeExtAttWithInfoFromSF:function(e){return new Promise(function(t,n){var i=_.groupBy(e,"email"),o=window.meetingInfo.request.users.external;window.meetingInfo.request.users.external=o.map(function(e){var t=i[e.email];return t&&(e=f({},e,t[0])),e}),t()})},getLeadIds:function(){return this.getContOrLeadIds("sfdc_lead_id")},getContactIds:function(){return this.getContOrLeadIds("sfdc_contact_id")},getContOrLeadIds:function(e){return window.meetingInfo.request.users.external.map(function(t){return t.meta_info&&t.meta_info[e]}).filter(function(e){return e!==undefined})}}};t.exports=y}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/app/scripts/commons/sfdc/api.js","/app/scripts/commons/sfdc")},{"../../Consent/app":67,"./api_endpoints":100,"./method_endpoints":101,_process:114,buffer:112}]},{},[1]);