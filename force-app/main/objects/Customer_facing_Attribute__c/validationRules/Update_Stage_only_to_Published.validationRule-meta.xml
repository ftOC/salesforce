<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Update_Stage_only_to_Published</fullName>
    <active>true</active>
    <description>GDC can update the stage only to Published - In progress and Published -Ready from Approved.</description>
    <errorConditionFormula>AND
(
OR
(
$Profile.Name = &quot;Digital Sales Customer Profile&quot;,
AND(
$Permission.DS_GDC,
NOT($Permission.SWX_CCRE_Account_manager)
)
),
ISCHANGED(Quote_Approval_Stage__c), 
OR
(
ISPICKVAL(PRIORVALUE(Quote_Approval_Stage__c), &apos;Approved&apos;), 
ISPICKVAL(PRIORVALUE(Quote_Approval_Stage__c), &apos;Published - Ready&apos;), 
ISPICKVAL(PRIORVALUE(Quote_Approval_Stage__c), &apos;Published - In Progress&apos;),
ISPICKVAL(PRIORVALUE(Quote_Approval_Stage__c), &apos;Call-off Ready&apos;)
),
NOT(Text(Quote_Approval_Stage__c) = &apos;Approved&apos;), 
NOT(Text(Quote_Approval_Stage__c) = &apos;Published - Ready&apos;), 
NOT(Text(Quote_Approval_Stage__c) = &apos;Published - In Progress&apos;),
NOT(Text(Quote_Approval_Stage__c) = &apos;Call-off Ready&apos;),
NOT(Text(Quote_Approval_Stage__c) = &apos;Accepted&apos;),
NOT(Text(Quote_Approval_Stage__c) = &apos;Rejected&apos;) 
)</errorConditionFormula>
    <errorMessage>Invalid state change. Approval stage be changed by GDC users only among &quot;Approved&quot;, &quot;Published - In Progress&quot;, &quot;Published - Ready&quot; and &quot;Call-off Ready&quot; or to &quot;Accepted&quot; or &quot;Rejected&quot;.</errorMessage>
</ValidationRule>
