<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Upsell_Oppty_Forecast_on_OIF_Creation</fullName>
    <active>false</active>
    <description>Feature 1700 = remove the Forecast Category restriction
(old: Requirement :4992. OIF categories to be blocked on creation.)</description>
    <errorConditionFormula>AND
(ISNEW(),
$Profile.Name &lt;&gt; $Label.Data_Loader_Profile_Name,
ISPICKVAL(Opportunity__r.Business_Type__c , &apos;Committed Upsell&apos;),
OR(Opportunity__r.RecordType.DeveloperName = &apos;Direct_Record_Type&apos;,
Opportunity__r.RecordType.DeveloperName = &apos;Indirect_Record_Type&apos;
),
OR(
ISPICKVAL(Forecast_Category__c , &apos;Excluded&apos;), 
ISPICKVAL(Forecast_Category__c , &apos;Cancelled&apos;), 
ISPICKVAL(Forecast_Category__c , &apos;Lost&apos;),
ISPICKVAL(Forecast_Category__c , &apos;Upside&apos;),
ISPICKVAL(Forecast_Category__c , &apos;RoP&apos;)
),
ISBLANK(Cloned_From__c)
)</errorConditionFormula>
    <errorMessage>You can only select Booked, Secure or Risk when creating an OIF line on a committed upsell opportunity.</errorMessage>
</ValidationRule>
