<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Cenrtification_notification_PRM</name>
        <label>Cenrtification notification PRM</label>
        <locationX>1342</locationX>
        <locationY>264</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>IsOwner_active_certificati_not</targetReference>
        </connector>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Temp_PriorNotf_CertificationEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>VarAllPRMEmails</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>nokia_global_partner_communications@nokia.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>TempSubject_PriorEmailNotification</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Certification_Expired_Notification_PSM</name>
        <label>Certification Expired Notification PSM</label>
        <locationX>913</locationX>
        <locationY>99</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>Is_Null_TM_Expiry</targetReference>
        </connector>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Temp_ExpirationNotf_CertificationEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>TempSubject_ExpirationNotification</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>VarAllPSMEmails</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>nokia_global_partner_communications@nokia.com</stringValue>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Certification_Expired_Notification_TM</name>
        <label>Certification Expired Notification TM</label>
        <locationX>1094</locationX>
        <locationY>151</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>IsPartnerforNotification</targetReference>
        </connector>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Temp_ExpirationNotf_CertificationEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>VarAllTMEmails</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>nokia_global_partner_communications@nokia.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>TempSubject_ExpirationNotification</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>CertificationEmailNotification_Send_email_PSM</name>
        <label>CertificationEmailNotification_Send email_PSM</label>
        <locationX>950</locationX>
        <locationY>262</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>Is_Null_TM</targetReference>
        </connector>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Temp_PriorNotf_CertificationEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>VarAllPSMEmails</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>nokia_global_partner_communications@nokia.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>TempSubject_PriorEmailNotification</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>CertificationEmailNotification_Send_email_TM</name>
        <label>CertificationEmailNotification Send email TM</label>
        <locationX>1145</locationX>
        <locationY>263</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>IsPartnerSendEmail</targetReference>
        </connector>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Temp_PriorNotf_CertificationEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>VarAllTMEmails</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>nokia_global_partner_communications@nokia.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>TempSubject_PriorEmailNotification</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>CertificationExpiry_PRM</name>
        <label>CertificationExpiry_PRM</label>
        <locationX>1341</locationX>
        <locationY>148</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>IsOwnerActive</targetReference>
        </connector>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Temp_ExpirationNotf_CertificationEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>VarAllPRMEmails</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>nokia_global_partner_communications@nokia.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>TempSubject_ExpirationNotification</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Expriry_notification_Owner</name>
        <label>Expriry notification Owner</label>
        <locationX>1630</locationX>
        <locationY>150</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Temp_ExpirationNotf_CertificationEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <stringValue>{!VarOwnerEmail},{!VarCertContactEmail}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>nokia_global_partner_communications@nokia.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>TempSubject_ExpirationNotification</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Send_notification_Owner</name>
        <label>Send notification Owner</label>
        <locationX>1631</locationX>
        <locationY>248</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Temp_PriorNotf_CertificationEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <stringValue>{!VarOwnerEmail},{!VarCertContactEmail}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>nokia_global_partner_communications@nokia.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>TempSubject_PriorEmailNotification</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <apiVersion>49.0</apiVersion>
    <assignments>
        <name>Add_temp_PSM</name>
        <label>Add temp PSM</label>
        <locationX>498</locationX>
        <locationY>491</locationY>
        <assignmentItems>
            <assignToReference>VarAllPSMEmails</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>VarTempPSMEmail</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>SelAllRecEmail_TrainingManager</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Temp_TM_user</name>
        <label>Add Temp TM user</label>
        <locationX>738</locationX>
        <locationY>485</locationY>
        <assignmentItems>
            <assignToReference>VarAllTMEmails</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>VarTempTMEmail</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>IsPartner</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AddComma_PRM</name>
        <label>AddComma_PRM</label>
        <locationX>778</locationX>
        <locationY>105</locationY>
        <assignmentItems>
            <assignToReference>VarAllPRMEmails</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>,</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>SetAllReceipentEmai_PRM</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AddComma_PSM</name>
        <label>AddComma_PSM</label>
        <locationX>608</locationX>
        <locationY>665</locationY>
        <assignmentItems>
            <assignToReference>VarAllPSMEmails</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>,</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>SetAllReceipentEmail_PSM</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AddComma_TrainingM</name>
        <label>AddComma_TrainingM</label>
        <locationX>800</locationX>
        <locationY>542</locationY>
        <assignmentItems>
            <assignToReference>VarAllTMEmails</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>,</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>SelAllRecEmail_TrainingManager</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AddTempPRMUser</name>
        <label>AddTempPRMUser</label>
        <locationX>707</locationX>
        <locationY>207</locationY>
        <assignmentItems>
            <assignToReference>VarAllPRMEmails</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>VarTempPRMEMail</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>IsExpired</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>PRMEmailSet</name>
        <label>PRMEmailSet</label>
        <locationX>609</locationX>
        <locationY>110</locationY>
        <assignmentItems>
            <assignToReference>VarAllPRMEmails</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>LoopPRM.Email__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>VarTempPRMEMail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LoopPRM.Email__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>AddComma_PRM</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>PSM_EmailSet</name>
        <label>PSM EmailSet</label>
        <locationX>399</locationX>
        <locationY>662</locationY>
        <assignmentItems>
            <assignToReference>VarAllPSMEmails</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>LoopPSM.Email__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>VarTempPSMEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LoopPSM.Email__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>AddComma_PSM</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>TrainingManager_EmailSet</name>
        <label>TrainingManager EmailSet</label>
        <locationX>805</locationX>
        <locationY>661</locationY>
        <assignmentItems>
            <assignToReference>VarAllTMEmails</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>LoopTrainingManger.Email__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>VarTempTMEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>LoopTrainingManger.Email__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>AddComma_TrainingM</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Is_Null_TM</name>
        <label>Is Null TM</label>
        <locationX>1038</locationX>
        <locationY>364</locationY>
        <defaultConnector>
            <targetReference>IsPartnerSendEmail</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>Is_null_TMuser</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AllTrainingManager</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CertificationEmailNotification_Send_email_TM</targetReference>
            </connector>
            <label>Is null TM</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Null_TM_Expiry</name>
        <label>Is Null TM Expiry</label>
        <locationX>1034</locationX>
        <locationY>71</locationY>
        <defaultConnector>
            <targetReference>IsPartnerforNotification</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>is_null_TMUsers</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AllTrainingManager</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Certification_Expired_Notification_TM</targetReference>
            </connector>
            <label>is null TM</label>
        </rules>
    </decisions>
    <decisions>
        <name>IsExpired</name>
        <label>IsExpired</label>
        <locationX>816</locationX>
        <locationY>262</locationY>
        <defaultConnector>
            <targetReference>NotnullPSM</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>IsExpiredCertification</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>VarCertificationExpiresIn</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Expired</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Not_Null_PSM_Expiry</targetReference>
            </connector>
            <label>IsExpired</label>
        </rules>
    </decisions>
    <decisions>
        <name>IsInformaticaOwner</name>
        <label>IsInformaticaOwner</label>
        <locationX>390</locationX>
        <locationY>116</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>NotInformaticaUser</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>VarOwnerFirstName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Informatica</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>RoleName</targetReference>
            </connector>
            <label>NotInformaticaUser</label>
        </rules>
    </decisions>
    <decisions>
        <name>IsOwner_active_certificati_not</name>
        <label>IsOwner active certificati not</label>
        <locationX>1498</locationX>
        <locationY>253</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>Is_owner_active</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>VarCertificationOwnerActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>True</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_notification_Owner</targetReference>
            </connector>
            <label>Is owner active</label>
        </rules>
    </decisions>
    <decisions>
        <name>IsOwnerActive</name>
        <label>IsOwnerActive</label>
        <locationX>1497</locationX>
        <locationY>149</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>IsOWnerActiveYes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>VarCertificationOwnerActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>True</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Expriry_notification_Owner</targetReference>
            </connector>
            <label>IsOWnerActiveYes</label>
        </rules>
    </decisions>
    <decisions>
        <name>IsPartner</name>
        <label>IsPartner</label>
        <locationX>604</locationX>
        <locationY>422</locationY>
        <defaultConnector>
            <targetReference>IsExpired</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>IsPartnerCertificatioOwner</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>VarOwnerRoleName</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Partner User</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>FetchPRM</targetReference>
            </connector>
            <label>IsPartnerCertificatioOwner</label>
        </rules>
    </decisions>
    <decisions>
        <name>IsPartnerforNotification</name>
        <label>IsPartnerforNotification</label>
        <locationX>1220</locationX>
        <locationY>26</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>Isparner_for_sendingemail</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>VarOwnerRoleName</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Partner User</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>AllPRMUsers</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CertificationExpiry_PRM</targetReference>
            </connector>
            <label>Isparner for sendingemail</label>
        </rules>
    </decisions>
    <decisions>
        <name>IsPartnerSendEmail</name>
        <label>IsPartnerSendEmail</label>
        <locationX>1163</locationX>
        <locationY>427</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>Is_partne_for_notification</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>VarOwnerRoleName</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Partner User</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>AllPRMUsers</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Cenrtification_notification_PRM</targetReference>
            </connector>
            <label>Is partne for notification</label>
        </rules>
    </decisions>
    <decisions>
        <name>Not_Null_PSM_Expiry</name>
        <label>Not Null PSM Expiry</label>
        <locationX>841</locationX>
        <locationY>178</locationY>
        <defaultConnector>
            <targetReference>Is_Null_TM_Expiry</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>Not_Null_PSMuser</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AllPSMUsers</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Certification_Expired_Notification_PSM</targetReference>
            </connector>
            <label>Not Null PSM expiry</label>
        </rules>
    </decisions>
    <decisions>
        <name>NotnullPSM</name>
        <label>NotnullPSM</label>
        <locationX>881</locationX>
        <locationY>361</locationY>
        <defaultConnector>
            <targetReference>Is_Null_TM</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>Not_Null_PSM</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AllPSMUsers</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CertificationEmailNotification_Send_email_PSM</targetReference>
            </connector>
            <label>Not Null PSM</label>
        </rules>
    </decisions>
    <description>Final Flow - upadted with 5 email issues

Set org wide default address email

updated in rel 4 for template updates</description>
    <interviewLabel>Certification Email Notification {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Certification Email Notification</label>
    <loops>
        <name>SelAllRecEmail_TrainingManager</name>
        <label>SelAllRecEmail_TrainingManager</label>
        <locationX>607</locationX>
        <locationY>533</locationY>
        <assignNextValueToReference>LoopTrainingManger</assignNextValueToReference>
        <collectionReference>AllTrainingManager</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>TrainingManager_EmailSet</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Add_Temp_TM_user</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>SetAllReceipentEmai_PRM</name>
        <label>SetAllReceipentEmai_PRM</label>
        <locationX>603</locationX>
        <locationY>254</locationY>
        <assignNextValueToReference>LoopPRM</assignNextValueToReference>
        <collectionReference>AllPRMUsers</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>PRMEmailSet</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>AddTempPRMUser</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>SetAllReceipentEmail_PSM</name>
        <label>SetAllReceipentEmail_PSM</label>
        <locationX>397</locationX>
        <locationY>536</locationY>
        <assignNextValueToReference>LoopPSM</assignNextValueToReference>
        <collectionReference>AllPSMUsers</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>PSM_EmailSet</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Add_temp_PSM</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>CertificationUserDetails</name>
        <label>CertificationUserDetails</label>
        <locationX>920</locationX>
        <locationY>1</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ContactId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>VarCertificationContactID</elementReference>
            </value>
        </filters>
        <object>User</object>
        <outputAssignments>
            <assignToReference>CertificationUserEmail</assignToReference>
            <field>Email</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>CertificationUserFirstName</assignToReference>
            <field>FirstName</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>CertificationUserID</assignToReference>
            <field>Id</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>CertificationUserLastName</assignToReference>
            <field>LastName</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>FetchCertificationContactDetails</name>
        <label>FetchCertificationContactDetails</label>
        <locationX>600</locationX>
        <locationY>10</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>FetchOwnerIddetails</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>VarCertificationContactID</elementReference>
            </value>
        </filters>
        <object>Contact</object>
        <outputAssignments>
            <assignToReference>VarCertContactEmail</assignToReference>
            <field>Email</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>FetchCertificationDetails</name>
        <label>FetchCertificationDetails</label>
        <locationX>771</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>FetchCertificationContactDetails</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>VarCertificationID</elementReference>
            </value>
        </filters>
        <object>Certification__c</object>
        <outputAssignments>
            <assignToReference>VarCertificationExpirationDt</assignToReference>
            <field>Certification_Expiration_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarCertificationName</assignToReference>
            <field>Certification_Name__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarCertificationExpiresIn</assignToReference>
            <field>Certification_expires_in__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarCertificationContactID</assignToReference>
            <field>Name__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarCertificationOwner</assignToReference>
            <field>OwnerId</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarCertificationAccount</assignToReference>
            <field>Partner__c</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>FetchOwnerIddetails</name>
        <label>FetchOwnerIddetails</label>
        <locationX>391</locationX>
        <locationY>13</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>IsInformaticaOwner</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>VarCertificationOwner</elementReference>
            </value>
        </filters>
        <object>User</object>
        <outputAssignments>
            <assignToReference>VarOwnerEmail</assignToReference>
            <field>Email</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarOwnerFirstName</assignToReference>
            <field>FirstName</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarCertificationOwnerActive</assignToReference>
            <field>IsActive</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarOwnerLastname</assignToReference>
            <field>LastName</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarOwnerProfileID</assignToReference>
            <field>ProfileId</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>VarOwnerRoleID</assignToReference>
            <field>UserRoleId</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>FetchPRM</name>
        <label>FetchPRM</label>
        <locationX>605</locationX>
        <locationY>337</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SetAllReceipentEmai_PRM</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Account_Role__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Partner Relationship Manager</stringValue>
            </value>
        </filters>
        <filters>
            <field>Account__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>VarCertificationAccount</elementReference>
            </value>
        </filters>
        <filters>
            <field>Is_active_User__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>Account_Member__c</object>
        <outputReference>AllPRMUsers</outputReference>
        <queriedFields>Email__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>FetchPSMUsers</name>
        <label>FetchPSMUsers</label>
        <locationX>395</locationX>
        <locationY>337</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>FetchTrainingManager</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Account_Role__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Partner Sales Manager</stringValue>
            </value>
        </filters>
        <filters>
            <field>Account__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>VarCertificationAccount</elementReference>
            </value>
        </filters>
        <filters>
            <field>Is_active_User__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>Account_Member__c</object>
        <outputReference>AllPSMUsers</outputReference>
        <queriedFields>Email__c</queriedFields>
        <queriedFields>Account_Role__c</queriedFields>
        <queriedFields>Name__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>FetchTrainingManager</name>
        <label>FetchTrainingManager</label>
        <locationX>394</locationX>
        <locationY>436</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SetAllReceipentEmail_PSM</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Account_Role__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Training Manager</stringValue>
            </value>
        </filters>
        <filters>
            <field>Account__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>VarCertificationAccount</elementReference>
            </value>
        </filters>
        <filters>
            <field>Is_active_User__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>External</stringValue>
            </value>
        </filters>
        <object>Account_Member__c</object>
        <outputReference>AllTrainingManager</outputReference>
        <queriedFields>Email__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>RoleName</name>
        <label>Role Name</label>
        <locationX>395</locationX>
        <locationY>239</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>FetchPSMUsers</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>VarOwnerRoleID</elementReference>
            </value>
        </filters>
        <object>UserRole</object>
        <outputAssignments>
            <assignToReference>VarOwnerRoleName</assignToReference>
            <field>Name</field>
        </outputAssignments>
    </recordLookups>
    <startElementReference>FetchCertificationDetails</startElementReference>
    <status>Active</status>
    <textTemplates>
        <description>This is Certification expiration email body</description>
        <name>Temp_ExpirationNotf_CertificationEmailBody</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>Dear {!VarOwnerFirstName} {!VarOwnerLastname},

The following certification has expired.

Partner Learner Email: {!VarCertContactEmail}
Certificate Name:          {!VarCertificationName}
Expiration Date:            {!VarCertificationExpirationDt}

If you have completed your re-certification, please ignore this message.

Please access the Partner Learning Store to access the latest partner certifications training:
http://learningstore.nokia.com/partner/#Home 

You will find certifications listed on the left under both Job Roles and Portfolios.

Once you have completed the current product certification you will be re-certified for 2 years.
&quot;If you are unsure of the new name of your certification, check this chart&quot; - add Link to updated chart https://www.partners.nokia.com/s/documentpage?Id=069410000076HKe.

If you have any questions, please contact NokiaEDU Global Contact Center by clicking the link below. 
gcc.nokiaedu@nokia.com

Best regards,
NokiaEDU</text>
    </textTemplates>
    <textTemplates>
        <description>Certification email for prior notification before exiration.</description>
        <name>Temp_PriorNotf_CertificationEmailBody</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>Dear {!VarOwnerFirstName} {!VarOwnerLastname},

The following certification will expire in {!VarCertificationExpiresIn}.

Partner Learner Email: {!VarCertContactEmail}
Certificate Name:          {!VarCertificationName}
Expiration Date:            {!VarCertificationExpirationDt}

Please access the Partner Learning Store to access the latest partner certifications training:
http://learningstore.nokia.com/partner/#Home 

You will find certifications listed on the left under both Job Roles and Portfolios.

Once you have completed the current product certification you will be re-certified for 2 years.
&quot;If you are unsure of the new name of your certification, check this chart&quot; - add Link to updated chart https://www.partners.nokia.com/s/documentpage?Id=069410000076HKe 

If you have any questions, please contact NokiaEDU Global Contact Center by clicking the link below.
gcc.nokiaedu@nokia.com

Best regards,
NokiaEDU</text>
    </textTemplates>
    <textTemplates>
        <description>this is expiry email notification subject</description>
        <name>TempSubject_ExpirationNotification</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>Certification {!VarCertificationName} has expired</text>
    </textTemplates>
    <textTemplates>
        <description>this is email subject for prior notification email</description>
        <name>TempSubject_PriorEmailNotification</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>Certification {!VarCertificationName} will expire in {!VarCertificationExpiresIn}</text>
    </textTemplates>
    <variables>
        <description>This Sobject Collection variable will store all PRM Account member associated with Certification--&gt;Account</description>
        <name>AllPRMUsers</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account_Member__c</objectType>
    </variables>
    <variables>
        <description>This Sobject Collection variable will store all PSM Account member associated with Certification--&gt;Account</description>
        <name>AllPSMUsers</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account_Member__c</objectType>
    </variables>
    <variables>
        <description>This Sobject Collection variable will store all Training Manager Account member associated with Certification--&gt;Account</description>
        <name>AllTrainingManager</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account_Member__c</objectType>
    </variables>
    <variables>
        <description>Certification--&gt;contact--&gt;email</description>
        <name>CertificationUserEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Certification--&gt;contact--&gt;User first Name</description>
        <name>CertificationUserFirstName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Certification-&gt;Contact--&gt;User ID</description>
        <name>CertificationUserID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Certification--&gt;Contact--&gt;User last name</description>
        <name>CertificationUserLastName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>This Sobject variable will store PRM Account member per interation for all Certification--&gt;Account--&gt; associated PRM users</description>
        <name>LoopPRM</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account_Member__c</objectType>
    </variables>
    <variables>
        <description>This Sobject variable will store PSM Account member per interation for all Certification--&gt;Account--&gt; associated PSM users</description>
        <name>LoopPSM</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account_Member__c</objectType>
    </variables>
    <variables>
        <description>This Sobject variable will store Training Manager Account member per interation for all Certification--&gt;Account--&gt; associated Training manager users</description>
        <name>LoopTrainingManger</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account_Member__c</objectType>
    </variables>
    <variables>
        <description>This store Certification user contact</description>
        <name>SObjCertificationUserContact</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <description>This will capture all applicable Account Mems Emails and will be used as Receipent for Certification Notification</description>
        <name>VarAllEmails</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Contain all PRM emails</description>
        <name>VarAllPRMEmails</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Contain all PSM emails</description>
        <name>VarAllPSMEmails</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Contain all traininging manager emails</description>
        <name>VarAllTMEmails</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <name>VarCertContactEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Certification Contact Name</description>
        <name>VarCertContactName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>This will store certification associated Account ID</description>
        <name>VarCertificationAccount</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <name>VarCertificationContactID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>this store certification expiration date</description>
        <name>VarCertificationExpirationDt</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>This Will store expiration details like 6 months, 90 days, 60days, 30 days, expired. Mapped with &quot;Certification expires in:&quot; field</description>
        <name>VarCertificationExpiresIn</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>this variable store certification ID for which Expires In values is chnaged. This field value is getting passed from Flow.</description>
        <name>VarCertificationID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue>a3B18000000YrNH</stringValue>
        </value>
    </variables>
    <variables>
        <description>This will store CertificationName</description>
        <name>VarCertificationName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>This will have certification owner user</description>
        <name>VarCertificationOwner</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>this will have value as ture if user is active else false</description>
        <name>VarCertificationOwnerActive</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>This will store Certification Owner Email ID</description>
        <name>VarOwnerEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <name>VarOwnerFirstName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Store last name of Certification Owner</description>
        <name>VarOwnerLastname</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Store Certification Owner Profile Id</description>
        <name>VarOwnerProfileID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>Store Certification owner Role ID</description>
        <name>VarOwnerRoleID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <name>VarOwnerRoleName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>VarSubjectEmailNotification_Expired</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Certification Expired</stringValue>
        </value>
    </variables>
    <variables>
        <name>VarSubjectEmailNotification_PriorNot</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Certification will get expired soon</stringValue>
        </value>
    </variables>
    <variables>
        <name>VarTempPRMEMail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <description>This will egt assigned if user is inactive</description>
        <name>VarTempPSMEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue/>
        </value>
    </variables>
    <variables>
        <name>VarTempTMEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
